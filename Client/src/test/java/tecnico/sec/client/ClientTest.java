package tecnico.sec.client;

import org.junit.jupiter.api.Test;
import tecnico.sec.proto.exceptions.IOExceptions;
import tecnico.sec.proto.exceptions.KeyExceptions;
import tecnico.sec.proto.exceptions.SignatureExceptions;

import static org.junit.jupiter.api.Assertions.*;

class ClientTest {

    @Test
    void open_account_normal() {
        byte[] accountPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -75, -102, -29, 1, -20, -99, 103, -94, 65, 88, -99, -41, 7, 76, 107, 121, 116, 20, -19, 96, 44, 106, -104, -91, 4, -20, 55, -76, 67, 110, 60, 48, 63, 26, 21, 19, -115, 38, 60, 32, 110, -4, 21, 96, 72, 73, -47, -118, -45, -61, -53, -50, 11, -29, -25, -83, -67, -62, 100, -81, -54, -56, 85, -99, -89, -84, 56, 17, -118, 26, -35, -35, -77, 110, -103, 29, -20, -39, 71, -52, -90, 23, 0, 60, 64, 75, -50, -70, 20, -71, -110, 33, 15, 96, -77, 66, 109, 53, 83, 48, 2, -45, -67, -119, 17, 72, -38, 32, -72, 2, 15, -76, -35, -41, 62, -3, -4, -100, -80, 83, -74, -58, -72, -31, -84, -106, -44, 104, -71, -6, 82, -1, -105, 5, 127, 42, 107, -56, 9, 121, -34, 63, 56, -77, -36, 83, 105, -91, -69, -54, -46, -80, -34, 48, 36, 10, 66, 50, 29, -42, -13, -91, -42, 64, -85, -46, 77, 0, 78, -35, 52, 68, 41, 59, 100, -21, 126, 51, 26, -51, 60, 75, -83, 121, 121, 120, -29, 82, -112, 60, 2, 3, 37, 45, 35, -39, -113, 39, -18, -32, -40, -76, 61, 69, 92, -62, 98, 19, -35, 66, -14, -30, 74, -126, -53, -21, 125, -13, 15, -123, -122, -32, -88, 21, -50, -46, 21, 11, -115, 95, -44, -72, 9, -50, 93, 42, 73, -54, -31, -12, -84, 27, -53, 68, 114, 20, 67, 103, 108, 29, -113, 23, 4, -49, 111, 82, 59, -55, -86, -102, 106, -10, 49, -72, -120, -106, 78, -24, -114, -43, -8, 106, 121, -23, 116, 115, -17, -122, -31, 16, -6, -121, 105, -70, 33, 88, 73, 80, -108, -69, -110, -96, 111, 111, -5, -85, 120, 15, -65, -49, -114, 0, 7, 120, -47, -116, 117, -128, -2, -59, -69, -75, -5, 14, -64, 118, -16, -68, -18, 13, -70, -95, 70, 17, 46, -34, 59, 99, -75, -127, -77, -5, -57, 65, -87, -118, 96, -56, 123, 56, -27, -49, 49, 100, -117, 64, -56, -17, 46, 121, -71, -119, -86, 25, -49, -122, -80, -47, 121, 9, -63, -85, -7, -44, -1, 89, -110, -80, 53, 101, -80, -57, -49, 3, 30, 14, -99, -75, -71, -45, -77, 25, 94, 89, 8, -31, 21, -117, 71, -91, 73, 8, -91, 126, -45, 74, 126, 86, 123, -80, -5, -64, -97, 89, -75, 78, -22, -108, -82, -22, -6, 84, -45, -39, -86, 116, -61, 35, -16, 39, -53, -52, -39, 76, 16, -43, -43, 36, 11, 30, 58, 44, -58, 110, -90, -104, -28, 90, 79, -37, 55, -33, 108, 67, 39, -79, 88, 115, -117, 4, 70, -84, -35, -54, -9, 14, -88, -23, 94, -7, -80, -93, 15, 54, -51, 12, -59, -1, -105, -10, -65, 57, 83, 45, -39, 24, 43, -58, -13, 39, -17, -68, 20, 79, -124, 74, -47, -3, 40, -103, -101, 116, -125, -6, -22, -51, 66, -118, 38, 99, 69, -82, -9, -118, 86, 72, 87, 119, -37, -115, -116, -27, 2, 3, 1, 0, 1};
        byte[] serverPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -75, -102, -29, 1, -20, -99, 103, -94, 65, 88, -99, -41, 7, 76, 107, 121, 116, 20, -19, 96, 44, 106, -104, -91, 4, -20, 55, -76, 67, 110, 60, 48, 63, 26, 21, 19, -115, 38, 60, 32, 110, -4, 21, 96, 72, 73, -47, -118, -45, -61, -53, -50, 11, -29, -25, -83, -67, -62, 100, -81, -54, -56, 85, -99, -89, -84, 56, 17, -118, 26, -35, -35, -77, 110, -103, 29, -20, -39, 71, -52, -90, 23, 0, 60, 64, 75, -50, -70, 20, -71, -110, 33, 15, 96, -77, 66, 109, 53, 83, 48, 2, -45, -67, -119, 17, 72, -38, 32, -72, 2, 15, -76, -35, -41, 62, -3, -4, -100, -80, 83, -74, -58, -72, -31, -84, -106, -44, 104, -71, -6, 82, -1, -105, 5, 127, 42, 107, -56, 9, 121, -34, 63, 56, -77, -36, 83, 105, -91, -69, -54, -46, -80, -34, 48, 36, 10, 66, 50, 29, -42, -13, -91, -42, 64, -85, -46, 77, 0, 78, -35, 52, 68, 41, 59, 100, -21, 126, 51, 26, -51, 60, 75, -83, 121, 121, 120, -29, 82, -112, 60, 2, 3, 37, 45, 35, -39, -113, 39, -18, -32, -40, -76, 61, 69, 92, -62, 98, 19, -35, 66, -14, -30, 74, -126, -53, -21, 125, -13, 15, -123, -122, -32, -88, 21, -50, -46, 21, 11, -115, 95, -44, -72, 9, -50, 93, 42, 73, -54, -31, -12, -84, 27, -53, 68, 114, 20, 67, 103, 108, 29, -113, 23, 4, -49, 111, 82, 59, -55, -86, -102, 106, -10, 49, -72, -120, -106, 78, -24, -114, -43, -8, 106, 121, -23, 116, 115, -17, -122, -31, 16, -6, -121, 105, -70, 33, 88, 73, 80, -108, -69, -110, -96, 111, 111, -5, -85, 120, 15, -65, -49, -114, 0, 7, 120, -47, -116, 117, -128, -2, -59, -69, -75, -5, 14, -64, 118, -16, -68, -18, 13, -70, -95, 70, 17, 46, -34, 59, 99, -75, -127, -77, -5, -57, 65, -87, -118, 96, -56, 123, 56, -27, -49, 49, 100, -117, 64, -56, -17, 46, 121, -71, -119, -86, 25, -49, -122, -80, -47, 121, 9, -63, -85, -7, -44, -1, 89, -110, -80, 53, 101, -80, -57, -49, 3, 30, 14, -99, -75, -71, -45, -77, 25, 94, 89, 8, -31, 21, -117, 71, -91, 73, 8, -91, 126, -45, 74, 126, 86, 123, -80, -5, -64, -97, 89, -75, 78, -22, -108, -82, -22, -6, 84, -45, -39, -86, 116, -61, 35, -16, 39, -53, -52, -39, 76, 16, -43, -43, 36, 11, 30, 58, 44, -58, 110, -90, -104, -28, 90, 79, -37, 55, -33, 108, 67, 39, -79, 88, 115, -117, 4, 70, -84, -35, -54, -9, 14, -88, -23, 94, -7, -80, -93, 15, 54, -51, 12, -59, -1, -105, -10, -65, 57, 83, 45, -39, 24, 43, -58, -13, 39, -17, -68, 20, 79, -124, 74, -47, -3, 40, -103, -101, 116, -125, -6, -22, -51, 66, -118, 38, 99, 69, -82, -9, -118, 86, 72, 87, 119, -37, -115, -116, -27, 2, 3, 1, 0, 1};
        byte[] signature = {12, -95, 9, 4, -61, 61, -92, -66, -100, -87, 89, -95, 6, 3, -30, -102, -1, 106, 27, -1, -11, 36, -103, 41, -82, -75, 66, 83, 12, -29, 22, -36, 58, 83, -8, -68, -82, 118, -112, 46, 14, 68, -61, -88, 47, -54, -72, 46, -57, 38, -29, 9, -20, -104, 120, 54, -80, 113, 56, -41, 29, 74, -109, -95, 114, -71, 44, -95, -92, 77, 8, -1, -15, 23, -99, -69, -18, -25, 5, 78, 63, 14, 104, 116, 63, -51, -49, -41, -94, 121, -76, 120, 2, -58, -124, -113, -102, -14, -118, -71, 89, 80, -90, 98, 11, -46, -106, -108, -23, 4, 80, -72, -40, 68, -45, 26, -96, 9, -57, 126, 117, -55, 34, -47, 18, -29, -36, 79, -74, -4, 24, -3, 75, -85, 18, -93, -42, -126, 106, 123, -25, -66, 42, -106, 17, -69, 124, -58, -115, -32, -10, -70, 110, -72, 49, -33, 96, 108, 125, -31, 16, 94, -37, -16, -110, 36, 111, 106, -51, 76, 56, -62, -23, 0, 76, 84, -125, -50, -40, -93, -118, 35, -80, 32, -85, -58, 41, 70, -113, 22, -58, 103, 0, 88, -37, 67, -85, -72, -5, -41, -127, -64, -86, 89, 20, 26, -100, -98, -70, 51, 109, 61, 62, 81, -51, 77, -102, -115, 44, -13, -89, 108, 47, -3, 8, -114, 118, -76, -5, 81, 97, 111, 36, -51, -15, 55, 17, -118, 81, 48, 99, -2, 12, -59, -57, 79, -63, -28, -108, 45, -36, 59, -16, 55, -105, 4, 21, 21, -121, -12, -80, -65, -96, 115, -16, -88, -116, 1, 85, -70, -36, -98, -89, 44, 58, -20, -5, -94, -92, -110, -103, -94, 56, -98, 103, 118, -88, 62, 124, -68, 23, -70, -93, 39, 65, -26, -77, 43, -86, 44, -63, -45, -124, 105, -45, 30, -92, -93, -117, -90, 18, 75, -53, 32, 61, 84, -33, 83, 50, -25, -75, -116, 42, 41, -107, 96, -14, 78, 104, -119, 116, -48, -37, -9, 54, -68, 44, -77, -72, 106, 29, -4, 69, -23, 125, -95, 105, 6, 10, 39, 25, -96, -102, -107, 125, -22, 79, -16, 20, 91, 123, 81, -4, -108, -115, 121, 76, -35, 114, 27, -110, 22, -36, 72, 68, -41, 20, -74, 91, -2, 47, 58, -74, -83, -19, -58, 0, -49, -1, -20, 88, -116, 31, 10, -115, 67, -72, -2, 63, -101, 8, -56, -68, -52, 111, -42, 127, -94, -111, 118, -86, 126, 79, 59, -1, 4, -34, -105, 62, -54, -106, -1, -29, 107, 33, 84, 46, -127, 89, -54, -63, -72, -110, 35, -42, 12, -71, -39, 10, 60, -120, 99, -99, -27, 15, -22, -119, 89, -12, -6, 32, -100, -93, -107, 42, 104, -87, -128, 80, -88, -93, 96, 60, -53, -89, -49, -63, 87, -92, 35, 93, -68, 46, 2, 39, -86, -46, -125, -117, 104, 13, 93, 118, -45, -113, 116, 51, 39, -7, 86, -103, 108, 35, -9, 28, 70, -71, 22, -128, -41, 49, 110, -10, -64, -96, 3, 19, -88, -29, 84, -14, 124};
        assertDoesNotThrow(() -> Client.openAccountCheckResponse(serverPublicKey, signature, accountPublicKey));
    }

    @Test
    void open_account_key_signature_mismatch() {
        byte[] accountPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -75, -102, -29, 1, -20, -99, 103, -94, 65, 88, -99, -41, 7, 76, 107, 121, 116, 20, -19, 96, 44, 106, -104, -91, 4, -20, 55, -76, 67, 110, 60, 48, 63, 26, 21, 19, -115, 38, 60, 32, 110, -4, 21, 96, 72, 73, -47, -118, -45, -61, -53, -50, 11, -29, -25, -83, -67, -62, 100, -81, -54, -56, 85, -99, -89, -84, 56, 17, -118, 26, -35, -35, -77, 110, -103, 29, -20, -39, 71, -52, -90, 23, 0, 60, 64, 75, -50, -70, 20, -71, -110, 33, 15, 96, -77, 66, 109, 53, 83, 48, 2, -45, -67, -119, 17, 72, -38, 32, -72, 2, 15, -76, -35, -41, 62, -3, -4, -100, -80, 83, -74, -58, -72, -31, -84, -106, -44, 104, -71, -6, 82, -1, -105, 5, 127, 42, 107, -56, 9, 121, -34, 63, 56, -77, -36, 83, 105, -91, -69, -54, -46, -80, -34, 48, 36, 10, 66, 50, 29, -42, -13, -91, -42, 64, -85, -46, 77, 0, 78, -35, 52, 68, 41, 59, 100, -21, 126, 51, 26, -51, 60, 75, -83, 121, 121, 120, -29, 82, -112, 60, 2, 3, 37, 45, 35, -39, -113, 39, -18, -32, -40, -76, 61, 69, 92, -62, 98, 19, -35, 66, -14, -30, 74, -126, -53, -21, 125, -13, 15, -123, -122, -32, -88, 21, -50, -46, 21, 11, -115, 95, -44, -72, 9, -50, 93, 42, 73, -54, -31, -12, -84, 27, -53, 68, 114, 20, 67, 103, 108, 29, -113, 23, 4, -49, 111, 82, 59, -55, -86, -102, 106, -10, 49, -72, -120, -106, 78, -24, -114, -43, -8, 106, 121, -23, 116, 115, -17, -122, -31, 16, -6, -121, 105, -70, 33, 88, 73, 80, -108, -69, -110, -96, 111, 111, -5, -85, 120, 15, -65, -49, -114, 0, 7, 120, -47, -116, 117, -128, -2, -59, -69, -75, -5, 14, -64, 118, -16, -68, -18, 13, -70, -95, 70, 17, 46, -34, 59, 99, -75, -127, -77, -5, -57, 65, -87, -118, 96, -56, 123, 56, -27, -49, 49, 100, -117, 64, -56, -17, 46, 121, -71, -119, -86, 25, -49, -122, -80, -47, 121, 9, -63, -85, -7, -44, -1, 89, -110, -80, 53, 101, -80, -57, -49, 3, 30, 14, -99, -75, -71, -45, -77, 25, 94, 89, 8, -31, 21, -117, 71, -91, 73, 8, -91, 126, -45, 74, 126, 86, 123, -80, -5, -64, -97, 89, -75, 78, -22, -108, -82, -22, -6, 84, -45, -39, -86, 116, -61, 35, -16, 39, -53, -52, -39, 76, 16, -43, -43, 36, 11, 30, 58, 44, -58, 110, -90, -104, -28, 90, 79, -37, 55, -33, 108, 67, 39, -79, 88, 115, -117, 4, 70, -84, -35, -54, -9, 14, -88, -23, 94, -7, -80, -93, 15, 54, -51, 12, -59, -1, -105, -10, -65, 57, 83, 45, -39, 24, 43, -58, -13, 39, -17, -68, 20, 79, -124, 74, -47, -3, 40, -103, -101, 116, -125, -6, -22, -51, 66, -118, 38, 99, 69, -82, -9, -118, 86, 72, 87, 119, -37, -115, -116, -27, 2, 3, 1, 0, 1};
        byte[] serverPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -75, -102, -29, 1, -20, -99, 103, -94, 65, 88, -99, -41, 7, 76, 107, 121, 116, 20, -19, 96, 44, 106, -104, -91, 4, -20, 55, -76, 67, 110, 60, 48, 63, 26, 21, 19, -115, 38, 60, 32, 110, -4, 21, 96, 72, 73, -47, -118, -45, -61, -53, -50, 11, -29, -25, -83, -67, -62, 100, -81, -54, -56, 85, -99, -89, -84, 56, 17, -118, 26, -35, -35, -77, 110, -103, 29, -20, -39, 71, -52, -90, 23, 0, 60, 64, 75, -50, -70, 20, -71, -110, 33, 15, 96, -77, 66, 109, 53, 83, 48, 2, -45, -67, -119, 17, 72, -38, 32, -72, 2, 15, -76, -35, -41, 62, -3, -4, -100, -80, 83, -74, -58, -72, -31, -84, -106, -44, 104, -71, -6, 82, -1, -105, 5, 127, 42, 107, -56, 9, 121, -34, 63, 56, -77, -36, 83, 105, -91, -69, -54, -46, -80, -34, 48, 36, 10, 66, 50, 29, -42, -13, -91, -42, 64, -85, -46, 77, 0, 78, -35, 52, 68, 41, 59, 100, -21, 126, 51, 26, -51, 60, 75, -83, 121, 121, 120, -29, 82, -112, 60, 2, 3, 37, 45, 35, -39, -113, 39, -18, -32, -40, -76, 61, 69, 92, -62, 98, 19, -35, 66, -14, -30, 74, -126, -53, -21, 125, -13, 15, -123, -122, -32, -88, 21, -50, -46, 21, 11, -115, 95, -44, -72, 9, -50, 93, 42, 73, -54, -31, -12, -84, 27, -53, 68, 114, 20, 67, 103, 108, 29, -113, 23, 4, -49, 111, 82, 59, -55, -86, -102, 106, -10, 49, -72, -120, -106, 78, -24, -114, -43, -8, 106, 121, -23, 116, 115, -17, -122, -31, 16, -6, -121, 105, -70, 33, 88, 73, 80, -108, -69, -110, -96, 111, 111, -5, -85, 120, 15, -65, -49, -114, 0, 7, 120, -47, -116, 117, -128, -2, -59, -69, -75, -5, 14, -64, 118, -16, -68, -18, 13, -70, -95, 70, 17, 46, -34, 59, 99, -75, -127, -77, -5, -57, 65, -87, -118, 96, -56, 123, 56, -27, -49, 49, 100, -117, 64, -56, -17, 46, 121, -71, -119, -86, 25, -49, -122, -80, -47, 121, 9, -63, -85, -7, -44, -1, 89, -110, -80, 53, 101, -80, -57, -49, 3, 30, 14, -99, -75, -71, -45, -77, 25, 94, 89, 8, -31, 21, -117, 71, -91, 73, 8, -91, 126, -45, 74, 126, 86, 123, -80, -5, -64, -97, 89, -75, 78, -22, -108, -82, -22, -6, 84, -45, -39, -86, 116, -61, 35, -16, 39, -53, -52, -39, 76, 16, -43, -43, 36, 11, 30, 58, 44, -58, 110, -90, -104, -28, 90, 79, -37, 55, -33, 108, 67, 39, -79, 88, 115, -117, 4, 70, -84, -35, -54, -9, 14, -88, -23, 94, -7, -80, -93, 15, 54, -51, 12, -59, -1, -105, -10, -65, 57, 83, 45, -39, 24, 43, -58, -13, 39, -17, -68, 20, 79, -124, 74, -47, -3, 40, -103, -101, 116, -125, -6, -22, -51, 66, -118, 38, 99, 69, -82, -9, -118, 86, 72, 87, 119, -37, -115, -116, -27, 2, 3, 1, 0, 1};
        byte[] signature = {13, -95, 9, 4, -61, 61, -92, -66, -100, -87, 89, -95, 6, 3, -30, -102, -1, 106, 27, -1, -11, 36, -103, 41, -82, -75, 66, 83, 12, -29, 22, -36, 58, 83, -8, -68, -82, 118, -112, 46, 14, 68, -61, -88, 47, -54, -72, 46, -57, 38, -29, 9, -20, -104, 120, 54, -80, 113, 56, -41, 29, 74, -109, -95, 114, -71, 44, -95, -92, 77, 8, -1, -15, 23, -99, -69, -18, -25, 5, 78, 63, 14, 104, 116, 63, -51, -49, -41, -94, 121, -76, 120, 2, -58, -124, -113, -102, -14, -118, -71, 89, 80, -90, 98, 11, -46, -106, -108, -23, 4, 80, -72, -40, 68, -45, 26, -96, 9, -57, 126, 117, -55, 34, -47, 18, -29, -36, 79, -74, -4, 24, -3, 75, -85, 18, -93, -42, -126, 106, 123, -25, -66, 42, -106, 17, -69, 124, -58, -115, -32, -10, -70, 110, -72, 49, -33, 96, 108, 125, -31, 16, 94, -37, -16, -110, 36, 111, 106, -51, 76, 56, -62, -23, 0, 76, 84, -125, -50, -40, -93, -118, 35, -80, 32, -85, -58, 41, 70, -113, 22, -58, 103, 0, 88, -37, 67, -85, -72, -5, -41, -127, -64, -86, 89, 20, 26, -100, -98, -70, 51, 109, 61, 62, 81, -51, 77, -102, -115, 44, -13, -89, 108, 47, -3, 8, -114, 118, -76, -5, 81, 97, 111, 36, -51, -15, 55, 17, -118, 81, 48, 99, -2, 12, -59, -57, 79, -63, -28, -108, 45, -36, 59, -16, 55, -105, 4, 21, 21, -121, -12, -80, -65, -96, 115, -16, -88, -116, 1, 85, -70, -36, -98, -89, 44, 58, -20, -5, -94, -92, -110, -103, -94, 56, -98, 103, 118, -88, 62, 124, -68, 23, -70, -93, 39, 65, -26, -77, 43, -86, 44, -63, -45, -124, 105, -45, 30, -92, -93, -117, -90, 18, 75, -53, 32, 61, 84, -33, 83, 50, -25, -75, -116, 42, 41, -107, 96, -14, 78, 104, -119, 116, -48, -37, -9, 54, -68, 44, -77, -72, 106, 29, -4, 69, -23, 125, -95, 105, 6, 10, 39, 25, -96, -102, -107, 125, -22, 79, -16, 20, 91, 123, 81, -4, -108, -115, 121, 76, -35, 114, 27, -110, 22, -36, 72, 68, -41, 20, -74, 91, -2, 47, 58, -74, -83, -19, -58, 0, -49, -1, -20, 88, -116, 31, 10, -115, 67, -72, -2, 63, -101, 8, -56, -68, -52, 111, -42, 127, -94, -111, 118, -86, 126, 79, 59, -1, 4, -34, -105, 62, -54, -106, -1, -29, 107, 33, 84, 46, -127, 89, -54, -63, -72, -110, 35, -42, 12, -71, -39, 10, 60, -120, 99, -99, -27, 15, -22, -119, 89, -12, -6, 32, -100, -93, -107, 42, 104, -87, -128, 80, -88, -93, 96, 60, -53, -89, -49, -63, 87, -92, 35, 93, -68, 46, 2, 39, -86, -46, -125, -117, 104, 13, 93, 118, -45, -113, 116, 51, 39, -7, 86, -103, 108, 35, -9, 28, 70, -71, 22, -128, -41, 49, 110, -10, -64, -96, 3, 19, -88, -29, 84, -14, 124};

        assertThrows(SignatureExceptions.class, () -> Client.openAccountCheckResponse(serverPublicKey, signature, accountPublicKey));
    }

    @Test
    void send_amount_normal() {
        byte[] serverPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -75, -102, -29, 1, -20, -99, 103, -94, 65, 88, -99, -41, 7, 76, 107, 121, 116, 20, -19, 96, 44, 106, -104, -91, 4, -20, 55, -76, 67, 110, 60, 48, 63, 26, 21, 19, -115, 38, 60, 32, 110, -4, 21, 96, 72, 73, -47, -118, -45, -61, -53, -50, 11, -29, -25, -83, -67, -62, 100, -81, -54, -56, 85, -99, -89, -84, 56, 17, -118, 26, -35, -35, -77, 110, -103, 29, -20, -39, 71, -52, -90, 23, 0, 60, 64, 75, -50, -70, 20, -71, -110, 33, 15, 96, -77, 66, 109, 53, 83, 48, 2, -45, -67, -119, 17, 72, -38, 32, -72, 2, 15, -76, -35, -41, 62, -3, -4, -100, -80, 83, -74, -58, -72, -31, -84, -106, -44, 104, -71, -6, 82, -1, -105, 5, 127, 42, 107, -56, 9, 121, -34, 63, 56, -77, -36, 83, 105, -91, -69, -54, -46, -80, -34, 48, 36, 10, 66, 50, 29, -42, -13, -91, -42, 64, -85, -46, 77, 0, 78, -35, 52, 68, 41, 59, 100, -21, 126, 51, 26, -51, 60, 75, -83, 121, 121, 120, -29, 82, -112, 60, 2, 3, 37, 45, 35, -39, -113, 39, -18, -32, -40, -76, 61, 69, 92, -62, 98, 19, -35, 66, -14, -30, 74, -126, -53, -21, 125, -13, 15, -123, -122, -32, -88, 21, -50, -46, 21, 11, -115, 95, -44, -72, 9, -50, 93, 42, 73, -54, -31, -12, -84, 27, -53, 68, 114, 20, 67, 103, 108, 29, -113, 23, 4, -49, 111, 82, 59, -55, -86, -102, 106, -10, 49, -72, -120, -106, 78, -24, -114, -43, -8, 106, 121, -23, 116, 115, -17, -122, -31, 16, -6, -121, 105, -70, 33, 88, 73, 80, -108, -69, -110, -96, 111, 111, -5, -85, 120, 15, -65, -49, -114, 0, 7, 120, -47, -116, 117, -128, -2, -59, -69, -75, -5, 14, -64, 118, -16, -68, -18, 13, -70, -95, 70, 17, 46, -34, 59, 99, -75, -127, -77, -5, -57, 65, -87, -118, 96, -56, 123, 56, -27, -49, 49, 100, -117, 64, -56, -17, 46, 121, -71, -119, -86, 25, -49, -122, -80, -47, 121, 9, -63, -85, -7, -44, -1, 89, -110, -80, 53, 101, -80, -57, -49, 3, 30, 14, -99, -75, -71, -45, -77, 25, 94, 89, 8, -31, 21, -117, 71, -91, 73, 8, -91, 126, -45, 74, 126, 86, 123, -80, -5, -64, -97, 89, -75, 78, -22, -108, -82, -22, -6, 84, -45, -39, -86, 116, -61, 35, -16, 39, -53, -52, -39, 76, 16, -43, -43, 36, 11, 30, 58, 44, -58, 110, -90, -104, -28, 90, 79, -37, 55, -33, 108, 67, 39, -79, 88, 115, -117, 4, 70, -84, -35, -54, -9, 14, -88, -23, 94, -7, -80, -93, 15, 54, -51, 12, -59, -1, -105, -10, -65, 57, 83, 45, -39, 24, 43, -58, -13, 39, -17, -68, 20, 79, -124, 74, -47, -3, 40, -103, -101, 116, -125, -6, -22, -51, 66, -118, 38, 99, 69, -82, -9, -118, 86, 72, 87, 119, -37, -115, -116, -27, 2, 3, 1, 0, 1};
        byte[] signature = {20, 80, -33, 11, 117, -110, 1, 63, 60, -82, -97, -18, -84, 105, 59, 78, 39, 73, -119, 14, -58, -26, 25, 85, 39, -9, 122, 112, 76, 25, -23, -6, -15, 26, -67, -25, 43, 23, -99, 97, 19, 117, -84, 85, -9, -92, 9, -89, 96, -73, 52, 85, 18, -18, 55, -32, 99, 25, 52, 9, 24, 88, -126, 86, -20, 54, -124, 121, 10, 54, -34, -34, 100, -47, 68, -18, -77, 81, 60, -66, 51, -121, -127, -64, 40, -61, -89, 74, -51, -117, -123, -34, -37, 113, -48, -80, 100, 121, 22, 30, -100, 17, -8, 13, -128, -61, -62, 104, 117, 120, -81, 5, 113, -93, 2, -38, 121, 14, -64, 3, 24, -10, 23, 102, 86, -53, -35, 70, 126, -19, 103, -5, 71, -8, -98, 32, 126, 6, 125, -61, -32, 63, 19, -45, -100, 15, -126, 115, 52, -99, -122, -51, -86, 89, -128, -65, 9, -82, -13, -50, 88, 42, 57, -128, 61, 83, -54, 46, -95, 69, -105, 64, -39, -71, 121, 91, 5, 81, 0, -83, -51, 124, 125, 124, -86, -120, -17, 60, 43, -42, -63, -35, -32, -110, -52, -97, 111, 121, 5, 99, 34, -82, 33, -96, 91, -122, -51, 57, 111, 18, 56, -79, -20, -36, -70, 102, -62, -108, -114, 52, -45, 44, 37, 36, 62, 110, -55, -92, -56, 52, 112, -1, 62, -69, -119, 97, -15, -112, -27, 52, 120, -88, 26, -70, 61, -61, -67, -92, 49, -2, -91, -45, -99, -88, 112, -25, -3, -61, 114, 40, 40, -7, 121, 23, 12, 83, 84, -103, -111, -60, -10, 68, -14, 95, 88, -112, 56, -70, 81, -123, 117, -108, -40, 103, 46, 112, -71, -78, 17, -35, -76, 68, 85, 59, 66, 59, 124, 10, 45, 120, 12, 119, 31, 39, 72, -13, 11, 61, -119, 12, -82, -70, 89, 74, 36, -16, 110, -74, -46, 40, -46, -117, -97, 23, -120, 67, -60, 21, 56, -128, -17, 16, -106, 20, 109, 127, 6, 97, 13, -116, 115, 127, 75, -64, 66, 51, -109, 44, 40, 15, 115, 127, 48, -116, 46, 120, -14, -108, -122, -125, -36, -86, -98, 21, -70, -117, -54, -72, -108, -122, -23, 2, -96, 26, -4, 46, -112, -17, 22, 98, 121, 69, -120, -20, -52, -100, -45, 51, -50, -111, -45, 94, -113, 26, -103, 74, -36, -107, -22, -62, -21, -122, -14, -69, -5, -91, 41, -4, 32, 26, 3, -37, -20, -84, 120, 20, 45, 22, -90, -119, 73, -117, -36, 108, -25, 69, 44, 88, -96, -12, 81, -62, 25, -35, -49, 31, 56, 84, 46, 64, -16, -79, 99, -6, 100, 38, 78, 41, 53, -24, 18, -100, 122, 35, 75, 126, -1, 122, 65, -59, 67, -9, 68, 9, 36, -102, -10, 76, 66, -86, -42, 46, 103, 78, -94, -39, -30, 118, -26, 93, -93, 106, -82, -94, -118, -96, 123, 96, 36, 72, 56, 0, 127, -95, 11, -46, 59, -124, -33, -67, -101, 6, -85, -36, 6, -100, 94, 71, -49, -21, 39, 60};
        byte[] sourcePublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -58, -30, 99, -1, 30, 32, 80, 91, -121, -126, -30, 17, -55, 44, -33, -12, -42, 54, 56, -114, 38, 61, 8, 12, 104, -97, 127, 3, -74, 15, 119, -11, -45, 120, -71, -12, 111, 28, 81, 120, -50, -30, 11, -36, -90, -111, -104, 34, -115, -103, 68, 55, 80, 79, -87, 87, -47, -84, -78, -76, -63, -90, 42, -104, 12, -16, 53, -54, -2, -32, 102, 93, -40, -7, -64, 118, 25, -18, 127, -73, 17, 2, 66, 11, -78, -127, 18, 37, -111, -15, -53, 35, 84, 97, -113, 26, 57, 86, -128, -59, 67, -123, -120, -121, 57, -98, -95, 44, 117, 14, 116, 42, 38, -76, -22, -14, -37, -36, -56, 53, -121, -116, -17, -102, -99, -23, 34, -52, 73, -86, -56, -38, -80, -23, 124, 125, 36, 94, -32, -76, 69, -43, 37, 109, 118, 80, -84, 49, 111, 67, -125, 43, -113, 101, 87, -110, -16, -96, 18, 110, 124, -37, -110, -100, 107, -109, -73, -39, -109, -25, 93, 83, -73, -88, 34, 29, -89, 93, -22, -77, 25, 53, 74, 11, 116, -41, -85, 92, -106, 96, 38, -110, 12, 30, 63, 23, 78, -94, 109, 40, 82, 65, -16, 40, 48, -12, 57, -99, -53, -67, -73, 122, 49, -27, -19, 99, 95, -69, -124, -88, 40, -40, -74, -55, 15, -81, -55, 60, -50, -25, 96, -54, 119, 96, 66, -82, -94, 28, -78, -31, -23, 38, 12, 38, 24, 96, 24, 115, 10, 13, 61, 33, 7, -87, -111, -90, 48, 53, -90, 78, -17, -31, 68, 124, -65, -101, 8, 64, -125, -43, 7, 69, 89, 13, 77, 57, 46, 83, -19, -82, 95, -85, -49, 86, -102, -71, 55, -57, 10, -120, -103, -56, 34, 101, 59, -62, -90, 95, -56, 54, -49, 0, -127, -43, -27, 32, 2, 55, -117, -97, 2, -33, 62, -77, -16, -64, 40, -55, -112, 36, 46, 98, -64, -44, -78, -85, -63, 74, -119, -4, -80, -14, 11, -78, -123, -114, 38, 76, -115, 43, -99, -110, -16, -26, -47, -34, 35, 93, -69, -78, -53, 23, 127, 100, 90, -37, 13, 105, 88, 48, -103, 127, -112, -62, -23, 120, 37, 29, -9, -92, -65, 30, -31, -59, 34, 24, -52, -53, 75, 89, 38, 92, -98, 100, 34, 4, 23, 55, -105, 121, 60, -119, -61, -119, -68, -121, -106, -8, 59, 73, 65, 80, -87, 86, 69, 114, 56, -102, 55, 32, -121, 15, 6, 41, -49, -109, -6, -93, -44, 127, -26, -33, -116, -16, -45, 20, 48, 43, 36, -88, -59, -55, -68, 73, 77, -95, -90, -25, -52, 29, 54, -77, 58, 65, -36, 106, 127, 26, 93, -128, -5, -115, 113, 72, 79, -68, -43, -49, 33, -19, -42, 51, -44, 72, 37, -26, -43, 54, 20, 66, -125, -101, 98, 16, 9, -10, 116, 78, 88, 39, 98, -3, 83, 99, -97, 90, 2, -35, -40, 103, 41, -70, -59, -4, -112, -19, 91, 124, -79, 35, 4, -123, 0, -91, 38, 13, -106, -69, -76, 55, 69, 47, 2, 3, 1, 0, 1};
        byte[] destinationPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -58, -30, 99, -1, 30, 32, 80, 91, -121, -126, -30, 17, -55, 44, -33, -12, -42, 54, 56, -114, 38, 61, 8, 12, 104, -97, 127, 3, -74, 15, 119, -11, -45, 120, -71, -12, 111, 28, 81, 120, -50, -30, 11, -36, -90, -111, -104, 34, -115, -103, 68, 55, 80, 79, -87, 87, -47, -84, -78, -76, -63, -90, 42, -104, 12, -16, 53, -54, -2, -32, 102, 93, -40, -7, -64, 118, 25, -18, 127, -73, 17, 2, 66, 11, -78, -127, 18, 37, -111, -15, -53, 35, 84, 97, -113, 26, 57, 86, -128, -59, 67, -123, -120, -121, 57, -98, -95, 44, 117, 14, 116, 42, 38, -76, -22, -14, -37, -36, -56, 53, -121, -116, -17, -102, -99, -23, 34, -52, 73, -86, -56, -38, -80, -23, 124, 125, 36, 94, -32, -76, 69, -43, 37, 109, 118, 80, -84, 49, 111, 67, -125, 43, -113, 101, 87, -110, -16, -96, 18, 110, 124, -37, -110, -100, 107, -109, -73, -39, -109, -25, 93, 83, -73, -88, 34, 29, -89, 93, -22, -77, 25, 53, 74, 11, 116, -41, -85, 92, -106, 96, 38, -110, 12, 30, 63, 23, 78, -94, 109, 40, 82, 65, -16, 40, 48, -12, 57, -99, -53, -67, -73, 122, 49, -27, -19, 99, 95, -69, -124, -88, 40, -40, -74, -55, 15, -81, -55, 60, -50, -25, 96, -54, 119, 96, 66, -82, -94, 28, -78, -31, -23, 38, 12, 38, 24, 96, 24, 115, 10, 13, 61, 33, 7, -87, -111, -90, 48, 53, -90, 78, -17, -31, 68, 124, -65, -101, 8, 64, -125, -43, 7, 69, 89, 13, 77, 57, 46, 83, -19, -82, 95, -85, -49, 86, -102, -71, 55, -57, 10, -120, -103, -56, 34, 101, 59, -62, -90, 95, -56, 54, -49, 0, -127, -43, -27, 32, 2, 55, -117, -97, 2, -33, 62, -77, -16, -64, 40, -55, -112, 36, 46, 98, -64, -44, -78, -85, -63, 74, -119, -4, -80, -14, 11, -78, -123, -114, 38, 76, -115, 43, -99, -110, -16, -26, -47, -34, 35, 93, -69, -78, -53, 23, 127, 100, 90, -37, 13, 105, 88, 48, -103, 127, -112, -62, -23, 120, 37, 29, -9, -92, -65, 30, -31, -59, 34, 24, -52, -53, 75, 89, 38, 92, -98, 100, 34, 4, 23, 55, -105, 121, 60, -119, -61, -119, -68, -121, -106, -8, 59, 73, 65, 80, -87, 86, 69, 114, 56, -102, 55, 32, -121, 15, 6, 41, -49, -109, -6, -93, -44, 127, -26, -33, -116, -16, -45, 20, 48, 43, 36, -88, -59, -55, -68, 73, 77, -95, -90, -25, -52, 29, 54, -77, 58, 65, -36, 106, 127, 26, 93, -128, -5, -115, 113, 72, 79, -68, -43, -49, 33, -19, -42, 51, -44, 72, 37, -26, -43, 54, 20, 66, -125, -101, 98, 16, 9, -10, 116, 78, 88, 39, 98, -3, 83, 99, -97, 90, 2, -35, -40, 103, 41, -70, -59, -4, -112, -19, 91, 124, -79, 35, 4, -123, 0, -91, 38, 13, -106, -69, -76, 55, 69, 47, 2, 3, 1, 0, 1};
        int amount = 10;
        int incrementedNonce = -2079421024;

        assertDoesNotThrow(() -> Client.sendAmountCheckResponse(serverPublicKey, signature, sourcePublicKey, destinationPublicKey, amount, incrementedNonce));
    }

    @Test
    void send_amount_signature_mismatch() {
        byte[] serverPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -75, -102, -29, 1, -20, -99, 103, -94, 65, 88, -99, -41, 7, 76, 107, 121, 116, 20, -19, 96, 44, 106, -104, -91, 4, -20, 55, -76, 67, 110, 60, 48, 63, 26, 21, 19, -115, 38, 60, 32, 110, -4, 21, 96, 72, 73, -47, -118, -45, -61, -53, -50, 11, -29, -25, -83, -67, -62, 100, -81, -54, -56, 85, -99, -89, -84, 56, 17, -118, 26, -35, -35, -77, 110, -103, 29, -20, -39, 71, -52, -90, 23, 0, 60, 64, 75, -50, -70, 20, -71, -110, 33, 15, 96, -77, 66, 109, 53, 83, 48, 2, -45, -67, -119, 17, 72, -38, 32, -72, 2, 15, -76, -35, -41, 62, -3, -4, -100, -80, 83, -74, -58, -72, -31, -84, -106, -44, 104, -71, -6, 82, -1, -105, 5, 127, 42, 107, -56, 9, 121, -34, 63, 56, -77, -36, 83, 105, -91, -69, -54, -46, -80, -34, 48, 36, 10, 66, 50, 29, -42, -13, -91, -42, 64, -85, -46, 77, 0, 78, -35, 52, 68, 41, 59, 100, -21, 126, 51, 26, -51, 60, 75, -83, 121, 121, 120, -29, 82, -112, 60, 2, 3, 37, 45, 35, -39, -113, 39, -18, -32, -40, -76, 61, 69, 92, -62, 98, 19, -35, 66, -14, -30, 74, -126, -53, -21, 125, -13, 15, -123, -122, -32, -88, 21, -50, -46, 21, 11, -115, 95, -44, -72, 9, -50, 93, 42, 73, -54, -31, -12, -84, 27, -53, 68, 114, 20, 67, 103, 108, 29, -113, 23, 4, -49, 111, 82, 59, -55, -86, -102, 106, -10, 49, -72, -120, -106, 78, -24, -114, -43, -8, 106, 121, -23, 116, 115, -17, -122, -31, 16, -6, -121, 105, -70, 33, 88, 73, 80, -108, -69, -110, -96, 111, 111, -5, -85, 120, 15, -65, -49, -114, 0, 7, 120, -47, -116, 117, -128, -2, -59, -69, -75, -5, 14, -64, 118, -16, -68, -18, 13, -70, -95, 70, 17, 46, -34, 59, 99, -75, -127, -77, -5, -57, 65, -87, -118, 96, -56, 123, 56, -27, -49, 49, 100, -117, 64, -56, -17, 46, 121, -71, -119, -86, 25, -49, -122, -80, -47, 121, 9, -63, -85, -7, -44, -1, 89, -110, -80, 53, 101, -80, -57, -49, 3, 30, 14, -99, -75, -71, -45, -77, 25, 94, 89, 8, -31, 21, -117, 71, -91, 73, 8, -91, 126, -45, 74, 126, 86, 123, -80, -5, -64, -97, 89, -75, 78, -22, -108, -82, -22, -6, 84, -45, -39, -86, 116, -61, 35, -16, 39, -53, -52, -39, 76, 16, -43, -43, 36, 11, 30, 58, 44, -58, 110, -90, -104, -28, 90, 79, -37, 55, -33, 108, 67, 39, -79, 88, 115, -117, 4, 70, -84, -35, -54, -9, 14, -88, -23, 94, -7, -80, -93, 15, 54, -51, 12, -59, -1, -105, -10, -65, 57, 83, 45, -39, 24, 43, -58, -13, 39, -17, -68, 20, 79, -124, 74, -47, -3, 40, -103, -101, 116, -125, -6, -22, -51, 66, -118, 38, 99, 69, -82, -9, -118, 86, 72, 87, 119, -37, -115, -116, -27, 2, 3, 1, 0, 1};
        byte[] signature = {21, 80, -33, 11, 117, -110, 1, 63, 60, -82, -97, -18, -84, 105, 59, 78, 39, 73, -119, 14, -58, -26, 25, 85, 39, -9, 122, 112, 76, 25, -23, -6, -15, 26, -67, -25, 43, 23, -99, 97, 19, 117, -84, 85, -9, -92, 9, -89, 96, -73, 52, 85, 18, -18, 55, -32, 99, 25, 52, 9, 24, 88, -126, 86, -20, 54, -124, 121, 10, 54, -34, -34, 100, -47, 68, -18, -77, 81, 60, -66, 51, -121, -127, -64, 40, -61, -89, 74, -51, -117, -123, -34, -37, 113, -48, -80, 100, 121, 22, 30, -100, 17, -8, 13, -128, -61, -62, 104, 117, 120, -81, 5, 113, -93, 2, -38, 121, 14, -64, 3, 24, -10, 23, 102, 86, -53, -35, 70, 126, -19, 103, -5, 71, -8, -98, 32, 126, 6, 125, -61, -32, 63, 19, -45, -100, 15, -126, 115, 52, -99, -122, -51, -86, 89, -128, -65, 9, -82, -13, -50, 88, 42, 57, -128, 61, 83, -54, 46, -95, 69, -105, 64, -39, -71, 121, 91, 5, 81, 0, -83, -51, 124, 125, 124, -86, -120, -17, 60, 43, -42, -63, -35, -32, -110, -52, -97, 111, 121, 5, 99, 34, -82, 33, -96, 91, -122, -51, 57, 111, 18, 56, -79, -20, -36, -70, 102, -62, -108, -114, 52, -45, 44, 37, 36, 62, 110, -55, -92, -56, 52, 112, -1, 62, -69, -119, 97, -15, -112, -27, 52, 120, -88, 26, -70, 61, -61, -67, -92, 49, -2, -91, -45, -99, -88, 112, -25, -3, -61, 114, 40, 40, -7, 121, 23, 12, 83, 84, -103, -111, -60, -10, 68, -14, 95, 88, -112, 56, -70, 81, -123, 117, -108, -40, 103, 46, 112, -71, -78, 17, -35, -76, 68, 85, 59, 66, 59, 124, 10, 45, 120, 12, 119, 31, 39, 72, -13, 11, 61, -119, 12, -82, -70, 89, 74, 36, -16, 110, -74, -46, 40, -46, -117, -97, 23, -120, 67, -60, 21, 56, -128, -17, 16, -106, 20, 109, 127, 6, 97, 13, -116, 115, 127, 75, -64, 66, 51, -109, 44, 40, 15, 115, 127, 48, -116, 46, 120, -14, -108, -122, -125, -36, -86, -98, 21, -70, -117, -54, -72, -108, -122, -23, 2, -96, 26, -4, 46, -112, -17, 22, 98, 121, 69, -120, -20, -52, -100, -45, 51, -50, -111, -45, 94, -113, 26, -103, 74, -36, -107, -22, -62, -21, -122, -14, -69, -5, -91, 41, -4, 32, 26, 3, -37, -20, -84, 120, 20, 45, 22, -90, -119, 73, -117, -36, 108, -25, 69, 44, 88, -96, -12, 81, -62, 25, -35, -49, 31, 56, 84, 46, 64, -16, -79, 99, -6, 100, 38, 78, 41, 53, -24, 18, -100, 122, 35, 75, 126, -1, 122, 65, -59, 67, -9, 68, 9, 36, -102, -10, 76, 66, -86, -42, 46, 103, 78, -94, -39, -30, 118, -26, 93, -93, 106, -82, -94, -118, -96, 123, 96, 36, 72, 56, 0, 127, -95, 11, -46, 59, -124, -33, -67, -101, 6, -85, -36, 6, -100, 94, 71, -49, -21, 39, 60};
        byte[] sourcePublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -58, -30, 99, -1, 30, 32, 80, 91, -121, -126, -30, 17, -55, 44, -33, -12, -42, 54, 56, -114, 38, 61, 8, 12, 104, -97, 127, 3, -74, 15, 119, -11, -45, 120, -71, -12, 111, 28, 81, 120, -50, -30, 11, -36, -90, -111, -104, 34, -115, -103, 68, 55, 80, 79, -87, 87, -47, -84, -78, -76, -63, -90, 42, -104, 12, -16, 53, -54, -2, -32, 102, 93, -40, -7, -64, 118, 25, -18, 127, -73, 17, 2, 66, 11, -78, -127, 18, 37, -111, -15, -53, 35, 84, 97, -113, 26, 57, 86, -128, -59, 67, -123, -120, -121, 57, -98, -95, 44, 117, 14, 116, 42, 38, -76, -22, -14, -37, -36, -56, 53, -121, -116, -17, -102, -99, -23, 34, -52, 73, -86, -56, -38, -80, -23, 124, 125, 36, 94, -32, -76, 69, -43, 37, 109, 118, 80, -84, 49, 111, 67, -125, 43, -113, 101, 87, -110, -16, -96, 18, 110, 124, -37, -110, -100, 107, -109, -73, -39, -109, -25, 93, 83, -73, -88, 34, 29, -89, 93, -22, -77, 25, 53, 74, 11, 116, -41, -85, 92, -106, 96, 38, -110, 12, 30, 63, 23, 78, -94, 109, 40, 82, 65, -16, 40, 48, -12, 57, -99, -53, -67, -73, 122, 49, -27, -19, 99, 95, -69, -124, -88, 40, -40, -74, -55, 15, -81, -55, 60, -50, -25, 96, -54, 119, 96, 66, -82, -94, 28, -78, -31, -23, 38, 12, 38, 24, 96, 24, 115, 10, 13, 61, 33, 7, -87, -111, -90, 48, 53, -90, 78, -17, -31, 68, 124, -65, -101, 8, 64, -125, -43, 7, 69, 89, 13, 77, 57, 46, 83, -19, -82, 95, -85, -49, 86, -102, -71, 55, -57, 10, -120, -103, -56, 34, 101, 59, -62, -90, 95, -56, 54, -49, 0, -127, -43, -27, 32, 2, 55, -117, -97, 2, -33, 62, -77, -16, -64, 40, -55, -112, 36, 46, 98, -64, -44, -78, -85, -63, 74, -119, -4, -80, -14, 11, -78, -123, -114, 38, 76, -115, 43, -99, -110, -16, -26, -47, -34, 35, 93, -69, -78, -53, 23, 127, 100, 90, -37, 13, 105, 88, 48, -103, 127, -112, -62, -23, 120, 37, 29, -9, -92, -65, 30, -31, -59, 34, 24, -52, -53, 75, 89, 38, 92, -98, 100, 34, 4, 23, 55, -105, 121, 60, -119, -61, -119, -68, -121, -106, -8, 59, 73, 65, 80, -87, 86, 69, 114, 56, -102, 55, 32, -121, 15, 6, 41, -49, -109, -6, -93, -44, 127, -26, -33, -116, -16, -45, 20, 48, 43, 36, -88, -59, -55, -68, 73, 77, -95, -90, -25, -52, 29, 54, -77, 58, 65, -36, 106, 127, 26, 93, -128, -5, -115, 113, 72, 79, -68, -43, -49, 33, -19, -42, 51, -44, 72, 37, -26, -43, 54, 20, 66, -125, -101, 98, 16, 9, -10, 116, 78, 88, 39, 98, -3, 83, 99, -97, 90, 2, -35, -40, 103, 41, -70, -59, -4, -112, -19, 91, 124, -79, 35, 4, -123, 0, -91, 38, 13, -106, -69, -76, 55, 69, 47, 2, 3, 1, 0, 1};
        byte[] destinationPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -58, -30, 99, -1, 30, 32, 80, 91, -121, -126, -30, 17, -55, 44, -33, -12, -42, 54, 56, -114, 38, 61, 8, 12, 104, -97, 127, 3, -74, 15, 119, -11, -45, 120, -71, -12, 111, 28, 81, 120, -50, -30, 11, -36, -90, -111, -104, 34, -115, -103, 68, 55, 80, 79, -87, 87, -47, -84, -78, -76, -63, -90, 42, -104, 12, -16, 53, -54, -2, -32, 102, 93, -40, -7, -64, 118, 25, -18, 127, -73, 17, 2, 66, 11, -78, -127, 18, 37, -111, -15, -53, 35, 84, 97, -113, 26, 57, 86, -128, -59, 67, -123, -120, -121, 57, -98, -95, 44, 117, 14, 116, 42, 38, -76, -22, -14, -37, -36, -56, 53, -121, -116, -17, -102, -99, -23, 34, -52, 73, -86, -56, -38, -80, -23, 124, 125, 36, 94, -32, -76, 69, -43, 37, 109, 118, 80, -84, 49, 111, 67, -125, 43, -113, 101, 87, -110, -16, -96, 18, 110, 124, -37, -110, -100, 107, -109, -73, -39, -109, -25, 93, 83, -73, -88, 34, 29, -89, 93, -22, -77, 25, 53, 74, 11, 116, -41, -85, 92, -106, 96, 38, -110, 12, 30, 63, 23, 78, -94, 109, 40, 82, 65, -16, 40, 48, -12, 57, -99, -53, -67, -73, 122, 49, -27, -19, 99, 95, -69, -124, -88, 40, -40, -74, -55, 15, -81, -55, 60, -50, -25, 96, -54, 119, 96, 66, -82, -94, 28, -78, -31, -23, 38, 12, 38, 24, 96, 24, 115, 10, 13, 61, 33, 7, -87, -111, -90, 48, 53, -90, 78, -17, -31, 68, 124, -65, -101, 8, 64, -125, -43, 7, 69, 89, 13, 77, 57, 46, 83, -19, -82, 95, -85, -49, 86, -102, -71, 55, -57, 10, -120, -103, -56, 34, 101, 59, -62, -90, 95, -56, 54, -49, 0, -127, -43, -27, 32, 2, 55, -117, -97, 2, -33, 62, -77, -16, -64, 40, -55, -112, 36, 46, 98, -64, -44, -78, -85, -63, 74, -119, -4, -80, -14, 11, -78, -123, -114, 38, 76, -115, 43, -99, -110, -16, -26, -47, -34, 35, 93, -69, -78, -53, 23, 127, 100, 90, -37, 13, 105, 88, 48, -103, 127, -112, -62, -23, 120, 37, 29, -9, -92, -65, 30, -31, -59, 34, 24, -52, -53, 75, 89, 38, 92, -98, 100, 34, 4, 23, 55, -105, 121, 60, -119, -61, -119, -68, -121, -106, -8, 59, 73, 65, 80, -87, 86, 69, 114, 56, -102, 55, 32, -121, 15, 6, 41, -49, -109, -6, -93, -44, 127, -26, -33, -116, -16, -45, 20, 48, 43, 36, -88, -59, -55, -68, 73, 77, -95, -90, -25, -52, 29, 54, -77, 58, 65, -36, 106, 127, 26, 93, -128, -5, -115, 113, 72, 79, -68, -43, -49, 33, -19, -42, 51, -44, 72, 37, -26, -43, 54, 20, 66, -125, -101, 98, 16, 9, -10, 116, 78, 88, 39, 98, -3, 83, 99, -97, 90, 2, -35, -40, 103, 41, -70, -59, -4, -112, -19, 91, 124, -79, 35, 4, -123, 0, -91, 38, 13, -106, -69, -76, 55, 69, 47, 2, 3, 1, 0, 1};
        int amount = 10;
        int incrementedNonce = -2079421024;

        assertThrows(SignatureExceptions.class, () -> Client.sendAmountCheckResponse(serverPublicKey, signature, sourcePublicKey, destinationPublicKey, amount, incrementedNonce));
    }

    @Test
    void send_amount_nonce_mismatch() {
        byte[] serverPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -75, -102, -29, 1, -20, -99, 103, -94, 65, 88, -99, -41, 7, 76, 107, 121, 116, 20, -19, 96, 44, 106, -104, -91, 4, -20, 55, -76, 67, 110, 60, 48, 63, 26, 21, 19, -115, 38, 60, 32, 110, -4, 21, 96, 72, 73, -47, -118, -45, -61, -53, -50, 11, -29, -25, -83, -67, -62, 100, -81, -54, -56, 85, -99, -89, -84, 56, 17, -118, 26, -35, -35, -77, 110, -103, 29, -20, -39, 71, -52, -90, 23, 0, 60, 64, 75, -50, -70, 20, -71, -110, 33, 15, 96, -77, 66, 109, 53, 83, 48, 2, -45, -67, -119, 17, 72, -38, 32, -72, 2, 15, -76, -35, -41, 62, -3, -4, -100, -80, 83, -74, -58, -72, -31, -84, -106, -44, 104, -71, -6, 82, -1, -105, 5, 127, 42, 107, -56, 9, 121, -34, 63, 56, -77, -36, 83, 105, -91, -69, -54, -46, -80, -34, 48, 36, 10, 66, 50, 29, -42, -13, -91, -42, 64, -85, -46, 77, 0, 78, -35, 52, 68, 41, 59, 100, -21, 126, 51, 26, -51, 60, 75, -83, 121, 121, 120, -29, 82, -112, 60, 2, 3, 37, 45, 35, -39, -113, 39, -18, -32, -40, -76, 61, 69, 92, -62, 98, 19, -35, 66, -14, -30, 74, -126, -53, -21, 125, -13, 15, -123, -122, -32, -88, 21, -50, -46, 21, 11, -115, 95, -44, -72, 9, -50, 93, 42, 73, -54, -31, -12, -84, 27, -53, 68, 114, 20, 67, 103, 108, 29, -113, 23, 4, -49, 111, 82, 59, -55, -86, -102, 106, -10, 49, -72, -120, -106, 78, -24, -114, -43, -8, 106, 121, -23, 116, 115, -17, -122, -31, 16, -6, -121, 105, -70, 33, 88, 73, 80, -108, -69, -110, -96, 111, 111, -5, -85, 120, 15, -65, -49, -114, 0, 7, 120, -47, -116, 117, -128, -2, -59, -69, -75, -5, 14, -64, 118, -16, -68, -18, 13, -70, -95, 70, 17, 46, -34, 59, 99, -75, -127, -77, -5, -57, 65, -87, -118, 96, -56, 123, 56, -27, -49, 49, 100, -117, 64, -56, -17, 46, 121, -71, -119, -86, 25, -49, -122, -80, -47, 121, 9, -63, -85, -7, -44, -1, 89, -110, -80, 53, 101, -80, -57, -49, 3, 30, 14, -99, -75, -71, -45, -77, 25, 94, 89, 8, -31, 21, -117, 71, -91, 73, 8, -91, 126, -45, 74, 126, 86, 123, -80, -5, -64, -97, 89, -75, 78, -22, -108, -82, -22, -6, 84, -45, -39, -86, 116, -61, 35, -16, 39, -53, -52, -39, 76, 16, -43, -43, 36, 11, 30, 58, 44, -58, 110, -90, -104, -28, 90, 79, -37, 55, -33, 108, 67, 39, -79, 88, 115, -117, 4, 70, -84, -35, -54, -9, 14, -88, -23, 94, -7, -80, -93, 15, 54, -51, 12, -59, -1, -105, -10, -65, 57, 83, 45, -39, 24, 43, -58, -13, 39, -17, -68, 20, 79, -124, 74, -47, -3, 40, -103, -101, 116, -125, -6, -22, -51, 66, -118, 38, 99, 69, -82, -9, -118, 86, 72, 87, 119, -37, -115, -116, -27, 2, 3, 1, 0, 1};
        byte[] signature = {20, 80, -33, 11, 117, -110, 1, 63, 60, -82, -97, -18, -84, 105, 59, 78, 39, 73, -119, 14, -58, -26, 25, 85, 39, -9, 122, 112, 76, 25, -23, -6, -15, 26, -67, -25, 43, 23, -99, 97, 19, 117, -84, 85, -9, -92, 9, -89, 96, -73, 52, 85, 18, -18, 55, -32, 99, 25, 52, 9, 24, 88, -126, 86, -20, 54, -124, 121, 10, 54, -34, -34, 100, -47, 68, -18, -77, 81, 60, -66, 51, -121, -127, -64, 40, -61, -89, 74, -51, -117, -123, -34, -37, 113, -48, -80, 100, 121, 22, 30, -100, 17, -8, 13, -128, -61, -62, 104, 117, 120, -81, 5, 113, -93, 2, -38, 121, 14, -64, 3, 24, -10, 23, 102, 86, -53, -35, 70, 126, -19, 103, -5, 71, -8, -98, 32, 126, 6, 125, -61, -32, 63, 19, -45, -100, 15, -126, 115, 52, -99, -122, -51, -86, 89, -128, -65, 9, -82, -13, -50, 88, 42, 57, -128, 61, 83, -54, 46, -95, 69, -105, 64, -39, -71, 121, 91, 5, 81, 0, -83, -51, 124, 125, 124, -86, -120, -17, 60, 43, -42, -63, -35, -32, -110, -52, -97, 111, 121, 5, 99, 34, -82, 33, -96, 91, -122, -51, 57, 111, 18, 56, -79, -20, -36, -70, 102, -62, -108, -114, 52, -45, 44, 37, 36, 62, 110, -55, -92, -56, 52, 112, -1, 62, -69, -119, 97, -15, -112, -27, 52, 120, -88, 26, -70, 61, -61, -67, -92, 49, -2, -91, -45, -99, -88, 112, -25, -3, -61, 114, 40, 40, -7, 121, 23, 12, 83, 84, -103, -111, -60, -10, 68, -14, 95, 88, -112, 56, -70, 81, -123, 117, -108, -40, 103, 46, 112, -71, -78, 17, -35, -76, 68, 85, 59, 66, 59, 124, 10, 45, 120, 12, 119, 31, 39, 72, -13, 11, 61, -119, 12, -82, -70, 89, 74, 36, -16, 110, -74, -46, 40, -46, -117, -97, 23, -120, 67, -60, 21, 56, -128, -17, 16, -106, 20, 109, 127, 6, 97, 13, -116, 115, 127, 75, -64, 66, 51, -109, 44, 40, 15, 115, 127, 48, -116, 46, 120, -14, -108, -122, -125, -36, -86, -98, 21, -70, -117, -54, -72, -108, -122, -23, 2, -96, 26, -4, 46, -112, -17, 22, 98, 121, 69, -120, -20, -52, -100, -45, 51, -50, -111, -45, 94, -113, 26, -103, 74, -36, -107, -22, -62, -21, -122, -14, -69, -5, -91, 41, -4, 32, 26, 3, -37, -20, -84, 120, 20, 45, 22, -90, -119, 73, -117, -36, 108, -25, 69, 44, 88, -96, -12, 81, -62, 25, -35, -49, 31, 56, 84, 46, 64, -16, -79, 99, -6, 100, 38, 78, 41, 53, -24, 18, -100, 122, 35, 75, 126, -1, 122, 65, -59, 67, -9, 68, 9, 36, -102, -10, 76, 66, -86, -42, 46, 103, 78, -94, -39, -30, 118, -26, 93, -93, 106, -82, -94, -118, -96, 123, 96, 36, 72, 56, 0, 127, -95, 11, -46, 59, -124, -33, -67, -101, 6, -85, -36, 6, -100, 94, 71, -49, -21, 39, 60};
        byte[] sourcePublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -58, -30, 99, -1, 30, 32, 80, 91, -121, -126, -30, 17, -55, 44, -33, -12, -42, 54, 56, -114, 38, 61, 8, 12, 104, -97, 127, 3, -74, 15, 119, -11, -45, 120, -71, -12, 111, 28, 81, 120, -50, -30, 11, -36, -90, -111, -104, 34, -115, -103, 68, 55, 80, 79, -87, 87, -47, -84, -78, -76, -63, -90, 42, -104, 12, -16, 53, -54, -2, -32, 102, 93, -40, -7, -64, 118, 25, -18, 127, -73, 17, 2, 66, 11, -78, -127, 18, 37, -111, -15, -53, 35, 84, 97, -113, 26, 57, 86, -128, -59, 67, -123, -120, -121, 57, -98, -95, 44, 117, 14, 116, 42, 38, -76, -22, -14, -37, -36, -56, 53, -121, -116, -17, -102, -99, -23, 34, -52, 73, -86, -56, -38, -80, -23, 124, 125, 36, 94, -32, -76, 69, -43, 37, 109, 118, 80, -84, 49, 111, 67, -125, 43, -113, 101, 87, -110, -16, -96, 18, 110, 124, -37, -110, -100, 107, -109, -73, -39, -109, -25, 93, 83, -73, -88, 34, 29, -89, 93, -22, -77, 25, 53, 74, 11, 116, -41, -85, 92, -106, 96, 38, -110, 12, 30, 63, 23, 78, -94, 109, 40, 82, 65, -16, 40, 48, -12, 57, -99, -53, -67, -73, 122, 49, -27, -19, 99, 95, -69, -124, -88, 40, -40, -74, -55, 15, -81, -55, 60, -50, -25, 96, -54, 119, 96, 66, -82, -94, 28, -78, -31, -23, 38, 12, 38, 24, 96, 24, 115, 10, 13, 61, 33, 7, -87, -111, -90, 48, 53, -90, 78, -17, -31, 68, 124, -65, -101, 8, 64, -125, -43, 7, 69, 89, 13, 77, 57, 46, 83, -19, -82, 95, -85, -49, 86, -102, -71, 55, -57, 10, -120, -103, -56, 34, 101, 59, -62, -90, 95, -56, 54, -49, 0, -127, -43, -27, 32, 2, 55, -117, -97, 2, -33, 62, -77, -16, -64, 40, -55, -112, 36, 46, 98, -64, -44, -78, -85, -63, 74, -119, -4, -80, -14, 11, -78, -123, -114, 38, 76, -115, 43, -99, -110, -16, -26, -47, -34, 35, 93, -69, -78, -53, 23, 127, 100, 90, -37, 13, 105, 88, 48, -103, 127, -112, -62, -23, 120, 37, 29, -9, -92, -65, 30, -31, -59, 34, 24, -52, -53, 75, 89, 38, 92, -98, 100, 34, 4, 23, 55, -105, 121, 60, -119, -61, -119, -68, -121, -106, -8, 59, 73, 65, 80, -87, 86, 69, 114, 56, -102, 55, 32, -121, 15, 6, 41, -49, -109, -6, -93, -44, 127, -26, -33, -116, -16, -45, 20, 48, 43, 36, -88, -59, -55, -68, 73, 77, -95, -90, -25, -52, 29, 54, -77, 58, 65, -36, 106, 127, 26, 93, -128, -5, -115, 113, 72, 79, -68, -43, -49, 33, -19, -42, 51, -44, 72, 37, -26, -43, 54, 20, 66, -125, -101, 98, 16, 9, -10, 116, 78, 88, 39, 98, -3, 83, 99, -97, 90, 2, -35, -40, 103, 41, -70, -59, -4, -112, -19, 91, 124, -79, 35, 4, -123, 0, -91, 38, 13, -106, -69, -76, 55, 69, 47, 2, 3, 1, 0, 1};
        byte[] destinationPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -58, -30, 99, -1, 30, 32, 80, 91, -121, -126, -30, 17, -55, 44, -33, -12, -42, 54, 56, -114, 38, 61, 8, 12, 104, -97, 127, 3, -74, 15, 119, -11, -45, 120, -71, -12, 111, 28, 81, 120, -50, -30, 11, -36, -90, -111, -104, 34, -115, -103, 68, 55, 80, 79, -87, 87, -47, -84, -78, -76, -63, -90, 42, -104, 12, -16, 53, -54, -2, -32, 102, 93, -40, -7, -64, 118, 25, -18, 127, -73, 17, 2, 66, 11, -78, -127, 18, 37, -111, -15, -53, 35, 84, 97, -113, 26, 57, 86, -128, -59, 67, -123, -120, -121, 57, -98, -95, 44, 117, 14, 116, 42, 38, -76, -22, -14, -37, -36, -56, 53, -121, -116, -17, -102, -99, -23, 34, -52, 73, -86, -56, -38, -80, -23, 124, 125, 36, 94, -32, -76, 69, -43, 37, 109, 118, 80, -84, 49, 111, 67, -125, 43, -113, 101, 87, -110, -16, -96, 18, 110, 124, -37, -110, -100, 107, -109, -73, -39, -109, -25, 93, 83, -73, -88, 34, 29, -89, 93, -22, -77, 25, 53, 74, 11, 116, -41, -85, 92, -106, 96, 38, -110, 12, 30, 63, 23, 78, -94, 109, 40, 82, 65, -16, 40, 48, -12, 57, -99, -53, -67, -73, 122, 49, -27, -19, 99, 95, -69, -124, -88, 40, -40, -74, -55, 15, -81, -55, 60, -50, -25, 96, -54, 119, 96, 66, -82, -94, 28, -78, -31, -23, 38, 12, 38, 24, 96, 24, 115, 10, 13, 61, 33, 7, -87, -111, -90, 48, 53, -90, 78, -17, -31, 68, 124, -65, -101, 8, 64, -125, -43, 7, 69, 89, 13, 77, 57, 46, 83, -19, -82, 95, -85, -49, 86, -102, -71, 55, -57, 10, -120, -103, -56, 34, 101, 59, -62, -90, 95, -56, 54, -49, 0, -127, -43, -27, 32, 2, 55, -117, -97, 2, -33, 62, -77, -16, -64, 40, -55, -112, 36, 46, 98, -64, -44, -78, -85, -63, 74, -119, -4, -80, -14, 11, -78, -123, -114, 38, 76, -115, 43, -99, -110, -16, -26, -47, -34, 35, 93, -69, -78, -53, 23, 127, 100, 90, -37, 13, 105, 88, 48, -103, 127, -112, -62, -23, 120, 37, 29, -9, -92, -65, 30, -31, -59, 34, 24, -52, -53, 75, 89, 38, 92, -98, 100, 34, 4, 23, 55, -105, 121, 60, -119, -61, -119, -68, -121, -106, -8, 59, 73, 65, 80, -87, 86, 69, 114, 56, -102, 55, 32, -121, 15, 6, 41, -49, -109, -6, -93, -44, 127, -26, -33, -116, -16, -45, 20, 48, 43, 36, -88, -59, -55, -68, 73, 77, -95, -90, -25, -52, 29, 54, -77, 58, 65, -36, 106, 127, 26, 93, -128, -5, -115, 113, 72, 79, -68, -43, -49, 33, -19, -42, 51, -44, 72, 37, -26, -43, 54, 20, 66, -125, -101, 98, 16, 9, -10, 116, 78, 88, 39, 98, -3, 83, 99, -97, 90, 2, -35, -40, 103, 41, -70, -59, -4, -112, -19, 91, 124, -79, 35, 4, -123, 0, -91, 38, 13, -106, -69, -76, 55, 69, 47, 2, 3, 1, 0, 1};
        int amount = 10;
        int nonce = -2079421023;

        assertThrows(SignatureExceptions.class, () -> Client.sendAmountCheckResponse(serverPublicKey, signature, sourcePublicKey, destinationPublicKey, amount, nonce));
    }

    @Test
    void receive_amount_normal() {
        byte[] serverPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -75, -102, -29, 1, -20, -99, 103, -94, 65, 88, -99, -41, 7, 76, 107, 121, 116, 20, -19, 96, 44, 106, -104, -91, 4, -20, 55, -76, 67, 110, 60, 48, 63, 26, 21, 19, -115, 38, 60, 32, 110, -4, 21, 96, 72, 73, -47, -118, -45, -61, -53, -50, 11, -29, -25, -83, -67, -62, 100, -81, -54, -56, 85, -99, -89, -84, 56, 17, -118, 26, -35, -35, -77, 110, -103, 29, -20, -39, 71, -52, -90, 23, 0, 60, 64, 75, -50, -70, 20, -71, -110, 33, 15, 96, -77, 66, 109, 53, 83, 48, 2, -45, -67, -119, 17, 72, -38, 32, -72, 2, 15, -76, -35, -41, 62, -3, -4, -100, -80, 83, -74, -58, -72, -31, -84, -106, -44, 104, -71, -6, 82, -1, -105, 5, 127, 42, 107, -56, 9, 121, -34, 63, 56, -77, -36, 83, 105, -91, -69, -54, -46, -80, -34, 48, 36, 10, 66, 50, 29, -42, -13, -91, -42, 64, -85, -46, 77, 0, 78, -35, 52, 68, 41, 59, 100, -21, 126, 51, 26, -51, 60, 75, -83, 121, 121, 120, -29, 82, -112, 60, 2, 3, 37, 45, 35, -39, -113, 39, -18, -32, -40, -76, 61, 69, 92, -62, 98, 19, -35, 66, -14, -30, 74, -126, -53, -21, 125, -13, 15, -123, -122, -32, -88, 21, -50, -46, 21, 11, -115, 95, -44, -72, 9, -50, 93, 42, 73, -54, -31, -12, -84, 27, -53, 68, 114, 20, 67, 103, 108, 29, -113, 23, 4, -49, 111, 82, 59, -55, -86, -102, 106, -10, 49, -72, -120, -106, 78, -24, -114, -43, -8, 106, 121, -23, 116, 115, -17, -122, -31, 16, -6, -121, 105, -70, 33, 88, 73, 80, -108, -69, -110, -96, 111, 111, -5, -85, 120, 15, -65, -49, -114, 0, 7, 120, -47, -116, 117, -128, -2, -59, -69, -75, -5, 14, -64, 118, -16, -68, -18, 13, -70, -95, 70, 17, 46, -34, 59, 99, -75, -127, -77, -5, -57, 65, -87, -118, 96, -56, 123, 56, -27, -49, 49, 100, -117, 64, -56, -17, 46, 121, -71, -119, -86, 25, -49, -122, -80, -47, 121, 9, -63, -85, -7, -44, -1, 89, -110, -80, 53, 101, -80, -57, -49, 3, 30, 14, -99, -75, -71, -45, -77, 25, 94, 89, 8, -31, 21, -117, 71, -91, 73, 8, -91, 126, -45, 74, 126, 86, 123, -80, -5, -64, -97, 89, -75, 78, -22, -108, -82, -22, -6, 84, -45, -39, -86, 116, -61, 35, -16, 39, -53, -52, -39, 76, 16, -43, -43, 36, 11, 30, 58, 44, -58, 110, -90, -104, -28, 90, 79, -37, 55, -33, 108, 67, 39, -79, 88, 115, -117, 4, 70, -84, -35, -54, -9, 14, -88, -23, 94, -7, -80, -93, 15, 54, -51, 12, -59, -1, -105, -10, -65, 57, 83, 45, -39, 24, 43, -58, -13, 39, -17, -68, 20, 79, -124, 74, -47, -3, 40, -103, -101, 116, -125, -6, -22, -51, 66, -118, 38, 99, 69, -82, -9, -118, 86, 72, 87, 119, -37, -115, -116, -27, 2, 3, 1, 0, 1};
        byte[] accountPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -58, -30, 99, -1, 30, 32, 80, 91, -121, -126, -30, 17, -55, 44, -33, -12, -42, 54, 56, -114, 38, 61, 8, 12, 104, -97, 127, 3, -74, 15, 119, -11, -45, 120, -71, -12, 111, 28, 81, 120, -50, -30, 11, -36, -90, -111, -104, 34, -115, -103, 68, 55, 80, 79, -87, 87, -47, -84, -78, -76, -63, -90, 42, -104, 12, -16, 53, -54, -2, -32, 102, 93, -40, -7, -64, 118, 25, -18, 127, -73, 17, 2, 66, 11, -78, -127, 18, 37, -111, -15, -53, 35, 84, 97, -113, 26, 57, 86, -128, -59, 67, -123, -120, -121, 57, -98, -95, 44, 117, 14, 116, 42, 38, -76, -22, -14, -37, -36, -56, 53, -121, -116, -17, -102, -99, -23, 34, -52, 73, -86, -56, -38, -80, -23, 124, 125, 36, 94, -32, -76, 69, -43, 37, 109, 118, 80, -84, 49, 111, 67, -125, 43, -113, 101, 87, -110, -16, -96, 18, 110, 124, -37, -110, -100, 107, -109, -73, -39, -109, -25, 93, 83, -73, -88, 34, 29, -89, 93, -22, -77, 25, 53, 74, 11, 116, -41, -85, 92, -106, 96, 38, -110, 12, 30, 63, 23, 78, -94, 109, 40, 82, 65, -16, 40, 48, -12, 57, -99, -53, -67, -73, 122, 49, -27, -19, 99, 95, -69, -124, -88, 40, -40, -74, -55, 15, -81, -55, 60, -50, -25, 96, -54, 119, 96, 66, -82, -94, 28, -78, -31, -23, 38, 12, 38, 24, 96, 24, 115, 10, 13, 61, 33, 7, -87, -111, -90, 48, 53, -90, 78, -17, -31, 68, 124, -65, -101, 8, 64, -125, -43, 7, 69, 89, 13, 77, 57, 46, 83, -19, -82, 95, -85, -49, 86, -102, -71, 55, -57, 10, -120, -103, -56, 34, 101, 59, -62, -90, 95, -56, 54, -49, 0, -127, -43, -27, 32, 2, 55, -117, -97, 2, -33, 62, -77, -16, -64, 40, -55, -112, 36, 46, 98, -64, -44, -78, -85, -63, 74, -119, -4, -80, -14, 11, -78, -123, -114, 38, 76, -115, 43, -99, -110, -16, -26, -47, -34, 35, 93, -69, -78, -53, 23, 127, 100, 90, -37, 13, 105, 88, 48, -103, 127, -112, -62, -23, 120, 37, 29, -9, -92, -65, 30, -31, -59, 34, 24, -52, -53, 75, 89, 38, 92, -98, 100, 34, 4, 23, 55, -105, 121, 60, -119, -61, -119, -68, -121, -106, -8, 59, 73, 65, 80, -87, 86, 69, 114, 56, -102, 55, 32, -121, 15, 6, 41, -49, -109, -6, -93, -44, 127, -26, -33, -116, -16, -45, 20, 48, 43, 36, -88, -59, -55, -68, 73, 77, -95, -90, -25, -52, 29, 54, -77, 58, 65, -36, 106, 127, 26, 93, -128, -5, -115, 113, 72, 79, -68, -43, -49, 33, -19, -42, 51, -44, 72, 37, -26, -43, 54, 20, 66, -125, -101, 98, 16, 9, -10, 116, 78, 88, 39, 98, -3, 83, 99, -97, 90, 2, -35, -40, 103, 41, -70, -59, -4, -112, -19, 91, 124, -79, 35, 4, -123, 0, -91, 38, 13, -106, -69, -76, 55, 69, 47, 2, 3, 1, 0, 1};
        byte[] signature = {104, -19, 39, -67, -105, -93, 68, -11, 8, 61, 4, -82, 13, -47, -114, 45, 42, -36, -31, -106, 22, -5, 6, -72, -48, -67, -100, -87, 124, 52, -14, -21, 47, -43, 106, -48, -27, -26, -72, 86, 3, 32, -49, -71, -8, -123, -21, -66, -71, 88, -57, -111, 42, -116, 25, -57, 31, -85, -21, 46, 98, 118, -68, -7, 122, 126, -61, 43, -47, -76, 14, 4, 98, -3, -123, -95, 0, 14, -100, -10, -14, -44, -95, 48, 65, 44, 63, 26, 107, 69, -23, -23, 112, -8, -108, 28, 70, -18, 11, 88, 10, -55, 65, 32, 0, -70, 74, 127, -107, 23, -80, -23, -79, -22, -21, 49, 125, -5, -114, 48, 45, 11, 24, -3, -34, 73, -100, -72, -50, -76, -40, 78, 94, -105, 121, -71, -67, 119, -120, -50, 70, 7, 7, -70, 3, -75, 8, -85, -54, 52, 14, 127, 5, -66, -14, 88, -105, 19, -87, 92, -30, 76, -89, -65, -58, 43, 38, -74, -99, -39, 111, -95, 54, -91, 119, 57, 117, -49, -109, 98, 20, 64, 111, -106, 64, -20, -53, -33, -77, -26, -42, -4, 56, -27, 47, -30, -88, 24, -124, 57, 48, 0, -45, 5, -97, -2, 120, 1, 16, -63, -110, -17, 5, -108, -48, 106, 119, -24, 86, -101, 48, -1, 28, -55, 21, 75, -55, 79, 93, -12, 58, -4, 43, 125, 118, 106, -40, 116, 64, -111, -3, -79, -54, -35, -64, 97, 92, -115, -88, 117, 42, 40, 17, 35, -17, 24, 122, 103, 52, -10, 87, -31, 64, 124, 22, 21, 122, 96, 75, 95, 119, -119, 23, -80, 73, -7, -83, -77, -79, 75, -54, 2, -28, 86, -37, 56, 102, 90, -73, -10, 78, -7, -1, 121, -30, 76, -72, 92, 52, 112, -52, 112, -77, 120, 59, -4, -53, 0, -119, 71, -91, -32, -48, 103, 62, 95, -120, -127, 30, -124, -11, 67, 51, -54, -106, 24, -13, -47, 67, 48, -56, -56, 8, 30, -43, 47, -92, -87, -123, -74, -58, 124, -38, -8, 106, -3, -50, -86, 114, 31, 75, 104, -87, -22, 102, 48, -94, -60, -55, -107, 40, 26, -93, -81, -39, 123, -81, -36, 70, 52, 91, -20, -92, 1, -122, -105, 29, 81, 113, 20, -34, -52, 76, -54, -120, -83, -104, 25, 88, -68, 115, -80, 8, 10, 97, -27, -66, -111, 82, 22, -106, -126, 81, 121, -45, -11, -20, -55, 57, -3, 49, -44, 75, 18, -37, -97, -106, 43, 50, -36, 41, 73, -53, 90, -7, -10, -106, 80, 61, 85, -82, 49, 105, 47, -62, 70, -69, 15, 98, 115, 44, -41, 23, -34, -61, 96, -98, -128, 71, -87, 80, -12, 13, -14, 3, 30, 100, 72, -2, -53, -98, 46, -65, -61, 93, -13, 124, -59, 100, -99, 101, 11, 46, 89, 34, -2, 59, -49, -20, -34, 74, -96, 18, 81, -19, -49, 25, -78, -20, 95, -18, 35, -125, -2, 98, -5, -100, 85, -40, 68, -3, 124, 12, 47, 42, 19, 127, 72, -40, 70, -68, 34};
        int transactionID = 8;
        assertDoesNotThrow(() -> Client.receiveAmountCheckResponse(serverPublicKey, signature, accountPublicKey, transactionID));
    }

    @Test
    void receive_amount_signature_mismatch() {
        byte[] serverPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -75, -102, -29, 1, -20, -99, 103, -94, 65, 88, -99, -41, 7, 76, 107, 121, 116, 20, -19, 96, 44, 106, -104, -91, 4, -20, 55, -76, 67, 110, 60, 48, 63, 26, 21, 19, -115, 38, 60, 32, 110, -4, 21, 96, 72, 73, -47, -118, -45, -61, -53, -50, 11, -29, -25, -83, -67, -62, 100, -81, -54, -56, 85, -99, -89, -84, 56, 17, -118, 26, -35, -35, -77, 110, -103, 29, -20, -39, 71, -52, -90, 23, 0, 60, 64, 75, -50, -70, 20, -71, -110, 33, 15, 96, -77, 66, 109, 53, 83, 48, 2, -45, -67, -119, 17, 72, -38, 32, -72, 2, 15, -76, -35, -41, 62, -3, -4, -100, -80, 83, -74, -58, -72, -31, -84, -106, -44, 104, -71, -6, 82, -1, -105, 5, 127, 42, 107, -56, 9, 121, -34, 63, 56, -77, -36, 83, 105, -91, -69, -54, -46, -80, -34, 48, 36, 10, 66, 50, 29, -42, -13, -91, -42, 64, -85, -46, 77, 0, 78, -35, 52, 68, 41, 59, 100, -21, 126, 51, 26, -51, 60, 75, -83, 121, 121, 120, -29, 82, -112, 60, 2, 3, 37, 45, 35, -39, -113, 39, -18, -32, -40, -76, 61, 69, 92, -62, 98, 19, -35, 66, -14, -30, 74, -126, -53, -21, 125, -13, 15, -123, -122, -32, -88, 21, -50, -46, 21, 11, -115, 95, -44, -72, 9, -50, 93, 42, 73, -54, -31, -12, -84, 27, -53, 68, 114, 20, 67, 103, 108, 29, -113, 23, 4, -49, 111, 82, 59, -55, -86, -102, 106, -10, 49, -72, -120, -106, 78, -24, -114, -43, -8, 106, 121, -23, 116, 115, -17, -122, -31, 16, -6, -121, 105, -70, 33, 88, 73, 80, -108, -69, -110, -96, 111, 111, -5, -85, 120, 15, -65, -49, -114, 0, 7, 120, -47, -116, 117, -128, -2, -59, -69, -75, -5, 14, -64, 118, -16, -68, -18, 13, -70, -95, 70, 17, 46, -34, 59, 99, -75, -127, -77, -5, -57, 65, -87, -118, 96, -56, 123, 56, -27, -49, 49, 100, -117, 64, -56, -17, 46, 121, -71, -119, -86, 25, -49, -122, -80, -47, 121, 9, -63, -85, -7, -44, -1, 89, -110, -80, 53, 101, -80, -57, -49, 3, 30, 14, -99, -75, -71, -45, -77, 25, 94, 89, 8, -31, 21, -117, 71, -91, 73, 8, -91, 126, -45, 74, 126, 86, 123, -80, -5, -64, -97, 89, -75, 78, -22, -108, -82, -22, -6, 84, -45, -39, -86, 116, -61, 35, -16, 39, -53, -52, -39, 76, 16, -43, -43, 36, 11, 30, 58, 44, -58, 110, -90, -104, -28, 90, 79, -37, 55, -33, 108, 67, 39, -79, 88, 115, -117, 4, 70, -84, -35, -54, -9, 14, -88, -23, 94, -7, -80, -93, 15, 54, -51, 12, -59, -1, -105, -10, -65, 57, 83, 45, -39, 24, 43, -58, -13, 39, -17, -68, 20, 79, -124, 74, -47, -3, 40, -103, -101, 116, -125, -6, -22, -51, 66, -118, 38, 99, 69, -82, -9, -118, 86, 72, 87, 119, -37, -115, -116, -27, 2, 3, 1, 0, 1};
        byte[] accountPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -58, -30, 99, -1, 30, 32, 80, 91, -121, -126, -30, 17, -55, 44, -33, -12, -42, 54, 56, -114, 38, 61, 8, 12, 104, -97, 127, 3, -74, 15, 119, -11, -45, 120, -71, -12, 111, 28, 81, 120, -50, -30, 11, -36, -90, -111, -104, 34, -115, -103, 68, 55, 80, 79, -87, 87, -47, -84, -78, -76, -63, -90, 42, -104, 12, -16, 53, -54, -2, -32, 102, 93, -40, -7, -64, 118, 25, -18, 127, -73, 17, 2, 66, 11, -78, -127, 18, 37, -111, -15, -53, 35, 84, 97, -113, 26, 57, 86, -128, -59, 67, -123, -120, -121, 57, -98, -95, 44, 117, 14, 116, 42, 38, -76, -22, -14, -37, -36, -56, 53, -121, -116, -17, -102, -99, -23, 34, -52, 73, -86, -56, -38, -80, -23, 124, 125, 36, 94, -32, -76, 69, -43, 37, 109, 118, 80, -84, 49, 111, 67, -125, 43, -113, 101, 87, -110, -16, -96, 18, 110, 124, -37, -110, -100, 107, -109, -73, -39, -109, -25, 93, 83, -73, -88, 34, 29, -89, 93, -22, -77, 25, 53, 74, 11, 116, -41, -85, 92, -106, 96, 38, -110, 12, 30, 63, 23, 78, -94, 109, 40, 82, 65, -16, 40, 48, -12, 57, -99, -53, -67, -73, 122, 49, -27, -19, 99, 95, -69, -124, -88, 40, -40, -74, -55, 15, -81, -55, 60, -50, -25, 96, -54, 119, 96, 66, -82, -94, 28, -78, -31, -23, 38, 12, 38, 24, 96, 24, 115, 10, 13, 61, 33, 7, -87, -111, -90, 48, 53, -90, 78, -17, -31, 68, 124, -65, -101, 8, 64, -125, -43, 7, 69, 89, 13, 77, 57, 46, 83, -19, -82, 95, -85, -49, 86, -102, -71, 55, -57, 10, -120, -103, -56, 34, 101, 59, -62, -90, 95, -56, 54, -49, 0, -127, -43, -27, 32, 2, 55, -117, -97, 2, -33, 62, -77, -16, -64, 40, -55, -112, 36, 46, 98, -64, -44, -78, -85, -63, 74, -119, -4, -80, -14, 11, -78, -123, -114, 38, 76, -115, 43, -99, -110, -16, -26, -47, -34, 35, 93, -69, -78, -53, 23, 127, 100, 90, -37, 13, 105, 88, 48, -103, 127, -112, -62, -23, 120, 37, 29, -9, -92, -65, 30, -31, -59, 34, 24, -52, -53, 75, 89, 38, 92, -98, 100, 34, 4, 23, 55, -105, 121, 60, -119, -61, -119, -68, -121, -106, -8, 59, 73, 65, 80, -87, 86, 69, 114, 56, -102, 55, 32, -121, 15, 6, 41, -49, -109, -6, -93, -44, 127, -26, -33, -116, -16, -45, 20, 48, 43, 36, -88, -59, -55, -68, 73, 77, -95, -90, -25, -52, 29, 54, -77, 58, 65, -36, 106, 127, 26, 93, -128, -5, -115, 113, 72, 79, -68, -43, -49, 33, -19, -42, 51, -44, 72, 37, -26, -43, 54, 20, 66, -125, -101, 98, 16, 9, -10, 116, 78, 88, 39, 98, -3, 83, 99, -97, 90, 2, -35, -40, 103, 41, -70, -59, -4, -112, -19, 91, 124, -79, 35, 4, -123, 0, -91, 38, 13, -106, -69, -76, 55, 69, 47, 2, 3, 1, 0, 1};
        byte[] signature = {106, -19, 39, -67, -105, -93, 68, -11, 8, 61, 4, -82, 13, -47, -114, 45, 42, -36, -31, -106, 22, -5, 6, -72, -48, -67, -100, -87, 124, 52, -14, -21, 47, -43, 106, -48, -27, -26, -72, 86, 3, 32, -49, -71, -8, -123, -21, -66, -71, 88, -57, -111, 42, -116, 25, -57, 31, -85, -21, 46, 98, 118, -68, -7, 122, 126, -61, 43, -47, -76, 14, 4, 98, -3, -123, -95, 0, 14, -100, -10, -14, -44, -95, 48, 65, 44, 63, 26, 107, 69, -23, -23, 112, -8, -108, 28, 70, -18, 11, 88, 10, -55, 65, 32, 0, -70, 74, 127, -107, 23, -80, -23, -79, -22, -21, 49, 125, -5, -114, 48, 45, 11, 24, -3, -34, 73, -100, -72, -50, -76, -40, 78, 94, -105, 121, -71, -67, 119, -120, -50, 70, 7, 7, -70, 3, -75, 8, -85, -54, 52, 14, 127, 5, -66, -14, 88, -105, 19, -87, 92, -30, 76, -89, -65, -58, 43, 38, -74, -99, -39, 111, -95, 54, -91, 119, 57, 117, -49, -109, 98, 20, 64, 111, -106, 64, -20, -53, -33, -77, -26, -42, -4, 56, -27, 47, -30, -88, 24, -124, 57, 48, 0, -45, 5, -97, -2, 120, 1, 16, -63, -110, -17, 5, -108, -48, 106, 119, -24, 86, -101, 48, -1, 28, -55, 21, 75, -55, 79, 93, -12, 58, -4, 43, 125, 118, 106, -40, 116, 64, -111, -3, -79, -54, -35, -64, 97, 92, -115, -88, 117, 42, 40, 17, 35, -17, 24, 122, 103, 52, -10, 87, -31, 64, 124, 22, 21, 122, 96, 75, 95, 119, -119, 23, -80, 73, -7, -83, -77, -79, 75, -54, 2, -28, 86, -37, 56, 102, 90, -73, -10, 78, -7, -1, 121, -30, 76, -72, 92, 52, 112, -52, 112, -77, 120, 59, -4, -53, 0, -119, 71, -91, -32, -48, 103, 62, 95, -120, -127, 30, -124, -11, 67, 51, -54, -106, 24, -13, -47, 67, 48, -56, -56, 8, 30, -43, 47, -92, -87, -123, -74, -58, 124, -38, -8, 106, -3, -50, -86, 114, 31, 75, 104, -87, -22, 102, 48, -94, -60, -55, -107, 40, 26, -93, -81, -39, 123, -81, -36, 70, 52, 91, -20, -92, 1, -122, -105, 29, 81, 113, 20, -34, -52, 76, -54, -120, -83, -104, 25, 88, -68, 115, -80, 8, 10, 97, -27, -66, -111, 82, 22, -106, -126, 81, 121, -45, -11, -20, -55, 57, -3, 49, -44, 75, 18, -37, -97, -106, 43, 50, -36, 41, 73, -53, 90, -7, -10, -106, 80, 61, 85, -82, 49, 105, 47, -62, 70, -69, 15, 98, 115, 44, -41, 23, -34, -61, 96, -98, -128, 71, -87, 80, -12, 13, -14, 3, 30, 100, 72, -2, -53, -98, 46, -65, -61, 93, -13, 124, -59, 100, -99, 101, 11, 46, 89, 34, -2, 59, -49, -20, -34, 74, -96, 18, 81, -19, -49, 25, -78, -20, 95, -18, 35, -125, -2, 98, -5, -100, 85, -40, 68, -3, 124, 12, 47, 42, 19, 127, 72, -40, 70, -68, 34};
        int transactionID = 8;
        assertThrows(SignatureExceptions.class, () -> Client.receiveAmountCheckResponse(serverPublicKey, signature, accountPublicKey, transactionID));
    }

}