package tecnico.sec.client;

import org.junit.jupiter.api.Test;
import tecnico.sec.grpc.CheckAccountResponse;
import tecnico.sec.proto.exceptions.IOExceptions;
import tecnico.sec.proto.exceptions.KeyExceptions;
import tecnico.sec.proto.exceptions.SignatureExceptions;

import static org.junit.jupiter.api.Assertions.*;

class ClientTest {
/*
    @Test
    void open_account_normal() {
        byte[] accountPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -75, -102, -29, 1, -20, -99, 103, -94, 65, 88, -99, -41, 7, 76, 107, 121, 116, 20, -19, 96, 44, 106, -104, -91, 4, -20, 55, -76, 67, 110, 60, 48, 63, 26, 21, 19, -115, 38, 60, 32, 110, -4, 21, 96, 72, 73, -47, -118, -45, -61, -53, -50, 11, -29, -25, -83, -67, -62, 100, -81, -54, -56, 85, -99, -89, -84, 56, 17, -118, 26, -35, -35, -77, 110, -103, 29, -20, -39, 71, -52, -90, 23, 0, 60, 64, 75, -50, -70, 20, -71, -110, 33, 15, 96, -77, 66, 109, 53, 83, 48, 2, -45, -67, -119, 17, 72, -38, 32, -72, 2, 15, -76, -35, -41, 62, -3, -4, -100, -80, 83, -74, -58, -72, -31, -84, -106, -44, 104, -71, -6, 82, -1, -105, 5, 127, 42, 107, -56, 9, 121, -34, 63, 56, -77, -36, 83, 105, -91, -69, -54, -46, -80, -34, 48, 36, 10, 66, 50, 29, -42, -13, -91, -42, 64, -85, -46, 77, 0, 78, -35, 52, 68, 41, 59, 100, -21, 126, 51, 26, -51, 60, 75, -83, 121, 121, 120, -29, 82, -112, 60, 2, 3, 37, 45, 35, -39, -113, 39, -18, -32, -40, -76, 61, 69, 92, -62, 98, 19, -35, 66, -14, -30, 74, -126, -53, -21, 125, -13, 15, -123, -122, -32, -88, 21, -50, -46, 21, 11, -115, 95, -44, -72, 9, -50, 93, 42, 73, -54, -31, -12, -84, 27, -53, 68, 114, 20, 67, 103, 108, 29, -113, 23, 4, -49, 111, 82, 59, -55, -86, -102, 106, -10, 49, -72, -120, -106, 78, -24, -114, -43, -8, 106, 121, -23, 116, 115, -17, -122, -31, 16, -6, -121, 105, -70, 33, 88, 73, 80, -108, -69, -110, -96, 111, 111, -5, -85, 120, 15, -65, -49, -114, 0, 7, 120, -47, -116, 117, -128, -2, -59, -69, -75, -5, 14, -64, 118, -16, -68, -18, 13, -70, -95, 70, 17, 46, -34, 59, 99, -75, -127, -77, -5, -57, 65, -87, -118, 96, -56, 123, 56, -27, -49, 49, 100, -117, 64, -56, -17, 46, 121, -71, -119, -86, 25, -49, -122, -80, -47, 121, 9, -63, -85, -7, -44, -1, 89, -110, -80, 53, 101, -80, -57, -49, 3, 30, 14, -99, -75, -71, -45, -77, 25, 94, 89, 8, -31, 21, -117, 71, -91, 73, 8, -91, 126, -45, 74, 126, 86, 123, -80, -5, -64, -97, 89, -75, 78, -22, -108, -82, -22, -6, 84, -45, -39, -86, 116, -61, 35, -16, 39, -53, -52, -39, 76, 16, -43, -43, 36, 11, 30, 58, 44, -58, 110, -90, -104, -28, 90, 79, -37, 55, -33, 108, 67, 39, -79, 88, 115, -117, 4, 70, -84, -35, -54, -9, 14, -88, -23, 94, -7, -80, -93, 15, 54, -51, 12, -59, -1, -105, -10, -65, 57, 83, 45, -39, 24, 43, -58, -13, 39, -17, -68, 20, 79, -124, 74, -47, -3, 40, -103, -101, 116, -125, -6, -22, -51, 66, -118, 38, 99, 69, -82, -9, -118, 86, 72, 87, 119, -37, -115, -116, -27, 2, 3, 1, 0, 1};
        byte[] serverPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -75, -102, -29, 1, -20, -99, 103, -94, 65, 88, -99, -41, 7, 76, 107, 121, 116, 20, -19, 96, 44, 106, -104, -91, 4, -20, 55, -76, 67, 110, 60, 48, 63, 26, 21, 19, -115, 38, 60, 32, 110, -4, 21, 96, 72, 73, -47, -118, -45, -61, -53, -50, 11, -29, -25, -83, -67, -62, 100, -81, -54, -56, 85, -99, -89, -84, 56, 17, -118, 26, -35, -35, -77, 110, -103, 29, -20, -39, 71, -52, -90, 23, 0, 60, 64, 75, -50, -70, 20, -71, -110, 33, 15, 96, -77, 66, 109, 53, 83, 48, 2, -45, -67, -119, 17, 72, -38, 32, -72, 2, 15, -76, -35, -41, 62, -3, -4, -100, -80, 83, -74, -58, -72, -31, -84, -106, -44, 104, -71, -6, 82, -1, -105, 5, 127, 42, 107, -56, 9, 121, -34, 63, 56, -77, -36, 83, 105, -91, -69, -54, -46, -80, -34, 48, 36, 10, 66, 50, 29, -42, -13, -91, -42, 64, -85, -46, 77, 0, 78, -35, 52, 68, 41, 59, 100, -21, 126, 51, 26, -51, 60, 75, -83, 121, 121, 120, -29, 82, -112, 60, 2, 3, 37, 45, 35, -39, -113, 39, -18, -32, -40, -76, 61, 69, 92, -62, 98, 19, -35, 66, -14, -30, 74, -126, -53, -21, 125, -13, 15, -123, -122, -32, -88, 21, -50, -46, 21, 11, -115, 95, -44, -72, 9, -50, 93, 42, 73, -54, -31, -12, -84, 27, -53, 68, 114, 20, 67, 103, 108, 29, -113, 23, 4, -49, 111, 82, 59, -55, -86, -102, 106, -10, 49, -72, -120, -106, 78, -24, -114, -43, -8, 106, 121, -23, 116, 115, -17, -122, -31, 16, -6, -121, 105, -70, 33, 88, 73, 80, -108, -69, -110, -96, 111, 111, -5, -85, 120, 15, -65, -49, -114, 0, 7, 120, -47, -116, 117, -128, -2, -59, -69, -75, -5, 14, -64, 118, -16, -68, -18, 13, -70, -95, 70, 17, 46, -34, 59, 99, -75, -127, -77, -5, -57, 65, -87, -118, 96, -56, 123, 56, -27, -49, 49, 100, -117, 64, -56, -17, 46, 121, -71, -119, -86, 25, -49, -122, -80, -47, 121, 9, -63, -85, -7, -44, -1, 89, -110, -80, 53, 101, -80, -57, -49, 3, 30, 14, -99, -75, -71, -45, -77, 25, 94, 89, 8, -31, 21, -117, 71, -91, 73, 8, -91, 126, -45, 74, 126, 86, 123, -80, -5, -64, -97, 89, -75, 78, -22, -108, -82, -22, -6, 84, -45, -39, -86, 116, -61, 35, -16, 39, -53, -52, -39, 76, 16, -43, -43, 36, 11, 30, 58, 44, -58, 110, -90, -104, -28, 90, 79, -37, 55, -33, 108, 67, 39, -79, 88, 115, -117, 4, 70, -84, -35, -54, -9, 14, -88, -23, 94, -7, -80, -93, 15, 54, -51, 12, -59, -1, -105, -10, -65, 57, 83, 45, -39, 24, 43, -58, -13, 39, -17, -68, 20, 79, -124, 74, -47, -3, 40, -103, -101, 116, -125, -6, -22, -51, 66, -118, 38, 99, 69, -82, -9, -118, 86, 72, 87, 119, -37, -115, -116, -27, 2, 3, 1, 0, 1};
        byte[] signature = {12, -95, 9, 4, -61, 61, -92, -66, -100, -87, 89, -95, 6, 3, -30, -102, -1, 106, 27, -1, -11, 36, -103, 41, -82, -75, 66, 83, 12, -29, 22, -36, 58, 83, -8, -68, -82, 118, -112, 46, 14, 68, -61, -88, 47, -54, -72, 46, -57, 38, -29, 9, -20, -104, 120, 54, -80, 113, 56, -41, 29, 74, -109, -95, 114, -71, 44, -95, -92, 77, 8, -1, -15, 23, -99, -69, -18, -25, 5, 78, 63, 14, 104, 116, 63, -51, -49, -41, -94, 121, -76, 120, 2, -58, -124, -113, -102, -14, -118, -71, 89, 80, -90, 98, 11, -46, -106, -108, -23, 4, 80, -72, -40, 68, -45, 26, -96, 9, -57, 126, 117, -55, 34, -47, 18, -29, -36, 79, -74, -4, 24, -3, 75, -85, 18, -93, -42, -126, 106, 123, -25, -66, 42, -106, 17, -69, 124, -58, -115, -32, -10, -70, 110, -72, 49, -33, 96, 108, 125, -31, 16, 94, -37, -16, -110, 36, 111, 106, -51, 76, 56, -62, -23, 0, 76, 84, -125, -50, -40, -93, -118, 35, -80, 32, -85, -58, 41, 70, -113, 22, -58, 103, 0, 88, -37, 67, -85, -72, -5, -41, -127, -64, -86, 89, 20, 26, -100, -98, -70, 51, 109, 61, 62, 81, -51, 77, -102, -115, 44, -13, -89, 108, 47, -3, 8, -114, 118, -76, -5, 81, 97, 111, 36, -51, -15, 55, 17, -118, 81, 48, 99, -2, 12, -59, -57, 79, -63, -28, -108, 45, -36, 59, -16, 55, -105, 4, 21, 21, -121, -12, -80, -65, -96, 115, -16, -88, -116, 1, 85, -70, -36, -98, -89, 44, 58, -20, -5, -94, -92, -110, -103, -94, 56, -98, 103, 118, -88, 62, 124, -68, 23, -70, -93, 39, 65, -26, -77, 43, -86, 44, -63, -45, -124, 105, -45, 30, -92, -93, -117, -90, 18, 75, -53, 32, 61, 84, -33, 83, 50, -25, -75, -116, 42, 41, -107, 96, -14, 78, 104, -119, 116, -48, -37, -9, 54, -68, 44, -77, -72, 106, 29, -4, 69, -23, 125, -95, 105, 6, 10, 39, 25, -96, -102, -107, 125, -22, 79, -16, 20, 91, 123, 81, -4, -108, -115, 121, 76, -35, 114, 27, -110, 22, -36, 72, 68, -41, 20, -74, 91, -2, 47, 58, -74, -83, -19, -58, 0, -49, -1, -20, 88, -116, 31, 10, -115, 67, -72, -2, 63, -101, 8, -56, -68, -52, 111, -42, 127, -94, -111, 118, -86, 126, 79, 59, -1, 4, -34, -105, 62, -54, -106, -1, -29, 107, 33, 84, 46, -127, 89, -54, -63, -72, -110, 35, -42, 12, -71, -39, 10, 60, -120, 99, -99, -27, 15, -22, -119, 89, -12, -6, 32, -100, -93, -107, 42, 104, -87, -128, 80, -88, -93, 96, 60, -53, -89, -49, -63, 87, -92, 35, 93, -68, 46, 2, 39, -86, -46, -125, -117, 104, 13, 93, 118, -45, -113, 116, 51, 39, -7, 86, -103, 108, 35, -9, 28, 70, -71, 22, -128, -41, 49, 110, -10, -64, -96, 3, 19, -88, -29, 84, -14, 124};
        assertDoesNotThrow(() -> Client.openAccountCheckResponse(serverPublicKey, signature, accountPublicKey));
    }

    @Test
    void open_account_key_signature_mismatch() {
        byte[] accountPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -75, -102, -29, 1, -20, -99, 103, -94, 65, 88, -99, -41, 7, 76, 107, 121, 116, 20, -19, 96, 44, 106, -104, -91, 4, -20, 55, -76, 67, 110, 60, 48, 63, 26, 21, 19, -115, 38, 60, 32, 110, -4, 21, 96, 72, 73, -47, -118, -45, -61, -53, -50, 11, -29, -25, -83, -67, -62, 100, -81, -54, -56, 85, -99, -89, -84, 56, 17, -118, 26, -35, -35, -77, 110, -103, 29, -20, -39, 71, -52, -90, 23, 0, 60, 64, 75, -50, -70, 20, -71, -110, 33, 15, 96, -77, 66, 109, 53, 83, 48, 2, -45, -67, -119, 17, 72, -38, 32, -72, 2, 15, -76, -35, -41, 62, -3, -4, -100, -80, 83, -74, -58, -72, -31, -84, -106, -44, 104, -71, -6, 82, -1, -105, 5, 127, 42, 107, -56, 9, 121, -34, 63, 56, -77, -36, 83, 105, -91, -69, -54, -46, -80, -34, 48, 36, 10, 66, 50, 29, -42, -13, -91, -42, 64, -85, -46, 77, 0, 78, -35, 52, 68, 41, 59, 100, -21, 126, 51, 26, -51, 60, 75, -83, 121, 121, 120, -29, 82, -112, 60, 2, 3, 37, 45, 35, -39, -113, 39, -18, -32, -40, -76, 61, 69, 92, -62, 98, 19, -35, 66, -14, -30, 74, -126, -53, -21, 125, -13, 15, -123, -122, -32, -88, 21, -50, -46, 21, 11, -115, 95, -44, -72, 9, -50, 93, 42, 73, -54, -31, -12, -84, 27, -53, 68, 114, 20, 67, 103, 108, 29, -113, 23, 4, -49, 111, 82, 59, -55, -86, -102, 106, -10, 49, -72, -120, -106, 78, -24, -114, -43, -8, 106, 121, -23, 116, 115, -17, -122, -31, 16, -6, -121, 105, -70, 33, 88, 73, 80, -108, -69, -110, -96, 111, 111, -5, -85, 120, 15, -65, -49, -114, 0, 7, 120, -47, -116, 117, -128, -2, -59, -69, -75, -5, 14, -64, 118, -16, -68, -18, 13, -70, -95, 70, 17, 46, -34, 59, 99, -75, -127, -77, -5, -57, 65, -87, -118, 96, -56, 123, 56, -27, -49, 49, 100, -117, 64, -56, -17, 46, 121, -71, -119, -86, 25, -49, -122, -80, -47, 121, 9, -63, -85, -7, -44, -1, 89, -110, -80, 53, 101, -80, -57, -49, 3, 30, 14, -99, -75, -71, -45, -77, 25, 94, 89, 8, -31, 21, -117, 71, -91, 73, 8, -91, 126, -45, 74, 126, 86, 123, -80, -5, -64, -97, 89, -75, 78, -22, -108, -82, -22, -6, 84, -45, -39, -86, 116, -61, 35, -16, 39, -53, -52, -39, 76, 16, -43, -43, 36, 11, 30, 58, 44, -58, 110, -90, -104, -28, 90, 79, -37, 55, -33, 108, 67, 39, -79, 88, 115, -117, 4, 70, -84, -35, -54, -9, 14, -88, -23, 94, -7, -80, -93, 15, 54, -51, 12, -59, -1, -105, -10, -65, 57, 83, 45, -39, 24, 43, -58, -13, 39, -17, -68, 20, 79, -124, 74, -47, -3, 40, -103, -101, 116, -125, -6, -22, -51, 66, -118, 38, 99, 69, -82, -9, -118, 86, 72, 87, 119, -37, -115, -116, -27, 2, 3, 1, 0, 1};
        byte[] serverPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -75, -102, -29, 1, -20, -99, 103, -94, 65, 88, -99, -41, 7, 76, 107, 121, 116, 20, -19, 96, 44, 106, -104, -91, 4, -20, 55, -76, 67, 110, 60, 48, 63, 26, 21, 19, -115, 38, 60, 32, 110, -4, 21, 96, 72, 73, -47, -118, -45, -61, -53, -50, 11, -29, -25, -83, -67, -62, 100, -81, -54, -56, 85, -99, -89, -84, 56, 17, -118, 26, -35, -35, -77, 110, -103, 29, -20, -39, 71, -52, -90, 23, 0, 60, 64, 75, -50, -70, 20, -71, -110, 33, 15, 96, -77, 66, 109, 53, 83, 48, 2, -45, -67, -119, 17, 72, -38, 32, -72, 2, 15, -76, -35, -41, 62, -3, -4, -100, -80, 83, -74, -58, -72, -31, -84, -106, -44, 104, -71, -6, 82, -1, -105, 5, 127, 42, 107, -56, 9, 121, -34, 63, 56, -77, -36, 83, 105, -91, -69, -54, -46, -80, -34, 48, 36, 10, 66, 50, 29, -42, -13, -91, -42, 64, -85, -46, 77, 0, 78, -35, 52, 68, 41, 59, 100, -21, 126, 51, 26, -51, 60, 75, -83, 121, 121, 120, -29, 82, -112, 60, 2, 3, 37, 45, 35, -39, -113, 39, -18, -32, -40, -76, 61, 69, 92, -62, 98, 19, -35, 66, -14, -30, 74, -126, -53, -21, 125, -13, 15, -123, -122, -32, -88, 21, -50, -46, 21, 11, -115, 95, -44, -72, 9, -50, 93, 42, 73, -54, -31, -12, -84, 27, -53, 68, 114, 20, 67, 103, 108, 29, -113, 23, 4, -49, 111, 82, 59, -55, -86, -102, 106, -10, 49, -72, -120, -106, 78, -24, -114, -43, -8, 106, 121, -23, 116, 115, -17, -122, -31, 16, -6, -121, 105, -70, 33, 88, 73, 80, -108, -69, -110, -96, 111, 111, -5, -85, 120, 15, -65, -49, -114, 0, 7, 120, -47, -116, 117, -128, -2, -59, -69, -75, -5, 14, -64, 118, -16, -68, -18, 13, -70, -95, 70, 17, 46, -34, 59, 99, -75, -127, -77, -5, -57, 65, -87, -118, 96, -56, 123, 56, -27, -49, 49, 100, -117, 64, -56, -17, 46, 121, -71, -119, -86, 25, -49, -122, -80, -47, 121, 9, -63, -85, -7, -44, -1, 89, -110, -80, 53, 101, -80, -57, -49, 3, 30, 14, -99, -75, -71, -45, -77, 25, 94, 89, 8, -31, 21, -117, 71, -91, 73, 8, -91, 126, -45, 74, 126, 86, 123, -80, -5, -64, -97, 89, -75, 78, -22, -108, -82, -22, -6, 84, -45, -39, -86, 116, -61, 35, -16, 39, -53, -52, -39, 76, 16, -43, -43, 36, 11, 30, 58, 44, -58, 110, -90, -104, -28, 90, 79, -37, 55, -33, 108, 67, 39, -79, 88, 115, -117, 4, 70, -84, -35, -54, -9, 14, -88, -23, 94, -7, -80, -93, 15, 54, -51, 12, -59, -1, -105, -10, -65, 57, 83, 45, -39, 24, 43, -58, -13, 39, -17, -68, 20, 79, -124, 74, -47, -3, 40, -103, -101, 116, -125, -6, -22, -51, 66, -118, 38, 99, 69, -82, -9, -118, 86, 72, 87, 119, -37, -115, -116, -27, 2, 3, 1, 0, 1};
        byte[] signature = {13, -95, 9, 4, -61, 61, -92, -66, -100, -87, 89, -95, 6, 3, -30, -102, -1, 106, 27, -1, -11, 36, -103, 41, -82, -75, 66, 83, 12, -29, 22, -36, 58, 83, -8, -68, -82, 118, -112, 46, 14, 68, -61, -88, 47, -54, -72, 46, -57, 38, -29, 9, -20, -104, 120, 54, -80, 113, 56, -41, 29, 74, -109, -95, 114, -71, 44, -95, -92, 77, 8, -1, -15, 23, -99, -69, -18, -25, 5, 78, 63, 14, 104, 116, 63, -51, -49, -41, -94, 121, -76, 120, 2, -58, -124, -113, -102, -14, -118, -71, 89, 80, -90, 98, 11, -46, -106, -108, -23, 4, 80, -72, -40, 68, -45, 26, -96, 9, -57, 126, 117, -55, 34, -47, 18, -29, -36, 79, -74, -4, 24, -3, 75, -85, 18, -93, -42, -126, 106, 123, -25, -66, 42, -106, 17, -69, 124, -58, -115, -32, -10, -70, 110, -72, 49, -33, 96, 108, 125, -31, 16, 94, -37, -16, -110, 36, 111, 106, -51, 76, 56, -62, -23, 0, 76, 84, -125, -50, -40, -93, -118, 35, -80, 32, -85, -58, 41, 70, -113, 22, -58, 103, 0, 88, -37, 67, -85, -72, -5, -41, -127, -64, -86, 89, 20, 26, -100, -98, -70, 51, 109, 61, 62, 81, -51, 77, -102, -115, 44, -13, -89, 108, 47, -3, 8, -114, 118, -76, -5, 81, 97, 111, 36, -51, -15, 55, 17, -118, 81, 48, 99, -2, 12, -59, -57, 79, -63, -28, -108, 45, -36, 59, -16, 55, -105, 4, 21, 21, -121, -12, -80, -65, -96, 115, -16, -88, -116, 1, 85, -70, -36, -98, -89, 44, 58, -20, -5, -94, -92, -110, -103, -94, 56, -98, 103, 118, -88, 62, 124, -68, 23, -70, -93, 39, 65, -26, -77, 43, -86, 44, -63, -45, -124, 105, -45, 30, -92, -93, -117, -90, 18, 75, -53, 32, 61, 84, -33, 83, 50, -25, -75, -116, 42, 41, -107, 96, -14, 78, 104, -119, 116, -48, -37, -9, 54, -68, 44, -77, -72, 106, 29, -4, 69, -23, 125, -95, 105, 6, 10, 39, 25, -96, -102, -107, 125, -22, 79, -16, 20, 91, 123, 81, -4, -108, -115, 121, 76, -35, 114, 27, -110, 22, -36, 72, 68, -41, 20, -74, 91, -2, 47, 58, -74, -83, -19, -58, 0, -49, -1, -20, 88, -116, 31, 10, -115, 67, -72, -2, 63, -101, 8, -56, -68, -52, 111, -42, 127, -94, -111, 118, -86, 126, 79, 59, -1, 4, -34, -105, 62, -54, -106, -1, -29, 107, 33, 84, 46, -127, 89, -54, -63, -72, -110, 35, -42, 12, -71, -39, 10, 60, -120, 99, -99, -27, 15, -22, -119, 89, -12, -6, 32, -100, -93, -107, 42, 104, -87, -128, 80, -88, -93, 96, 60, -53, -89, -49, -63, 87, -92, 35, 93, -68, 46, 2, 39, -86, -46, -125, -117, 104, 13, 93, 118, -45, -113, 116, 51, 39, -7, 86, -103, 108, 35, -9, 28, 70, -71, 22, -128, -41, 49, 110, -10, -64, -96, 3, 19, -88, -29, 84, -14, 124};

        assertThrows(SignatureExceptions.class, () -> Client.openAccountCheckResponse(serverPublicKey, signature, accountPublicKey));
    }

    @Test
    void send_amount_normal() {
        byte[] serverPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -75, -102, -29, 1, -20, -99, 103, -94, 65, 88, -99, -41, 7, 76, 107, 121, 116, 20, -19, 96, 44, 106, -104, -91, 4, -20, 55, -76, 67, 110, 60, 48, 63, 26, 21, 19, -115, 38, 60, 32, 110, -4, 21, 96, 72, 73, -47, -118, -45, -61, -53, -50, 11, -29, -25, -83, -67, -62, 100, -81, -54, -56, 85, -99, -89, -84, 56, 17, -118, 26, -35, -35, -77, 110, -103, 29, -20, -39, 71, -52, -90, 23, 0, 60, 64, 75, -50, -70, 20, -71, -110, 33, 15, 96, -77, 66, 109, 53, 83, 48, 2, -45, -67, -119, 17, 72, -38, 32, -72, 2, 15, -76, -35, -41, 62, -3, -4, -100, -80, 83, -74, -58, -72, -31, -84, -106, -44, 104, -71, -6, 82, -1, -105, 5, 127, 42, 107, -56, 9, 121, -34, 63, 56, -77, -36, 83, 105, -91, -69, -54, -46, -80, -34, 48, 36, 10, 66, 50, 29, -42, -13, -91, -42, 64, -85, -46, 77, 0, 78, -35, 52, 68, 41, 59, 100, -21, 126, 51, 26, -51, 60, 75, -83, 121, 121, 120, -29, 82, -112, 60, 2, 3, 37, 45, 35, -39, -113, 39, -18, -32, -40, -76, 61, 69, 92, -62, 98, 19, -35, 66, -14, -30, 74, -126, -53, -21, 125, -13, 15, -123, -122, -32, -88, 21, -50, -46, 21, 11, -115, 95, -44, -72, 9, -50, 93, 42, 73, -54, -31, -12, -84, 27, -53, 68, 114, 20, 67, 103, 108, 29, -113, 23, 4, -49, 111, 82, 59, -55, -86, -102, 106, -10, 49, -72, -120, -106, 78, -24, -114, -43, -8, 106, 121, -23, 116, 115, -17, -122, -31, 16, -6, -121, 105, -70, 33, 88, 73, 80, -108, -69, -110, -96, 111, 111, -5, -85, 120, 15, -65, -49, -114, 0, 7, 120, -47, -116, 117, -128, -2, -59, -69, -75, -5, 14, -64, 118, -16, -68, -18, 13, -70, -95, 70, 17, 46, -34, 59, 99, -75, -127, -77, -5, -57, 65, -87, -118, 96, -56, 123, 56, -27, -49, 49, 100, -117, 64, -56, -17, 46, 121, -71, -119, -86, 25, -49, -122, -80, -47, 121, 9, -63, -85, -7, -44, -1, 89, -110, -80, 53, 101, -80, -57, -49, 3, 30, 14, -99, -75, -71, -45, -77, 25, 94, 89, 8, -31, 21, -117, 71, -91, 73, 8, -91, 126, -45, 74, 126, 86, 123, -80, -5, -64, -97, 89, -75, 78, -22, -108, -82, -22, -6, 84, -45, -39, -86, 116, -61, 35, -16, 39, -53, -52, -39, 76, 16, -43, -43, 36, 11, 30, 58, 44, -58, 110, -90, -104, -28, 90, 79, -37, 55, -33, 108, 67, 39, -79, 88, 115, -117, 4, 70, -84, -35, -54, -9, 14, -88, -23, 94, -7, -80, -93, 15, 54, -51, 12, -59, -1, -105, -10, -65, 57, 83, 45, -39, 24, 43, -58, -13, 39, -17, -68, 20, 79, -124, 74, -47, -3, 40, -103, -101, 116, -125, -6, -22, -51, 66, -118, 38, 99, 69, -82, -9, -118, 86, 72, 87, 119, -37, -115, -116, -27, 2, 3, 1, 0, 1};
        byte[] signature = {20, 80, -33, 11, 117, -110, 1, 63, 60, -82, -97, -18, -84, 105, 59, 78, 39, 73, -119, 14, -58, -26, 25, 85, 39, -9, 122, 112, 76, 25, -23, -6, -15, 26, -67, -25, 43, 23, -99, 97, 19, 117, -84, 85, -9, -92, 9, -89, 96, -73, 52, 85, 18, -18, 55, -32, 99, 25, 52, 9, 24, 88, -126, 86, -20, 54, -124, 121, 10, 54, -34, -34, 100, -47, 68, -18, -77, 81, 60, -66, 51, -121, -127, -64, 40, -61, -89, 74, -51, -117, -123, -34, -37, 113, -48, -80, 100, 121, 22, 30, -100, 17, -8, 13, -128, -61, -62, 104, 117, 120, -81, 5, 113, -93, 2, -38, 121, 14, -64, 3, 24, -10, 23, 102, 86, -53, -35, 70, 126, -19, 103, -5, 71, -8, -98, 32, 126, 6, 125, -61, -32, 63, 19, -45, -100, 15, -126, 115, 52, -99, -122, -51, -86, 89, -128, -65, 9, -82, -13, -50, 88, 42, 57, -128, 61, 83, -54, 46, -95, 69, -105, 64, -39, -71, 121, 91, 5, 81, 0, -83, -51, 124, 125, 124, -86, -120, -17, 60, 43, -42, -63, -35, -32, -110, -52, -97, 111, 121, 5, 99, 34, -82, 33, -96, 91, -122, -51, 57, 111, 18, 56, -79, -20, -36, -70, 102, -62, -108, -114, 52, -45, 44, 37, 36, 62, 110, -55, -92, -56, 52, 112, -1, 62, -69, -119, 97, -15, -112, -27, 52, 120, -88, 26, -70, 61, -61, -67, -92, 49, -2, -91, -45, -99, -88, 112, -25, -3, -61, 114, 40, 40, -7, 121, 23, 12, 83, 84, -103, -111, -60, -10, 68, -14, 95, 88, -112, 56, -70, 81, -123, 117, -108, -40, 103, 46, 112, -71, -78, 17, -35, -76, 68, 85, 59, 66, 59, 124, 10, 45, 120, 12, 119, 31, 39, 72, -13, 11, 61, -119, 12, -82, -70, 89, 74, 36, -16, 110, -74, -46, 40, -46, -117, -97, 23, -120, 67, -60, 21, 56, -128, -17, 16, -106, 20, 109, 127, 6, 97, 13, -116, 115, 127, 75, -64, 66, 51, -109, 44, 40, 15, 115, 127, 48, -116, 46, 120, -14, -108, -122, -125, -36, -86, -98, 21, -70, -117, -54, -72, -108, -122, -23, 2, -96, 26, -4, 46, -112, -17, 22, 98, 121, 69, -120, -20, -52, -100, -45, 51, -50, -111, -45, 94, -113, 26, -103, 74, -36, -107, -22, -62, -21, -122, -14, -69, -5, -91, 41, -4, 32, 26, 3, -37, -20, -84, 120, 20, 45, 22, -90, -119, 73, -117, -36, 108, -25, 69, 44, 88, -96, -12, 81, -62, 25, -35, -49, 31, 56, 84, 46, 64, -16, -79, 99, -6, 100, 38, 78, 41, 53, -24, 18, -100, 122, 35, 75, 126, -1, 122, 65, -59, 67, -9, 68, 9, 36, -102, -10, 76, 66, -86, -42, 46, 103, 78, -94, -39, -30, 118, -26, 93, -93, 106, -82, -94, -118, -96, 123, 96, 36, 72, 56, 0, 127, -95, 11, -46, 59, -124, -33, -67, -101, 6, -85, -36, 6, -100, 94, 71, -49, -21, 39, 60};
        byte[] sourcePublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -58, -30, 99, -1, 30, 32, 80, 91, -121, -126, -30, 17, -55, 44, -33, -12, -42, 54, 56, -114, 38, 61, 8, 12, 104, -97, 127, 3, -74, 15, 119, -11, -45, 120, -71, -12, 111, 28, 81, 120, -50, -30, 11, -36, -90, -111, -104, 34, -115, -103, 68, 55, 80, 79, -87, 87, -47, -84, -78, -76, -63, -90, 42, -104, 12, -16, 53, -54, -2, -32, 102, 93, -40, -7, -64, 118, 25, -18, 127, -73, 17, 2, 66, 11, -78, -127, 18, 37, -111, -15, -53, 35, 84, 97, -113, 26, 57, 86, -128, -59, 67, -123, -120, -121, 57, -98, -95, 44, 117, 14, 116, 42, 38, -76, -22, -14, -37, -36, -56, 53, -121, -116, -17, -102, -99, -23, 34, -52, 73, -86, -56, -38, -80, -23, 124, 125, 36, 94, -32, -76, 69, -43, 37, 109, 118, 80, -84, 49, 111, 67, -125, 43, -113, 101, 87, -110, -16, -96, 18, 110, 124, -37, -110, -100, 107, -109, -73, -39, -109, -25, 93, 83, -73, -88, 34, 29, -89, 93, -22, -77, 25, 53, 74, 11, 116, -41, -85, 92, -106, 96, 38, -110, 12, 30, 63, 23, 78, -94, 109, 40, 82, 65, -16, 40, 48, -12, 57, -99, -53, -67, -73, 122, 49, -27, -19, 99, 95, -69, -124, -88, 40, -40, -74, -55, 15, -81, -55, 60, -50, -25, 96, -54, 119, 96, 66, -82, -94, 28, -78, -31, -23, 38, 12, 38, 24, 96, 24, 115, 10, 13, 61, 33, 7, -87, -111, -90, 48, 53, -90, 78, -17, -31, 68, 124, -65, -101, 8, 64, -125, -43, 7, 69, 89, 13, 77, 57, 46, 83, -19, -82, 95, -85, -49, 86, -102, -71, 55, -57, 10, -120, -103, -56, 34, 101, 59, -62, -90, 95, -56, 54, -49, 0, -127, -43, -27, 32, 2, 55, -117, -97, 2, -33, 62, -77, -16, -64, 40, -55, -112, 36, 46, 98, -64, -44, -78, -85, -63, 74, -119, -4, -80, -14, 11, -78, -123, -114, 38, 76, -115, 43, -99, -110, -16, -26, -47, -34, 35, 93, -69, -78, -53, 23, 127, 100, 90, -37, 13, 105, 88, 48, -103, 127, -112, -62, -23, 120, 37, 29, -9, -92, -65, 30, -31, -59, 34, 24, -52, -53, 75, 89, 38, 92, -98, 100, 34, 4, 23, 55, -105, 121, 60, -119, -61, -119, -68, -121, -106, -8, 59, 73, 65, 80, -87, 86, 69, 114, 56, -102, 55, 32, -121, 15, 6, 41, -49, -109, -6, -93, -44, 127, -26, -33, -116, -16, -45, 20, 48, 43, 36, -88, -59, -55, -68, 73, 77, -95, -90, -25, -52, 29, 54, -77, 58, 65, -36, 106, 127, 26, 93, -128, -5, -115, 113, 72, 79, -68, -43, -49, 33, -19, -42, 51, -44, 72, 37, -26, -43, 54, 20, 66, -125, -101, 98, 16, 9, -10, 116, 78, 88, 39, 98, -3, 83, 99, -97, 90, 2, -35, -40, 103, 41, -70, -59, -4, -112, -19, 91, 124, -79, 35, 4, -123, 0, -91, 38, 13, -106, -69, -76, 55, 69, 47, 2, 3, 1, 0, 1};
        byte[] destinationPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -58, -30, 99, -1, 30, 32, 80, 91, -121, -126, -30, 17, -55, 44, -33, -12, -42, 54, 56, -114, 38, 61, 8, 12, 104, -97, 127, 3, -74, 15, 119, -11, -45, 120, -71, -12, 111, 28, 81, 120, -50, -30, 11, -36, -90, -111, -104, 34, -115, -103, 68, 55, 80, 79, -87, 87, -47, -84, -78, -76, -63, -90, 42, -104, 12, -16, 53, -54, -2, -32, 102, 93, -40, -7, -64, 118, 25, -18, 127, -73, 17, 2, 66, 11, -78, -127, 18, 37, -111, -15, -53, 35, 84, 97, -113, 26, 57, 86, -128, -59, 67, -123, -120, -121, 57, -98, -95, 44, 117, 14, 116, 42, 38, -76, -22, -14, -37, -36, -56, 53, -121, -116, -17, -102, -99, -23, 34, -52, 73, -86, -56, -38, -80, -23, 124, 125, 36, 94, -32, -76, 69, -43, 37, 109, 118, 80, -84, 49, 111, 67, -125, 43, -113, 101, 87, -110, -16, -96, 18, 110, 124, -37, -110, -100, 107, -109, -73, -39, -109, -25, 93, 83, -73, -88, 34, 29, -89, 93, -22, -77, 25, 53, 74, 11, 116, -41, -85, 92, -106, 96, 38, -110, 12, 30, 63, 23, 78, -94, 109, 40, 82, 65, -16, 40, 48, -12, 57, -99, -53, -67, -73, 122, 49, -27, -19, 99, 95, -69, -124, -88, 40, -40, -74, -55, 15, -81, -55, 60, -50, -25, 96, -54, 119, 96, 66, -82, -94, 28, -78, -31, -23, 38, 12, 38, 24, 96, 24, 115, 10, 13, 61, 33, 7, -87, -111, -90, 48, 53, -90, 78, -17, -31, 68, 124, -65, -101, 8, 64, -125, -43, 7, 69, 89, 13, 77, 57, 46, 83, -19, -82, 95, -85, -49, 86, -102, -71, 55, -57, 10, -120, -103, -56, 34, 101, 59, -62, -90, 95, -56, 54, -49, 0, -127, -43, -27, 32, 2, 55, -117, -97, 2, -33, 62, -77, -16, -64, 40, -55, -112, 36, 46, 98, -64, -44, -78, -85, -63, 74, -119, -4, -80, -14, 11, -78, -123, -114, 38, 76, -115, 43, -99, -110, -16, -26, -47, -34, 35, 93, -69, -78, -53, 23, 127, 100, 90, -37, 13, 105, 88, 48, -103, 127, -112, -62, -23, 120, 37, 29, -9, -92, -65, 30, -31, -59, 34, 24, -52, -53, 75, 89, 38, 92, -98, 100, 34, 4, 23, 55, -105, 121, 60, -119, -61, -119, -68, -121, -106, -8, 59, 73, 65, 80, -87, 86, 69, 114, 56, -102, 55, 32, -121, 15, 6, 41, -49, -109, -6, -93, -44, 127, -26, -33, -116, -16, -45, 20, 48, 43, 36, -88, -59, -55, -68, 73, 77, -95, -90, -25, -52, 29, 54, -77, 58, 65, -36, 106, 127, 26, 93, -128, -5, -115, 113, 72, 79, -68, -43, -49, 33, -19, -42, 51, -44, 72, 37, -26, -43, 54, 20, 66, -125, -101, 98, 16, 9, -10, 116, 78, 88, 39, 98, -3, 83, 99, -97, 90, 2, -35, -40, 103, 41, -70, -59, -4, -112, -19, 91, 124, -79, 35, 4, -123, 0, -91, 38, 13, -106, -69, -76, 55, 69, 47, 2, 3, 1, 0, 1};
        int amount = 10;
        int incrementedNonce = -2079421024;

        assertDoesNotThrow(() -> Client.sendAmountCheckResponse(serverPublicKey, signature, sourcePublicKey, destinationPublicKey, amount, incrementedNonce));
    }

    @Test
    void send_amount_signature_mismatch() {
        byte[] serverPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -75, -102, -29, 1, -20, -99, 103, -94, 65, 88, -99, -41, 7, 76, 107, 121, 116, 20, -19, 96, 44, 106, -104, -91, 4, -20, 55, -76, 67, 110, 60, 48, 63, 26, 21, 19, -115, 38, 60, 32, 110, -4, 21, 96, 72, 73, -47, -118, -45, -61, -53, -50, 11, -29, -25, -83, -67, -62, 100, -81, -54, -56, 85, -99, -89, -84, 56, 17, -118, 26, -35, -35, -77, 110, -103, 29, -20, -39, 71, -52, -90, 23, 0, 60, 64, 75, -50, -70, 20, -71, -110, 33, 15, 96, -77, 66, 109, 53, 83, 48, 2, -45, -67, -119, 17, 72, -38, 32, -72, 2, 15, -76, -35, -41, 62, -3, -4, -100, -80, 83, -74, -58, -72, -31, -84, -106, -44, 104, -71, -6, 82, -1, -105, 5, 127, 42, 107, -56, 9, 121, -34, 63, 56, -77, -36, 83, 105, -91, -69, -54, -46, -80, -34, 48, 36, 10, 66, 50, 29, -42, -13, -91, -42, 64, -85, -46, 77, 0, 78, -35, 52, 68, 41, 59, 100, -21, 126, 51, 26, -51, 60, 75, -83, 121, 121, 120, -29, 82, -112, 60, 2, 3, 37, 45, 35, -39, -113, 39, -18, -32, -40, -76, 61, 69, 92, -62, 98, 19, -35, 66, -14, -30, 74, -126, -53, -21, 125, -13, 15, -123, -122, -32, -88, 21, -50, -46, 21, 11, -115, 95, -44, -72, 9, -50, 93, 42, 73, -54, -31, -12, -84, 27, -53, 68, 114, 20, 67, 103, 108, 29, -113, 23, 4, -49, 111, 82, 59, -55, -86, -102, 106, -10, 49, -72, -120, -106, 78, -24, -114, -43, -8, 106, 121, -23, 116, 115, -17, -122, -31, 16, -6, -121, 105, -70, 33, 88, 73, 80, -108, -69, -110, -96, 111, 111, -5, -85, 120, 15, -65, -49, -114, 0, 7, 120, -47, -116, 117, -128, -2, -59, -69, -75, -5, 14, -64, 118, -16, -68, -18, 13, -70, -95, 70, 17, 46, -34, 59, 99, -75, -127, -77, -5, -57, 65, -87, -118, 96, -56, 123, 56, -27, -49, 49, 100, -117, 64, -56, -17, 46, 121, -71, -119, -86, 25, -49, -122, -80, -47, 121, 9, -63, -85, -7, -44, -1, 89, -110, -80, 53, 101, -80, -57, -49, 3, 30, 14, -99, -75, -71, -45, -77, 25, 94, 89, 8, -31, 21, -117, 71, -91, 73, 8, -91, 126, -45, 74, 126, 86, 123, -80, -5, -64, -97, 89, -75, 78, -22, -108, -82, -22, -6, 84, -45, -39, -86, 116, -61, 35, -16, 39, -53, -52, -39, 76, 16, -43, -43, 36, 11, 30, 58, 44, -58, 110, -90, -104, -28, 90, 79, -37, 55, -33, 108, 67, 39, -79, 88, 115, -117, 4, 70, -84, -35, -54, -9, 14, -88, -23, 94, -7, -80, -93, 15, 54, -51, 12, -59, -1, -105, -10, -65, 57, 83, 45, -39, 24, 43, -58, -13, 39, -17, -68, 20, 79, -124, 74, -47, -3, 40, -103, -101, 116, -125, -6, -22, -51, 66, -118, 38, 99, 69, -82, -9, -118, 86, 72, 87, 119, -37, -115, -116, -27, 2, 3, 1, 0, 1};
        byte[] signature = {21, 80, -33, 11, 117, -110, 1, 63, 60, -82, -97, -18, -84, 105, 59, 78, 39, 73, -119, 14, -58, -26, 25, 85, 39, -9, 122, 112, 76, 25, -23, -6, -15, 26, -67, -25, 43, 23, -99, 97, 19, 117, -84, 85, -9, -92, 9, -89, 96, -73, 52, 85, 18, -18, 55, -32, 99, 25, 52, 9, 24, 88, -126, 86, -20, 54, -124, 121, 10, 54, -34, -34, 100, -47, 68, -18, -77, 81, 60, -66, 51, -121, -127, -64, 40, -61, -89, 74, -51, -117, -123, -34, -37, 113, -48, -80, 100, 121, 22, 30, -100, 17, -8, 13, -128, -61, -62, 104, 117, 120, -81, 5, 113, -93, 2, -38, 121, 14, -64, 3, 24, -10, 23, 102, 86, -53, -35, 70, 126, -19, 103, -5, 71, -8, -98, 32, 126, 6, 125, -61, -32, 63, 19, -45, -100, 15, -126, 115, 52, -99, -122, -51, -86, 89, -128, -65, 9, -82, -13, -50, 88, 42, 57, -128, 61, 83, -54, 46, -95, 69, -105, 64, -39, -71, 121, 91, 5, 81, 0, -83, -51, 124, 125, 124, -86, -120, -17, 60, 43, -42, -63, -35, -32, -110, -52, -97, 111, 121, 5, 99, 34, -82, 33, -96, 91, -122, -51, 57, 111, 18, 56, -79, -20, -36, -70, 102, -62, -108, -114, 52, -45, 44, 37, 36, 62, 110, -55, -92, -56, 52, 112, -1, 62, -69, -119, 97, -15, -112, -27, 52, 120, -88, 26, -70, 61, -61, -67, -92, 49, -2, -91, -45, -99, -88, 112, -25, -3, -61, 114, 40, 40, -7, 121, 23, 12, 83, 84, -103, -111, -60, -10, 68, -14, 95, 88, -112, 56, -70, 81, -123, 117, -108, -40, 103, 46, 112, -71, -78, 17, -35, -76, 68, 85, 59, 66, 59, 124, 10, 45, 120, 12, 119, 31, 39, 72, -13, 11, 61, -119, 12, -82, -70, 89, 74, 36, -16, 110, -74, -46, 40, -46, -117, -97, 23, -120, 67, -60, 21, 56, -128, -17, 16, -106, 20, 109, 127, 6, 97, 13, -116, 115, 127, 75, -64, 66, 51, -109, 44, 40, 15, 115, 127, 48, -116, 46, 120, -14, -108, -122, -125, -36, -86, -98, 21, -70, -117, -54, -72, -108, -122, -23, 2, -96, 26, -4, 46, -112, -17, 22, 98, 121, 69, -120, -20, -52, -100, -45, 51, -50, -111, -45, 94, -113, 26, -103, 74, -36, -107, -22, -62, -21, -122, -14, -69, -5, -91, 41, -4, 32, 26, 3, -37, -20, -84, 120, 20, 45, 22, -90, -119, 73, -117, -36, 108, -25, 69, 44, 88, -96, -12, 81, -62, 25, -35, -49, 31, 56, 84, 46, 64, -16, -79, 99, -6, 100, 38, 78, 41, 53, -24, 18, -100, 122, 35, 75, 126, -1, 122, 65, -59, 67, -9, 68, 9, 36, -102, -10, 76, 66, -86, -42, 46, 103, 78, -94, -39, -30, 118, -26, 93, -93, 106, -82, -94, -118, -96, 123, 96, 36, 72, 56, 0, 127, -95, 11, -46, 59, -124, -33, -67, -101, 6, -85, -36, 6, -100, 94, 71, -49, -21, 39, 60};
        byte[] sourcePublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -58, -30, 99, -1, 30, 32, 80, 91, -121, -126, -30, 17, -55, 44, -33, -12, -42, 54, 56, -114, 38, 61, 8, 12, 104, -97, 127, 3, -74, 15, 119, -11, -45, 120, -71, -12, 111, 28, 81, 120, -50, -30, 11, -36, -90, -111, -104, 34, -115, -103, 68, 55, 80, 79, -87, 87, -47, -84, -78, -76, -63, -90, 42, -104, 12, -16, 53, -54, -2, -32, 102, 93, -40, -7, -64, 118, 25, -18, 127, -73, 17, 2, 66, 11, -78, -127, 18, 37, -111, -15, -53, 35, 84, 97, -113, 26, 57, 86, -128, -59, 67, -123, -120, -121, 57, -98, -95, 44, 117, 14, 116, 42, 38, -76, -22, -14, -37, -36, -56, 53, -121, -116, -17, -102, -99, -23, 34, -52, 73, -86, -56, -38, -80, -23, 124, 125, 36, 94, -32, -76, 69, -43, 37, 109, 118, 80, -84, 49, 111, 67, -125, 43, -113, 101, 87, -110, -16, -96, 18, 110, 124, -37, -110, -100, 107, -109, -73, -39, -109, -25, 93, 83, -73, -88, 34, 29, -89, 93, -22, -77, 25, 53, 74, 11, 116, -41, -85, 92, -106, 96, 38, -110, 12, 30, 63, 23, 78, -94, 109, 40, 82, 65, -16, 40, 48, -12, 57, -99, -53, -67, -73, 122, 49, -27, -19, 99, 95, -69, -124, -88, 40, -40, -74, -55, 15, -81, -55, 60, -50, -25, 96, -54, 119, 96, 66, -82, -94, 28, -78, -31, -23, 38, 12, 38, 24, 96, 24, 115, 10, 13, 61, 33, 7, -87, -111, -90, 48, 53, -90, 78, -17, -31, 68, 124, -65, -101, 8, 64, -125, -43, 7, 69, 89, 13, 77, 57, 46, 83, -19, -82, 95, -85, -49, 86, -102, -71, 55, -57, 10, -120, -103, -56, 34, 101, 59, -62, -90, 95, -56, 54, -49, 0, -127, -43, -27, 32, 2, 55, -117, -97, 2, -33, 62, -77, -16, -64, 40, -55, -112, 36, 46, 98, -64, -44, -78, -85, -63, 74, -119, -4, -80, -14, 11, -78, -123, -114, 38, 76, -115, 43, -99, -110, -16, -26, -47, -34, 35, 93, -69, -78, -53, 23, 127, 100, 90, -37, 13, 105, 88, 48, -103, 127, -112, -62, -23, 120, 37, 29, -9, -92, -65, 30, -31, -59, 34, 24, -52, -53, 75, 89, 38, 92, -98, 100, 34, 4, 23, 55, -105, 121, 60, -119, -61, -119, -68, -121, -106, -8, 59, 73, 65, 80, -87, 86, 69, 114, 56, -102, 55, 32, -121, 15, 6, 41, -49, -109, -6, -93, -44, 127, -26, -33, -116, -16, -45, 20, 48, 43, 36, -88, -59, -55, -68, 73, 77, -95, -90, -25, -52, 29, 54, -77, 58, 65, -36, 106, 127, 26, 93, -128, -5, -115, 113, 72, 79, -68, -43, -49, 33, -19, -42, 51, -44, 72, 37, -26, -43, 54, 20, 66, -125, -101, 98, 16, 9, -10, 116, 78, 88, 39, 98, -3, 83, 99, -97, 90, 2, -35, -40, 103, 41, -70, -59, -4, -112, -19, 91, 124, -79, 35, 4, -123, 0, -91, 38, 13, -106, -69, -76, 55, 69, 47, 2, 3, 1, 0, 1};
        byte[] destinationPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -58, -30, 99, -1, 30, 32, 80, 91, -121, -126, -30, 17, -55, 44, -33, -12, -42, 54, 56, -114, 38, 61, 8, 12, 104, -97, 127, 3, -74, 15, 119, -11, -45, 120, -71, -12, 111, 28, 81, 120, -50, -30, 11, -36, -90, -111, -104, 34, -115, -103, 68, 55, 80, 79, -87, 87, -47, -84, -78, -76, -63, -90, 42, -104, 12, -16, 53, -54, -2, -32, 102, 93, -40, -7, -64, 118, 25, -18, 127, -73, 17, 2, 66, 11, -78, -127, 18, 37, -111, -15, -53, 35, 84, 97, -113, 26, 57, 86, -128, -59, 67, -123, -120, -121, 57, -98, -95, 44, 117, 14, 116, 42, 38, -76, -22, -14, -37, -36, -56, 53, -121, -116, -17, -102, -99, -23, 34, -52, 73, -86, -56, -38, -80, -23, 124, 125, 36, 94, -32, -76, 69, -43, 37, 109, 118, 80, -84, 49, 111, 67, -125, 43, -113, 101, 87, -110, -16, -96, 18, 110, 124, -37, -110, -100, 107, -109, -73, -39, -109, -25, 93, 83, -73, -88, 34, 29, -89, 93, -22, -77, 25, 53, 74, 11, 116, -41, -85, 92, -106, 96, 38, -110, 12, 30, 63, 23, 78, -94, 109, 40, 82, 65, -16, 40, 48, -12, 57, -99, -53, -67, -73, 122, 49, -27, -19, 99, 95, -69, -124, -88, 40, -40, -74, -55, 15, -81, -55, 60, -50, -25, 96, -54, 119, 96, 66, -82, -94, 28, -78, -31, -23, 38, 12, 38, 24, 96, 24, 115, 10, 13, 61, 33, 7, -87, -111, -90, 48, 53, -90, 78, -17, -31, 68, 124, -65, -101, 8, 64, -125, -43, 7, 69, 89, 13, 77, 57, 46, 83, -19, -82, 95, -85, -49, 86, -102, -71, 55, -57, 10, -120, -103, -56, 34, 101, 59, -62, -90, 95, -56, 54, -49, 0, -127, -43, -27, 32, 2, 55, -117, -97, 2, -33, 62, -77, -16, -64, 40, -55, -112, 36, 46, 98, -64, -44, -78, -85, -63, 74, -119, -4, -80, -14, 11, -78, -123, -114, 38, 76, -115, 43, -99, -110, -16, -26, -47, -34, 35, 93, -69, -78, -53, 23, 127, 100, 90, -37, 13, 105, 88, 48, -103, 127, -112, -62, -23, 120, 37, 29, -9, -92, -65, 30, -31, -59, 34, 24, -52, -53, 75, 89, 38, 92, -98, 100, 34, 4, 23, 55, -105, 121, 60, -119, -61, -119, -68, -121, -106, -8, 59, 73, 65, 80, -87, 86, 69, 114, 56, -102, 55, 32, -121, 15, 6, 41, -49, -109, -6, -93, -44, 127, -26, -33, -116, -16, -45, 20, 48, 43, 36, -88, -59, -55, -68, 73, 77, -95, -90, -25, -52, 29, 54, -77, 58, 65, -36, 106, 127, 26, 93, -128, -5, -115, 113, 72, 79, -68, -43, -49, 33, -19, -42, 51, -44, 72, 37, -26, -43, 54, 20, 66, -125, -101, 98, 16, 9, -10, 116, 78, 88, 39, 98, -3, 83, 99, -97, 90, 2, -35, -40, 103, 41, -70, -59, -4, -112, -19, 91, 124, -79, 35, 4, -123, 0, -91, 38, 13, -106, -69, -76, 55, 69, 47, 2, 3, 1, 0, 1};
        int amount = 10;
        int incrementedNonce = -2079421024;

        assertThrows(SignatureExceptions.class, () -> Client.sendAmountCheckResponse(serverPublicKey, signature, sourcePublicKey, destinationPublicKey, amount, incrementedNonce));
    }

    @Test
    void send_amount_nonce_mismatch() {
        byte[] serverPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -75, -102, -29, 1, -20, -99, 103, -94, 65, 88, -99, -41, 7, 76, 107, 121, 116, 20, -19, 96, 44, 106, -104, -91, 4, -20, 55, -76, 67, 110, 60, 48, 63, 26, 21, 19, -115, 38, 60, 32, 110, -4, 21, 96, 72, 73, -47, -118, -45, -61, -53, -50, 11, -29, -25, -83, -67, -62, 100, -81, -54, -56, 85, -99, -89, -84, 56, 17, -118, 26, -35, -35, -77, 110, -103, 29, -20, -39, 71, -52, -90, 23, 0, 60, 64, 75, -50, -70, 20, -71, -110, 33, 15, 96, -77, 66, 109, 53, 83, 48, 2, -45, -67, -119, 17, 72, -38, 32, -72, 2, 15, -76, -35, -41, 62, -3, -4, -100, -80, 83, -74, -58, -72, -31, -84, -106, -44, 104, -71, -6, 82, -1, -105, 5, 127, 42, 107, -56, 9, 121, -34, 63, 56, -77, -36, 83, 105, -91, -69, -54, -46, -80, -34, 48, 36, 10, 66, 50, 29, -42, -13, -91, -42, 64, -85, -46, 77, 0, 78, -35, 52, 68, 41, 59, 100, -21, 126, 51, 26, -51, 60, 75, -83, 121, 121, 120, -29, 82, -112, 60, 2, 3, 37, 45, 35, -39, -113, 39, -18, -32, -40, -76, 61, 69, 92, -62, 98, 19, -35, 66, -14, -30, 74, -126, -53, -21, 125, -13, 15, -123, -122, -32, -88, 21, -50, -46, 21, 11, -115, 95, -44, -72, 9, -50, 93, 42, 73, -54, -31, -12, -84, 27, -53, 68, 114, 20, 67, 103, 108, 29, -113, 23, 4, -49, 111, 82, 59, -55, -86, -102, 106, -10, 49, -72, -120, -106, 78, -24, -114, -43, -8, 106, 121, -23, 116, 115, -17, -122, -31, 16, -6, -121, 105, -70, 33, 88, 73, 80, -108, -69, -110, -96, 111, 111, -5, -85, 120, 15, -65, -49, -114, 0, 7, 120, -47, -116, 117, -128, -2, -59, -69, -75, -5, 14, -64, 118, -16, -68, -18, 13, -70, -95, 70, 17, 46, -34, 59, 99, -75, -127, -77, -5, -57, 65, -87, -118, 96, -56, 123, 56, -27, -49, 49, 100, -117, 64, -56, -17, 46, 121, -71, -119, -86, 25, -49, -122, -80, -47, 121, 9, -63, -85, -7, -44, -1, 89, -110, -80, 53, 101, -80, -57, -49, 3, 30, 14, -99, -75, -71, -45, -77, 25, 94, 89, 8, -31, 21, -117, 71, -91, 73, 8, -91, 126, -45, 74, 126, 86, 123, -80, -5, -64, -97, 89, -75, 78, -22, -108, -82, -22, -6, 84, -45, -39, -86, 116, -61, 35, -16, 39, -53, -52, -39, 76, 16, -43, -43, 36, 11, 30, 58, 44, -58, 110, -90, -104, -28, 90, 79, -37, 55, -33, 108, 67, 39, -79, 88, 115, -117, 4, 70, -84, -35, -54, -9, 14, -88, -23, 94, -7, -80, -93, 15, 54, -51, 12, -59, -1, -105, -10, -65, 57, 83, 45, -39, 24, 43, -58, -13, 39, -17, -68, 20, 79, -124, 74, -47, -3, 40, -103, -101, 116, -125, -6, -22, -51, 66, -118, 38, 99, 69, -82, -9, -118, 86, 72, 87, 119, -37, -115, -116, -27, 2, 3, 1, 0, 1};
        byte[] signature = {20, 80, -33, 11, 117, -110, 1, 63, 60, -82, -97, -18, -84, 105, 59, 78, 39, 73, -119, 14, -58, -26, 25, 85, 39, -9, 122, 112, 76, 25, -23, -6, -15, 26, -67, -25, 43, 23, -99, 97, 19, 117, -84, 85, -9, -92, 9, -89, 96, -73, 52, 85, 18, -18, 55, -32, 99, 25, 52, 9, 24, 88, -126, 86, -20, 54, -124, 121, 10, 54, -34, -34, 100, -47, 68, -18, -77, 81, 60, -66, 51, -121, -127, -64, 40, -61, -89, 74, -51, -117, -123, -34, -37, 113, -48, -80, 100, 121, 22, 30, -100, 17, -8, 13, -128, -61, -62, 104, 117, 120, -81, 5, 113, -93, 2, -38, 121, 14, -64, 3, 24, -10, 23, 102, 86, -53, -35, 70, 126, -19, 103, -5, 71, -8, -98, 32, 126, 6, 125, -61, -32, 63, 19, -45, -100, 15, -126, 115, 52, -99, -122, -51, -86, 89, -128, -65, 9, -82, -13, -50, 88, 42, 57, -128, 61, 83, -54, 46, -95, 69, -105, 64, -39, -71, 121, 91, 5, 81, 0, -83, -51, 124, 125, 124, -86, -120, -17, 60, 43, -42, -63, -35, -32, -110, -52, -97, 111, 121, 5, 99, 34, -82, 33, -96, 91, -122, -51, 57, 111, 18, 56, -79, -20, -36, -70, 102, -62, -108, -114, 52, -45, 44, 37, 36, 62, 110, -55, -92, -56, 52, 112, -1, 62, -69, -119, 97, -15, -112, -27, 52, 120, -88, 26, -70, 61, -61, -67, -92, 49, -2, -91, -45, -99, -88, 112, -25, -3, -61, 114, 40, 40, -7, 121, 23, 12, 83, 84, -103, -111, -60, -10, 68, -14, 95, 88, -112, 56, -70, 81, -123, 117, -108, -40, 103, 46, 112, -71, -78, 17, -35, -76, 68, 85, 59, 66, 59, 124, 10, 45, 120, 12, 119, 31, 39, 72, -13, 11, 61, -119, 12, -82, -70, 89, 74, 36, -16, 110, -74, -46, 40, -46, -117, -97, 23, -120, 67, -60, 21, 56, -128, -17, 16, -106, 20, 109, 127, 6, 97, 13, -116, 115, 127, 75, -64, 66, 51, -109, 44, 40, 15, 115, 127, 48, -116, 46, 120, -14, -108, -122, -125, -36, -86, -98, 21, -70, -117, -54, -72, -108, -122, -23, 2, -96, 26, -4, 46, -112, -17, 22, 98, 121, 69, -120, -20, -52, -100, -45, 51, -50, -111, -45, 94, -113, 26, -103, 74, -36, -107, -22, -62, -21, -122, -14, -69, -5, -91, 41, -4, 32, 26, 3, -37, -20, -84, 120, 20, 45, 22, -90, -119, 73, -117, -36, 108, -25, 69, 44, 88, -96, -12, 81, -62, 25, -35, -49, 31, 56, 84, 46, 64, -16, -79, 99, -6, 100, 38, 78, 41, 53, -24, 18, -100, 122, 35, 75, 126, -1, 122, 65, -59, 67, -9, 68, 9, 36, -102, -10, 76, 66, -86, -42, 46, 103, 78, -94, -39, -30, 118, -26, 93, -93, 106, -82, -94, -118, -96, 123, 96, 36, 72, 56, 0, 127, -95, 11, -46, 59, -124, -33, -67, -101, 6, -85, -36, 6, -100, 94, 71, -49, -21, 39, 60};
        byte[] sourcePublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -58, -30, 99, -1, 30, 32, 80, 91, -121, -126, -30, 17, -55, 44, -33, -12, -42, 54, 56, -114, 38, 61, 8, 12, 104, -97, 127, 3, -74, 15, 119, -11, -45, 120, -71, -12, 111, 28, 81, 120, -50, -30, 11, -36, -90, -111, -104, 34, -115, -103, 68, 55, 80, 79, -87, 87, -47, -84, -78, -76, -63, -90, 42, -104, 12, -16, 53, -54, -2, -32, 102, 93, -40, -7, -64, 118, 25, -18, 127, -73, 17, 2, 66, 11, -78, -127, 18, 37, -111, -15, -53, 35, 84, 97, -113, 26, 57, 86, -128, -59, 67, -123, -120, -121, 57, -98, -95, 44, 117, 14, 116, 42, 38, -76, -22, -14, -37, -36, -56, 53, -121, -116, -17, -102, -99, -23, 34, -52, 73, -86, -56, -38, -80, -23, 124, 125, 36, 94, -32, -76, 69, -43, 37, 109, 118, 80, -84, 49, 111, 67, -125, 43, -113, 101, 87, -110, -16, -96, 18, 110, 124, -37, -110, -100, 107, -109, -73, -39, -109, -25, 93, 83, -73, -88, 34, 29, -89, 93, -22, -77, 25, 53, 74, 11, 116, -41, -85, 92, -106, 96, 38, -110, 12, 30, 63, 23, 78, -94, 109, 40, 82, 65, -16, 40, 48, -12, 57, -99, -53, -67, -73, 122, 49, -27, -19, 99, 95, -69, -124, -88, 40, -40, -74, -55, 15, -81, -55, 60, -50, -25, 96, -54, 119, 96, 66, -82, -94, 28, -78, -31, -23, 38, 12, 38, 24, 96, 24, 115, 10, 13, 61, 33, 7, -87, -111, -90, 48, 53, -90, 78, -17, -31, 68, 124, -65, -101, 8, 64, -125, -43, 7, 69, 89, 13, 77, 57, 46, 83, -19, -82, 95, -85, -49, 86, -102, -71, 55, -57, 10, -120, -103, -56, 34, 101, 59, -62, -90, 95, -56, 54, -49, 0, -127, -43, -27, 32, 2, 55, -117, -97, 2, -33, 62, -77, -16, -64, 40, -55, -112, 36, 46, 98, -64, -44, -78, -85, -63, 74, -119, -4, -80, -14, 11, -78, -123, -114, 38, 76, -115, 43, -99, -110, -16, -26, -47, -34, 35, 93, -69, -78, -53, 23, 127, 100, 90, -37, 13, 105, 88, 48, -103, 127, -112, -62, -23, 120, 37, 29, -9, -92, -65, 30, -31, -59, 34, 24, -52, -53, 75, 89, 38, 92, -98, 100, 34, 4, 23, 55, -105, 121, 60, -119, -61, -119, -68, -121, -106, -8, 59, 73, 65, 80, -87, 86, 69, 114, 56, -102, 55, 32, -121, 15, 6, 41, -49, -109, -6, -93, -44, 127, -26, -33, -116, -16, -45, 20, 48, 43, 36, -88, -59, -55, -68, 73, 77, -95, -90, -25, -52, 29, 54, -77, 58, 65, -36, 106, 127, 26, 93, -128, -5, -115, 113, 72, 79, -68, -43, -49, 33, -19, -42, 51, -44, 72, 37, -26, -43, 54, 20, 66, -125, -101, 98, 16, 9, -10, 116, 78, 88, 39, 98, -3, 83, 99, -97, 90, 2, -35, -40, 103, 41, -70, -59, -4, -112, -19, 91, 124, -79, 35, 4, -123, 0, -91, 38, 13, -106, -69, -76, 55, 69, 47, 2, 3, 1, 0, 1};
        byte[] destinationPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -58, -30, 99, -1, 30, 32, 80, 91, -121, -126, -30, 17, -55, 44, -33, -12, -42, 54, 56, -114, 38, 61, 8, 12, 104, -97, 127, 3, -74, 15, 119, -11, -45, 120, -71, -12, 111, 28, 81, 120, -50, -30, 11, -36, -90, -111, -104, 34, -115, -103, 68, 55, 80, 79, -87, 87, -47, -84, -78, -76, -63, -90, 42, -104, 12, -16, 53, -54, -2, -32, 102, 93, -40, -7, -64, 118, 25, -18, 127, -73, 17, 2, 66, 11, -78, -127, 18, 37, -111, -15, -53, 35, 84, 97, -113, 26, 57, 86, -128, -59, 67, -123, -120, -121, 57, -98, -95, 44, 117, 14, 116, 42, 38, -76, -22, -14, -37, -36, -56, 53, -121, -116, -17, -102, -99, -23, 34, -52, 73, -86, -56, -38, -80, -23, 124, 125, 36, 94, -32, -76, 69, -43, 37, 109, 118, 80, -84, 49, 111, 67, -125, 43, -113, 101, 87, -110, -16, -96, 18, 110, 124, -37, -110, -100, 107, -109, -73, -39, -109, -25, 93, 83, -73, -88, 34, 29, -89, 93, -22, -77, 25, 53, 74, 11, 116, -41, -85, 92, -106, 96, 38, -110, 12, 30, 63, 23, 78, -94, 109, 40, 82, 65, -16, 40, 48, -12, 57, -99, -53, -67, -73, 122, 49, -27, -19, 99, 95, -69, -124, -88, 40, -40, -74, -55, 15, -81, -55, 60, -50, -25, 96, -54, 119, 96, 66, -82, -94, 28, -78, -31, -23, 38, 12, 38, 24, 96, 24, 115, 10, 13, 61, 33, 7, -87, -111, -90, 48, 53, -90, 78, -17, -31, 68, 124, -65, -101, 8, 64, -125, -43, 7, 69, 89, 13, 77, 57, 46, 83, -19, -82, 95, -85, -49, 86, -102, -71, 55, -57, 10, -120, -103, -56, 34, 101, 59, -62, -90, 95, -56, 54, -49, 0, -127, -43, -27, 32, 2, 55, -117, -97, 2, -33, 62, -77, -16, -64, 40, -55, -112, 36, 46, 98, -64, -44, -78, -85, -63, 74, -119, -4, -80, -14, 11, -78, -123, -114, 38, 76, -115, 43, -99, -110, -16, -26, -47, -34, 35, 93, -69, -78, -53, 23, 127, 100, 90, -37, 13, 105, 88, 48, -103, 127, -112, -62, -23, 120, 37, 29, -9, -92, -65, 30, -31, -59, 34, 24, -52, -53, 75, 89, 38, 92, -98, 100, 34, 4, 23, 55, -105, 121, 60, -119, -61, -119, -68, -121, -106, -8, 59, 73, 65, 80, -87, 86, 69, 114, 56, -102, 55, 32, -121, 15, 6, 41, -49, -109, -6, -93, -44, 127, -26, -33, -116, -16, -45, 20, 48, 43, 36, -88, -59, -55, -68, 73, 77, -95, -90, -25, -52, 29, 54, -77, 58, 65, -36, 106, 127, 26, 93, -128, -5, -115, 113, 72, 79, -68, -43, -49, 33, -19, -42, 51, -44, 72, 37, -26, -43, 54, 20, 66, -125, -101, 98, 16, 9, -10, 116, 78, 88, 39, 98, -3, 83, 99, -97, 90, 2, -35, -40, 103, 41, -70, -59, -4, -112, -19, 91, 124, -79, 35, 4, -123, 0, -91, 38, 13, -106, -69, -76, 55, 69, 47, 2, 3, 1, 0, 1};
        int amount = 10;
        int nonce = -2079421023;

        assertThrows(SignatureExceptions.class, () -> Client.sendAmountCheckResponse(serverPublicKey, signature, sourcePublicKey, destinationPublicKey, amount, nonce));
    }

    @Test
    void receive_amount_normal() {
        byte[] serverPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -75, -102, -29, 1, -20, -99, 103, -94, 65, 88, -99, -41, 7, 76, 107, 121, 116, 20, -19, 96, 44, 106, -104, -91, 4, -20, 55, -76, 67, 110, 60, 48, 63, 26, 21, 19, -115, 38, 60, 32, 110, -4, 21, 96, 72, 73, -47, -118, -45, -61, -53, -50, 11, -29, -25, -83, -67, -62, 100, -81, -54, -56, 85, -99, -89, -84, 56, 17, -118, 26, -35, -35, -77, 110, -103, 29, -20, -39, 71, -52, -90, 23, 0, 60, 64, 75, -50, -70, 20, -71, -110, 33, 15, 96, -77, 66, 109, 53, 83, 48, 2, -45, -67, -119, 17, 72, -38, 32, -72, 2, 15, -76, -35, -41, 62, -3, -4, -100, -80, 83, -74, -58, -72, -31, -84, -106, -44, 104, -71, -6, 82, -1, -105, 5, 127, 42, 107, -56, 9, 121, -34, 63, 56, -77, -36, 83, 105, -91, -69, -54, -46, -80, -34, 48, 36, 10, 66, 50, 29, -42, -13, -91, -42, 64, -85, -46, 77, 0, 78, -35, 52, 68, 41, 59, 100, -21, 126, 51, 26, -51, 60, 75, -83, 121, 121, 120, -29, 82, -112, 60, 2, 3, 37, 45, 35, -39, -113, 39, -18, -32, -40, -76, 61, 69, 92, -62, 98, 19, -35, 66, -14, -30, 74, -126, -53, -21, 125, -13, 15, -123, -122, -32, -88, 21, -50, -46, 21, 11, -115, 95, -44, -72, 9, -50, 93, 42, 73, -54, -31, -12, -84, 27, -53, 68, 114, 20, 67, 103, 108, 29, -113, 23, 4, -49, 111, 82, 59, -55, -86, -102, 106, -10, 49, -72, -120, -106, 78, -24, -114, -43, -8, 106, 121, -23, 116, 115, -17, -122, -31, 16, -6, -121, 105, -70, 33, 88, 73, 80, -108, -69, -110, -96, 111, 111, -5, -85, 120, 15, -65, -49, -114, 0, 7, 120, -47, -116, 117, -128, -2, -59, -69, -75, -5, 14, -64, 118, -16, -68, -18, 13, -70, -95, 70, 17, 46, -34, 59, 99, -75, -127, -77, -5, -57, 65, -87, -118, 96, -56, 123, 56, -27, -49, 49, 100, -117, 64, -56, -17, 46, 121, -71, -119, -86, 25, -49, -122, -80, -47, 121, 9, -63, -85, -7, -44, -1, 89, -110, -80, 53, 101, -80, -57, -49, 3, 30, 14, -99, -75, -71, -45, -77, 25, 94, 89, 8, -31, 21, -117, 71, -91, 73, 8, -91, 126, -45, 74, 126, 86, 123, -80, -5, -64, -97, 89, -75, 78, -22, -108, -82, -22, -6, 84, -45, -39, -86, 116, -61, 35, -16, 39, -53, -52, -39, 76, 16, -43, -43, 36, 11, 30, 58, 44, -58, 110, -90, -104, -28, 90, 79, -37, 55, -33, 108, 67, 39, -79, 88, 115, -117, 4, 70, -84, -35, -54, -9, 14, -88, -23, 94, -7, -80, -93, 15, 54, -51, 12, -59, -1, -105, -10, -65, 57, 83, 45, -39, 24, 43, -58, -13, 39, -17, -68, 20, 79, -124, 74, -47, -3, 40, -103, -101, 116, -125, -6, -22, -51, 66, -118, 38, 99, 69, -82, -9, -118, 86, 72, 87, 119, -37, -115, -116, -27, 2, 3, 1, 0, 1};
        byte[] accountPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -58, -30, 99, -1, 30, 32, 80, 91, -121, -126, -30, 17, -55, 44, -33, -12, -42, 54, 56, -114, 38, 61, 8, 12, 104, -97, 127, 3, -74, 15, 119, -11, -45, 120, -71, -12, 111, 28, 81, 120, -50, -30, 11, -36, -90, -111, -104, 34, -115, -103, 68, 55, 80, 79, -87, 87, -47, -84, -78, -76, -63, -90, 42, -104, 12, -16, 53, -54, -2, -32, 102, 93, -40, -7, -64, 118, 25, -18, 127, -73, 17, 2, 66, 11, -78, -127, 18, 37, -111, -15, -53, 35, 84, 97, -113, 26, 57, 86, -128, -59, 67, -123, -120, -121, 57, -98, -95, 44, 117, 14, 116, 42, 38, -76, -22, -14, -37, -36, -56, 53, -121, -116, -17, -102, -99, -23, 34, -52, 73, -86, -56, -38, -80, -23, 124, 125, 36, 94, -32, -76, 69, -43, 37, 109, 118, 80, -84, 49, 111, 67, -125, 43, -113, 101, 87, -110, -16, -96, 18, 110, 124, -37, -110, -100, 107, -109, -73, -39, -109, -25, 93, 83, -73, -88, 34, 29, -89, 93, -22, -77, 25, 53, 74, 11, 116, -41, -85, 92, -106, 96, 38, -110, 12, 30, 63, 23, 78, -94, 109, 40, 82, 65, -16, 40, 48, -12, 57, -99, -53, -67, -73, 122, 49, -27, -19, 99, 95, -69, -124, -88, 40, -40, -74, -55, 15, -81, -55, 60, -50, -25, 96, -54, 119, 96, 66, -82, -94, 28, -78, -31, -23, 38, 12, 38, 24, 96, 24, 115, 10, 13, 61, 33, 7, -87, -111, -90, 48, 53, -90, 78, -17, -31, 68, 124, -65, -101, 8, 64, -125, -43, 7, 69, 89, 13, 77, 57, 46, 83, -19, -82, 95, -85, -49, 86, -102, -71, 55, -57, 10, -120, -103, -56, 34, 101, 59, -62, -90, 95, -56, 54, -49, 0, -127, -43, -27, 32, 2, 55, -117, -97, 2, -33, 62, -77, -16, -64, 40, -55, -112, 36, 46, 98, -64, -44, -78, -85, -63, 74, -119, -4, -80, -14, 11, -78, -123, -114, 38, 76, -115, 43, -99, -110, -16, -26, -47, -34, 35, 93, -69, -78, -53, 23, 127, 100, 90, -37, 13, 105, 88, 48, -103, 127, -112, -62, -23, 120, 37, 29, -9, -92, -65, 30, -31, -59, 34, 24, -52, -53, 75, 89, 38, 92, -98, 100, 34, 4, 23, 55, -105, 121, 60, -119, -61, -119, -68, -121, -106, -8, 59, 73, 65, 80, -87, 86, 69, 114, 56, -102, 55, 32, -121, 15, 6, 41, -49, -109, -6, -93, -44, 127, -26, -33, -116, -16, -45, 20, 48, 43, 36, -88, -59, -55, -68, 73, 77, -95, -90, -25, -52, 29, 54, -77, 58, 65, -36, 106, 127, 26, 93, -128, -5, -115, 113, 72, 79, -68, -43, -49, 33, -19, -42, 51, -44, 72, 37, -26, -43, 54, 20, 66, -125, -101, 98, 16, 9, -10, 116, 78, 88, 39, 98, -3, 83, 99, -97, 90, 2, -35, -40, 103, 41, -70, -59, -4, -112, -19, 91, 124, -79, 35, 4, -123, 0, -91, 38, 13, -106, -69, -76, 55, 69, 47, 2, 3, 1, 0, 1};
        byte[] signature = {104, -19, 39, -67, -105, -93, 68, -11, 8, 61, 4, -82, 13, -47, -114, 45, 42, -36, -31, -106, 22, -5, 6, -72, -48, -67, -100, -87, 124, 52, -14, -21, 47, -43, 106, -48, -27, -26, -72, 86, 3, 32, -49, -71, -8, -123, -21, -66, -71, 88, -57, -111, 42, -116, 25, -57, 31, -85, -21, 46, 98, 118, -68, -7, 122, 126, -61, 43, -47, -76, 14, 4, 98, -3, -123, -95, 0, 14, -100, -10, -14, -44, -95, 48, 65, 44, 63, 26, 107, 69, -23, -23, 112, -8, -108, 28, 70, -18, 11, 88, 10, -55, 65, 32, 0, -70, 74, 127, -107, 23, -80, -23, -79, -22, -21, 49, 125, -5, -114, 48, 45, 11, 24, -3, -34, 73, -100, -72, -50, -76, -40, 78, 94, -105, 121, -71, -67, 119, -120, -50, 70, 7, 7, -70, 3, -75, 8, -85, -54, 52, 14, 127, 5, -66, -14, 88, -105, 19, -87, 92, -30, 76, -89, -65, -58, 43, 38, -74, -99, -39, 111, -95, 54, -91, 119, 57, 117, -49, -109, 98, 20, 64, 111, -106, 64, -20, -53, -33, -77, -26, -42, -4, 56, -27, 47, -30, -88, 24, -124, 57, 48, 0, -45, 5, -97, -2, 120, 1, 16, -63, -110, -17, 5, -108, -48, 106, 119, -24, 86, -101, 48, -1, 28, -55, 21, 75, -55, 79, 93, -12, 58, -4, 43, 125, 118, 106, -40, 116, 64, -111, -3, -79, -54, -35, -64, 97, 92, -115, -88, 117, 42, 40, 17, 35, -17, 24, 122, 103, 52, -10, 87, -31, 64, 124, 22, 21, 122, 96, 75, 95, 119, -119, 23, -80, 73, -7, -83, -77, -79, 75, -54, 2, -28, 86, -37, 56, 102, 90, -73, -10, 78, -7, -1, 121, -30, 76, -72, 92, 52, 112, -52, 112, -77, 120, 59, -4, -53, 0, -119, 71, -91, -32, -48, 103, 62, 95, -120, -127, 30, -124, -11, 67, 51, -54, -106, 24, -13, -47, 67, 48, -56, -56, 8, 30, -43, 47, -92, -87, -123, -74, -58, 124, -38, -8, 106, -3, -50, -86, 114, 31, 75, 104, -87, -22, 102, 48, -94, -60, -55, -107, 40, 26, -93, -81, -39, 123, -81, -36, 70, 52, 91, -20, -92, 1, -122, -105, 29, 81, 113, 20, -34, -52, 76, -54, -120, -83, -104, 25, 88, -68, 115, -80, 8, 10, 97, -27, -66, -111, 82, 22, -106, -126, 81, 121, -45, -11, -20, -55, 57, -3, 49, -44, 75, 18, -37, -97, -106, 43, 50, -36, 41, 73, -53, 90, -7, -10, -106, 80, 61, 85, -82, 49, 105, 47, -62, 70, -69, 15, 98, 115, 44, -41, 23, -34, -61, 96, -98, -128, 71, -87, 80, -12, 13, -14, 3, 30, 100, 72, -2, -53, -98, 46, -65, -61, 93, -13, 124, -59, 100, -99, 101, 11, 46, 89, 34, -2, 59, -49, -20, -34, 74, -96, 18, 81, -19, -49, 25, -78, -20, 95, -18, 35, -125, -2, 98, -5, -100, 85, -40, 68, -3, 124, 12, 47, 42, 19, 127, 72, -40, 70, -68, 34};
        int transactionID = 8;
        assertDoesNotThrow(() -> Client.receiveAmountCheckResponse(serverPublicKey, signature, accountPublicKey, transactionID));
    }

    @Test
    void receive_amount_signature_mismatch() {
        byte[] serverPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -75, -102, -29, 1, -20, -99, 103, -94, 65, 88, -99, -41, 7, 76, 107, 121, 116, 20, -19, 96, 44, 106, -104, -91, 4, -20, 55, -76, 67, 110, 60, 48, 63, 26, 21, 19, -115, 38, 60, 32, 110, -4, 21, 96, 72, 73, -47, -118, -45, -61, -53, -50, 11, -29, -25, -83, -67, -62, 100, -81, -54, -56, 85, -99, -89, -84, 56, 17, -118, 26, -35, -35, -77, 110, -103, 29, -20, -39, 71, -52, -90, 23, 0, 60, 64, 75, -50, -70, 20, -71, -110, 33, 15, 96, -77, 66, 109, 53, 83, 48, 2, -45, -67, -119, 17, 72, -38, 32, -72, 2, 15, -76, -35, -41, 62, -3, -4, -100, -80, 83, -74, -58, -72, -31, -84, -106, -44, 104, -71, -6, 82, -1, -105, 5, 127, 42, 107, -56, 9, 121, -34, 63, 56, -77, -36, 83, 105, -91, -69, -54, -46, -80, -34, 48, 36, 10, 66, 50, 29, -42, -13, -91, -42, 64, -85, -46, 77, 0, 78, -35, 52, 68, 41, 59, 100, -21, 126, 51, 26, -51, 60, 75, -83, 121, 121, 120, -29, 82, -112, 60, 2, 3, 37, 45, 35, -39, -113, 39, -18, -32, -40, -76, 61, 69, 92, -62, 98, 19, -35, 66, -14, -30, 74, -126, -53, -21, 125, -13, 15, -123, -122, -32, -88, 21, -50, -46, 21, 11, -115, 95, -44, -72, 9, -50, 93, 42, 73, -54, -31, -12, -84, 27, -53, 68, 114, 20, 67, 103, 108, 29, -113, 23, 4, -49, 111, 82, 59, -55, -86, -102, 106, -10, 49, -72, -120, -106, 78, -24, -114, -43, -8, 106, 121, -23, 116, 115, -17, -122, -31, 16, -6, -121, 105, -70, 33, 88, 73, 80, -108, -69, -110, -96, 111, 111, -5, -85, 120, 15, -65, -49, -114, 0, 7, 120, -47, -116, 117, -128, -2, -59, -69, -75, -5, 14, -64, 118, -16, -68, -18, 13, -70, -95, 70, 17, 46, -34, 59, 99, -75, -127, -77, -5, -57, 65, -87, -118, 96, -56, 123, 56, -27, -49, 49, 100, -117, 64, -56, -17, 46, 121, -71, -119, -86, 25, -49, -122, -80, -47, 121, 9, -63, -85, -7, -44, -1, 89, -110, -80, 53, 101, -80, -57, -49, 3, 30, 14, -99, -75, -71, -45, -77, 25, 94, 89, 8, -31, 21, -117, 71, -91, 73, 8, -91, 126, -45, 74, 126, 86, 123, -80, -5, -64, -97, 89, -75, 78, -22, -108, -82, -22, -6, 84, -45, -39, -86, 116, -61, 35, -16, 39, -53, -52, -39, 76, 16, -43, -43, 36, 11, 30, 58, 44, -58, 110, -90, -104, -28, 90, 79, -37, 55, -33, 108, 67, 39, -79, 88, 115, -117, 4, 70, -84, -35, -54, -9, 14, -88, -23, 94, -7, -80, -93, 15, 54, -51, 12, -59, -1, -105, -10, -65, 57, 83, 45, -39, 24, 43, -58, -13, 39, -17, -68, 20, 79, -124, 74, -47, -3, 40, -103, -101, 116, -125, -6, -22, -51, 66, -118, 38, 99, 69, -82, -9, -118, 86, 72, 87, 119, -37, -115, -116, -27, 2, 3, 1, 0, 1};
        byte[] accountPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -58, -30, 99, -1, 30, 32, 80, 91, -121, -126, -30, 17, -55, 44, -33, -12, -42, 54, 56, -114, 38, 61, 8, 12, 104, -97, 127, 3, -74, 15, 119, -11, -45, 120, -71, -12, 111, 28, 81, 120, -50, -30, 11, -36, -90, -111, -104, 34, -115, -103, 68, 55, 80, 79, -87, 87, -47, -84, -78, -76, -63, -90, 42, -104, 12, -16, 53, -54, -2, -32, 102, 93, -40, -7, -64, 118, 25, -18, 127, -73, 17, 2, 66, 11, -78, -127, 18, 37, -111, -15, -53, 35, 84, 97, -113, 26, 57, 86, -128, -59, 67, -123, -120, -121, 57, -98, -95, 44, 117, 14, 116, 42, 38, -76, -22, -14, -37, -36, -56, 53, -121, -116, -17, -102, -99, -23, 34, -52, 73, -86, -56, -38, -80, -23, 124, 125, 36, 94, -32, -76, 69, -43, 37, 109, 118, 80, -84, 49, 111, 67, -125, 43, -113, 101, 87, -110, -16, -96, 18, 110, 124, -37, -110, -100, 107, -109, -73, -39, -109, -25, 93, 83, -73, -88, 34, 29, -89, 93, -22, -77, 25, 53, 74, 11, 116, -41, -85, 92, -106, 96, 38, -110, 12, 30, 63, 23, 78, -94, 109, 40, 82, 65, -16, 40, 48, -12, 57, -99, -53, -67, -73, 122, 49, -27, -19, 99, 95, -69, -124, -88, 40, -40, -74, -55, 15, -81, -55, 60, -50, -25, 96, -54, 119, 96, 66, -82, -94, 28, -78, -31, -23, 38, 12, 38, 24, 96, 24, 115, 10, 13, 61, 33, 7, -87, -111, -90, 48, 53, -90, 78, -17, -31, 68, 124, -65, -101, 8, 64, -125, -43, 7, 69, 89, 13, 77, 57, 46, 83, -19, -82, 95, -85, -49, 86, -102, -71, 55, -57, 10, -120, -103, -56, 34, 101, 59, -62, -90, 95, -56, 54, -49, 0, -127, -43, -27, 32, 2, 55, -117, -97, 2, -33, 62, -77, -16, -64, 40, -55, -112, 36, 46, 98, -64, -44, -78, -85, -63, 74, -119, -4, -80, -14, 11, -78, -123, -114, 38, 76, -115, 43, -99, -110, -16, -26, -47, -34, 35, 93, -69, -78, -53, 23, 127, 100, 90, -37, 13, 105, 88, 48, -103, 127, -112, -62, -23, 120, 37, 29, -9, -92, -65, 30, -31, -59, 34, 24, -52, -53, 75, 89, 38, 92, -98, 100, 34, 4, 23, 55, -105, 121, 60, -119, -61, -119, -68, -121, -106, -8, 59, 73, 65, 80, -87, 86, 69, 114, 56, -102, 55, 32, -121, 15, 6, 41, -49, -109, -6, -93, -44, 127, -26, -33, -116, -16, -45, 20, 48, 43, 36, -88, -59, -55, -68, 73, 77, -95, -90, -25, -52, 29, 54, -77, 58, 65, -36, 106, 127, 26, 93, -128, -5, -115, 113, 72, 79, -68, -43, -49, 33, -19, -42, 51, -44, 72, 37, -26, -43, 54, 20, 66, -125, -101, 98, 16, 9, -10, 116, 78, 88, 39, 98, -3, 83, 99, -97, 90, 2, -35, -40, 103, 41, -70, -59, -4, -112, -19, 91, 124, -79, 35, 4, -123, 0, -91, 38, 13, -106, -69, -76, 55, 69, 47, 2, 3, 1, 0, 1};
        byte[] signature = {106, -19, 39, -67, -105, -93, 68, -11, 8, 61, 4, -82, 13, -47, -114, 45, 42, -36, -31, -106, 22, -5, 6, -72, -48, -67, -100, -87, 124, 52, -14, -21, 47, -43, 106, -48, -27, -26, -72, 86, 3, 32, -49, -71, -8, -123, -21, -66, -71, 88, -57, -111, 42, -116, 25, -57, 31, -85, -21, 46, 98, 118, -68, -7, 122, 126, -61, 43, -47, -76, 14, 4, 98, -3, -123, -95, 0, 14, -100, -10, -14, -44, -95, 48, 65, 44, 63, 26, 107, 69, -23, -23, 112, -8, -108, 28, 70, -18, 11, 88, 10, -55, 65, 32, 0, -70, 74, 127, -107, 23, -80, -23, -79, -22, -21, 49, 125, -5, -114, 48, 45, 11, 24, -3, -34, 73, -100, -72, -50, -76, -40, 78, 94, -105, 121, -71, -67, 119, -120, -50, 70, 7, 7, -70, 3, -75, 8, -85, -54, 52, 14, 127, 5, -66, -14, 88, -105, 19, -87, 92, -30, 76, -89, -65, -58, 43, 38, -74, -99, -39, 111, -95, 54, -91, 119, 57, 117, -49, -109, 98, 20, 64, 111, -106, 64, -20, -53, -33, -77, -26, -42, -4, 56, -27, 47, -30, -88, 24, -124, 57, 48, 0, -45, 5, -97, -2, 120, 1, 16, -63, -110, -17, 5, -108, -48, 106, 119, -24, 86, -101, 48, -1, 28, -55, 21, 75, -55, 79, 93, -12, 58, -4, 43, 125, 118, 106, -40, 116, 64, -111, -3, -79, -54, -35, -64, 97, 92, -115, -88, 117, 42, 40, 17, 35, -17, 24, 122, 103, 52, -10, 87, -31, 64, 124, 22, 21, 122, 96, 75, 95, 119, -119, 23, -80, 73, -7, -83, -77, -79, 75, -54, 2, -28, 86, -37, 56, 102, 90, -73, -10, 78, -7, -1, 121, -30, 76, -72, 92, 52, 112, -52, 112, -77, 120, 59, -4, -53, 0, -119, 71, -91, -32, -48, 103, 62, 95, -120, -127, 30, -124, -11, 67, 51, -54, -106, 24, -13, -47, 67, 48, -56, -56, 8, 30, -43, 47, -92, -87, -123, -74, -58, 124, -38, -8, 106, -3, -50, -86, 114, 31, 75, 104, -87, -22, 102, 48, -94, -60, -55, -107, 40, 26, -93, -81, -39, 123, -81, -36, 70, 52, 91, -20, -92, 1, -122, -105, 29, 81, 113, 20, -34, -52, 76, -54, -120, -83, -104, 25, 88, -68, 115, -80, 8, 10, 97, -27, -66, -111, 82, 22, -106, -126, 81, 121, -45, -11, -20, -55, 57, -3, 49, -44, 75, 18, -37, -97, -106, 43, 50, -36, 41, 73, -53, 90, -7, -10, -106, 80, 61, 85, -82, 49, 105, 47, -62, 70, -69, 15, 98, 115, 44, -41, 23, -34, -61, 96, -98, -128, 71, -87, 80, -12, 13, -14, 3, 30, 100, 72, -2, -53, -98, 46, -65, -61, 93, -13, 124, -59, 100, -99, 101, 11, 46, 89, 34, -2, 59, -49, -20, -34, 74, -96, 18, 81, -19, -49, 25, -78, -20, 95, -18, 35, -125, -2, 98, -5, -100, 85, -40, 68, -3, 124, 12, 47, 42, 19, 127, 72, -40, 70, -68, 34};
        int transactionID = 8;
        assertThrows(SignatureExceptions.class, () -> Client.receiveAmountCheckResponse(serverPublicKey, signature, accountPublicKey, transactionID));
    }

    @Test
    void check_account_normal() {
        byte[] accountPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -29, -8, -48, 5, -52, 37, -16, 88, 77, -123, -75, 54, -9, 123, -31, -109, 27, -77, 22, -28, 42, -124, 62, -51, 25, -91, 28, -62, -58, -112, 104, -39, -113, 95, -82, 49, 24, 106, 40, -78, -117, 6, 94, 61, -41, -45, 31, 48, 120, 106, 16, -100, -56, -65, -5, 22, -64, -29, 100, 61, -9, 3, 17, -121, -82, -64, -77, -42, -48, -112, 72, -99, 73, -27, -1, -7, -121, -4, 83, 24, 127, -13, -54, 89, 6, -110, 11, 104, -15, -120, -118, 120, -94, 3, -91, 103, 107, 9, 118, 3, -124, 96, 115, -80, 93, -1, -120, -74, -116, 39, 48, -32, 68, 42, -62, 103, -56, -75, -77, -67, -37, -31, 32, -84, -47, -40, -25, 113, 3, -76, 60, 55, -118, -87, -68, 117, 94, 57, -81, -100, 16, 68, -76, -2, 68, 101, -78, 22, 61, -3, 62, -53, 8, 94, -37, 91, -100, -75, 81, 14, 84, -124, -56, -109, -31, 32, 99, 17, -11, -114, -73, -5, -98, -66, -37, -24, 26, -68, -100, 122, 31, 119, -76, 103, -61, 34, -16, -115, 31, -20, 71, 44, -121, 90, -90, 115, 119, 124, 23, 69, 43, 2, 110, 59, 66, 120, -97, -44, -62, -55, 125, 111, -32, -115, 74, 93, 25, -70, 101, 0, 117, 8, -107, 39, 55, 84, 56, 83, -65, -23, 17, 113, 30, 10, -83, 23, -94, 99, 29, -15, -94, 87, -85, -27, -98, -112, 54, 65, -92, -20, -30, -121, 11, 86, -124, -37, -108, 94, -96, 35, 102, 43, -53, 117, -32, -76, -19, -33, -74, 35, -85, 59, -43, 29, -12, -62, -52, 100, -16, -62, -29, -37, 73, 43, 30, -125, -34, 67, -88, 74, -32, -85, -3, 94, 54, -28, 89, -45, -27, -9, 111, 101, -65, -44, 11, 115, 107, 8, -116, -99, 97, -69, 18, 21, -26, -54, -98, 56, -128, -98, 49, 60, -14, -74, -27, -30, -38, -30, -42, -87, 14, 121, 125, -78, -90, 6, -1, -77, -72, -58, -4, 123, -72, -69, 59, 69, -86, -6, 85, 85, 13, -68, -24, -127, -115, 15, -76, 102, 6, 116, 61, 61, 106, 106, -33, -105, 7, 49, 17, 36, -29, 21, 21, 43, 16, 42, -113, 78, -5, -83, -54, 105, 43, -68, -38, -33, -123, 21, 90, -46, 0, -64, -98, 122, 82, 108, -65, -22, -73, 56, -65, 32, 1, 99, -10, 83, 1, 19, -25, -98, 60, 64, 29, 124, -74, -109, 118, 18, 98, 80, 11, 96, -69, 6, -35, -37, 108, -24, -54, -25, -60, -118, 36, 25, 115, 37, 78, -22, -22, 47, -65, 91, -97, 11, 60, -60, -17, 42, 59, 124, -34, 29, 80, -82, 79, -68, 7, 81, 86, 96, -20, 26, -58, -114, 6, 127, -104, 85, -52, -112, -106, 45, 110, -32, -32, 78, -72, 61, 113, -110, -2, 48, -96, 100, 47, -91, 111, 46, -119, 62, 37, 44, 126, 14, -21, 106, -104, 53, -114, -119, 9, 28, 41, -92, -32, 62, -3, -105, 26, -105, 43, 67, 2, 3, 1, 0, 1};
        byte[] serverPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -58, -30, 99, -1, 30, 32, 80, 91, -121, -126, -30, 17, -55, 44, -33, -12, -42, 54, 56, -114, 38, 61, 8, 12, 104, -97, 127, 3, -74, 15, 119, -11, -45, 120, -71, -12, 111, 28, 81, 120, -50, -30, 11, -36, -90, -111, -104, 34, -115, -103, 68, 55, 80, 79, -87, 87, -47, -84, -78, -76, -63, -90, 42, -104, 12, -16, 53, -54, -2, -32, 102, 93, -40, -7, -64, 118, 25, -18, 127, -73, 17, 2, 66, 11, -78, -127, 18, 37, -111, -15, -53, 35, 84, 97, -113, 26, 57, 86, -128, -59, 67, -123, -120, -121, 57, -98, -95, 44, 117, 14, 116, 42, 38, -76, -22, -14, -37, -36, -56, 53, -121, -116, -17, -102, -99, -23, 34, -52, 73, -86, -56, -38, -80, -23, 124, 125, 36, 94, -32, -76, 69, -43, 37, 109, 118, 80, -84, 49, 111, 67, -125, 43, -113, 101, 87, -110, -16, -96, 18, 110, 124, -37, -110, -100, 107, -109, -73, -39, -109, -25, 93, 83, -73, -88, 34, 29, -89, 93, -22, -77, 25, 53, 74, 11, 116, -41, -85, 92, -106, 96, 38, -110, 12, 30, 63, 23, 78, -94, 109, 40, 82, 65, -16, 40, 48, -12, 57, -99, -53, -67, -73, 122, 49, -27, -19, 99, 95, -69, -124, -88, 40, -40, -74, -55, 15, -81, -55, 60, -50, -25, 96, -54, 119, 96, 66, -82, -94, 28, -78, -31, -23, 38, 12, 38, 24, 96, 24, 115, 10, 13, 61, 33, 7, -87, -111, -90, 48, 53, -90, 78, -17, -31, 68, 124, -65, -101, 8, 64, -125, -43, 7, 69, 89, 13, 77, 57, 46, 83, -19, -82, 95, -85, -49, 86, -102, -71, 55, -57, 10, -120, -103, -56, 34, 101, 59, -62, -90, 95, -56, 54, -49, 0, -127, -43, -27, 32, 2, 55, -117, -97, 2, -33, 62, -77, -16, -64, 40, -55, -112, 36, 46, 98, -64, -44, -78, -85, -63, 74, -119, -4, -80, -14, 11, -78, -123, -114, 38, 76, -115, 43, -99, -110, -16, -26, -47, -34, 35, 93, -69, -78, -53, 23, 127, 100, 90, -37, 13, 105, 88, 48, -103, 127, -112, -62, -23, 120, 37, 29, -9, -92, -65, 30, -31, -59, 34, 24, -52, -53, 75, 89, 38, 92, -98, 100, 34, 4, 23, 55, -105, 121, 60, -119, -61, -119, -68, -121, -106, -8, 59, 73, 65, 80, -87, 86, 69, 114, 56, -102, 55, 32, -121, 15, 6, 41, -49, -109, -6, -93, -44, 127, -26, -33, -116, -16, -45, 20, 48, 43, 36, -88, -59, -55, -68, 73, 77, -95, -90, -25, -52, 29, 54, -77, 58, 65, -36, 106, 127, 26, 93, -128, -5, -115, 113, 72, 79, -68, -43, -49, 33, -19, -42, 51, -44, 72, 37, -26, -43, 54, 20, 66, -125, -101, 98, 16, 9, -10, 116, 78, 88, 39, 98, -3, 83, 99, -97, 90, 2, -35, -40, 103, 41, -70, -59, -4, -112, -19, 91, 124, -79, 35, 4, -123, 0, -91, 38, 13, -106, -69, -76, 55, 69, 47, 2, 3, 1, 0, 1};
        byte[] signature = {12, 117, 69, 64, 122, 64, -57, -86, 79, 125, 67, -53, -32, -100, 82, 58, -86, -47, -75, -82, 31, -112, -82, -65, 126, -94, -109, -122, -83, 44, -21, -118, 87, 55, 127, 28, -7, 28, -27, -12, -26, -15, -63, -111, -47, 57, -99, -26, -80, -38, 67, 14, -43, -13, 44, -7, 111, 4, 34, 115, 124, 26, 78, 124, 101, 82, 7, -79, 123, -90, 98, 98, -100, 51, 116, 14, 92, 43, -77, 78, 2, -93, -70, -11, -21, 50, -125, -53, -113, -37, -111, 10, 30, 41, -73, -111, 22, 116, -119, 83, -15, 76, -2, 60, -120, 104, 31, 2, -124, -127, 71, 11, -113, -89, -32, -45, -29, -65, -114, -99, 8, 124, -87, 102, 29, 63, -112, -4, -78, -21, 116, -119, -44, -40, -52, -4, -81, 21, 73, -119, 33, -19, -98, -87, -66, 122, 67, -6, 82, -87, 52, 41, 23, -75, 19, -70, 81, -111, 31, -55, 7, -31, -109, 3, 109, -69, -99, -72, -92, -9, -36, 27, -34, -81, 93, -11, 73, -86, -44, 14, 106, -127, 38, -77, 16, -101, -30, 52, -73, -121, -21, 111, -86, 78, -48, 99, 53, -62, -104, 22, 55, 75, -88, -42, 104, -101, 76, 76, -79, 32, 33, 8, 93, -28, -30, -37, 76, -12, 48, 110, 30, 22, -15, 111, 34, -15, 45, -21, -97, -62, -97, -101, -43, 110, 89, 59, 46, -104, 41, -78, -16, 61, -85, -6, -75, -95, 57, 28, -47, 8, -17, -20, -52, -26, -10, -100, 7, -63, 66, 105, 32, 66, -75, -104, -115, 54, -17, -105, 44, -102, -23, 127, 125, -116, 117, -111, 108, 26, 106, 66, -121, -116, -23, -91, 3, -53, -93, -35, 90, -81, -62, 97, 82, 21, -42, 5, 89, -80, 43, -119, 54, 50, 50, 115, -101, 13, -3, -55, 29, 74, 106, 32, -82, 120, 38, -48, 33, -99, -3, 18, -17, -53, -50, -85, -66, 45, 46, -9, -104, -20, 123, -84, -98, 52, 120, 93, -10, -75, 82, 4, -16, -34, -120, 47, 68, 117, 81, -89, -107, 51, 111, -48, -124, -51, 70, 24, 74, 29, 61, 47, -38, 19, 86, 51, -47, 101, 36, 112, -7, 56, -34, 126, -4, 45, -13, 23, -79, -7, 13, 127, 104, -7, 5, 102, -10, 38, 5, -56, -32, -63, 124, -1, -123, 102, -120, -35, -100, -73, 86, -83, 59, -78, 110, 13, -121, -23, 67, -69, 13, 4, 117, -128, -99, -98, 100, -120, 4, -109, -85, -29, -114, 34, 100, 99, -110, 110, 70, 17, 85, 51, 66, -32, 35, -44, 77, 23, 24, -119, -10, 63, 91, 29, -86, -64, 11, 41, -97, -122, -2, -85, -99, 2, 46, -64, -22, -127, 88, -106, -33, 118, -118, 5, 49, -6, -105, -11, 33, 49, 39, -120, -106, -30, 48, 47, -73, -127, -107, 93, -75, 114, 91, -64, 95, 38, 127, -118, -127, 81, 79, -82, 127, 11, 94, -99, 124, -21, -44, 74, 19, -28, 67, 4, 43, 81, 89, 125, -59, 4, 45, -115, -97, 110};
        int balance = 950;
        int transactionID = 15;
        String transaction = "[15] amount: 50\nFrom: MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA4/jQBcwl8FhNhbU293vhkxuzFuQqhD7NGaUcwsaQaNmPX64xGGoososGXj3X0x8weGoQnMi/+xbA42Q99wMRh67As9bQkEidSeX/+Yf8Uxh/88pZBpILaPGIiniiA6Vnawl2A4Rgc7Bd/4i2jCcw4EQqwmfItbO92+EgrNHY53EDtDw3iqm8dV45r5wQRLT+RGWyFj39PssIXttbnLVRDlSEyJPhIGMR9Y63+56+2+gavJx6H3e0Z8Mi8I0f7Ecsh1qmc3d8F0UrAm47Qnif1MLJfW/gjUpdGbplAHUIlSc3VDhTv+kRcR4KrReiYx3xoler5Z6QNkGk7OKHC1aE25ReoCNmK8t14LTt37YjqzvVHfTCzGTwwuPbSSseg95DqErgq/1eNuRZ0+X3b2W/1AtzawiMnWG7EhXmyp44gJ4xPPK25eLa4tapDnl9sqYG/7O4xvx7uLs7Rar6VVUNvOiBjQ+0ZgZ0PT1qat+XBzERJOMVFSsQKo9O+63KaSu82t+FFVrSAMCeelJsv+q3OL8gAWP2UwET5548QB18tpN2EmJQC2C7Bt3bbOjK58SKJBlzJU7q6i+/W58LPMTvKjt83h1Qrk+8B1FWYOwaxo4Gf5hVzJCWLW7g4E64PXGS/jCgZC+lby6JPiUsfg7rapg1jokJHCmk4D79lxqXK0MCAwEAAQ==\nTo: MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA4/jQBcwl8FhNhbU293vhkxuzFuQqhD7NGaUcwsaQaNmPX64xGGoososGXj3X0x8weGoQnMi/+xbA42Q99wMRh67As9bQkEidSeX/+Yf8Uxh/88pZBpILaPGIiniiA6Vnawl2A4Rgc7Bd/4i2jCcw4EQqwmfItbO92+EgrNHY53EDtDw3iqm8dV45r5wQRLT+RGWyFj39PssIXttbnLVRDlSEyJPhIGMR9Y63+56+2+gavJx6H3e0Z8Mi8I0f7Ecsh1qmc3d8F0UrAm47Qnif1MLJfW/gjUpdGbplAHUIlSc3VDhTv+kRcR4KrReiYx3xoler5Z6QNkGk7OKHC1aE25ReoCNmK8t14LTt37YjqzvVHfTCzGTwwuPbSSseg95DqErgq/1eNuRZ0+X3b2W/1AtzawiMnWG7EhXmyp44gJ4xPPK25eLa4tapDnl9sqYG/7O4xvx7uLs7Rar6VVUNvOiBjQ+0ZgZ0PT1qat+XBzERJOMVFSsQKo9O+63KaSu82t+FFVrSAMCeelJsv+q3OL8gAWP2UwET5548QB18tpN2EmJQC2C7Bt3bbOjK58SKJBlzJU7q6i+/W58LPMTvKjt83h1Qrk+8B1FWYOwaxo4Gf5hVzJCWLW7g4E64PXGS/jCgZC+lby6JPiUsfg7rapg1jokJHCmk4D79lxqXK0MCAwEAAQ==\n";
        CheckAccountResponse.Builder builder = CheckAccountResponse.newBuilder().addTransactions(transaction);
        assertDoesNotThrow(() -> Client.checkAccountCheckResponse(serverPublicKey, signature, balance, builder.getTransactionsList().toArray()));
    }

    @Test
    void check_account_signature_mismatch() {
        byte[] serverPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -58, -30, 99, -1, 30, 32, 80, 91, -121, -126, -30, 17, -55, 44, -33, -12, -42, 54, 56, -114, 38, 61, 8, 12, 104, -97, 127, 3, -74, 15, 119, -11, -45, 120, -71, -12, 111, 28, 81, 120, -50, -30, 11, -36, -90, -111, -104, 34, -115, -103, 68, 55, 80, 79, -87, 87, -47, -84, -78, -76, -63, -90, 42, -104, 12, -16, 53, -54, -2, -32, 102, 93, -40, -7, -64, 118, 25, -18, 127, -73, 17, 2, 66, 11, -78, -127, 18, 37, -111, -15, -53, 35, 84, 97, -113, 26, 57, 86, -128, -59, 67, -123, -120, -121, 57, -98, -95, 44, 117, 14, 116, 42, 38, -76, -22, -14, -37, -36, -56, 53, -121, -116, -17, -102, -99, -23, 34, -52, 73, -86, -56, -38, -80, -23, 124, 125, 36, 94, -32, -76, 69, -43, 37, 109, 118, 80, -84, 49, 111, 67, -125, 43, -113, 101, 87, -110, -16, -96, 18, 110, 124, -37, -110, -100, 107, -109, -73, -39, -109, -25, 93, 83, -73, -88, 34, 29, -89, 93, -22, -77, 25, 53, 74, 11, 116, -41, -85, 92, -106, 96, 38, -110, 12, 30, 63, 23, 78, -94, 109, 40, 82, 65, -16, 40, 48, -12, 57, -99, -53, -67, -73, 122, 49, -27, -19, 99, 95, -69, -124, -88, 40, -40, -74, -55, 15, -81, -55, 60, -50, -25, 96, -54, 119, 96, 66, -82, -94, 28, -78, -31, -23, 38, 12, 38, 24, 96, 24, 115, 10, 13, 61, 33, 7, -87, -111, -90, 48, 53, -90, 78, -17, -31, 68, 124, -65, -101, 8, 64, -125, -43, 7, 69, 89, 13, 77, 57, 46, 83, -19, -82, 95, -85, -49, 86, -102, -71, 55, -57, 10, -120, -103, -56, 34, 101, 59, -62, -90, 95, -56, 54, -49, 0, -127, -43, -27, 32, 2, 55, -117, -97, 2, -33, 62, -77, -16, -64, 40, -55, -112, 36, 46, 98, -64, -44, -78, -85, -63, 74, -119, -4, -80, -14, 11, -78, -123, -114, 38, 76, -115, 43, -99, -110, -16, -26, -47, -34, 35, 93, -69, -78, -53, 23, 127, 100, 90, -37, 13, 105, 88, 48, -103, 127, -112, -62, -23, 120, 37, 29, -9, -92, -65, 30, -31, -59, 34, 24, -52, -53, 75, 89, 38, 92, -98, 100, 34, 4, 23, 55, -105, 121, 60, -119, -61, -119, -68, -121, -106, -8, 59, 73, 65, 80, -87, 86, 69, 114, 56, -102, 55, 32, -121, 15, 6, 41, -49, -109, -6, -93, -44, 127, -26, -33, -116, -16, -45, 20, 48, 43, 36, -88, -59, -55, -68, 73, 77, -95, -90, -25, -52, 29, 54, -77, 58, 65, -36, 106, 127, 26, 93, -128, -5, -115, 113, 72, 79, -68, -43, -49, 33, -19, -42, 51, -44, 72, 37, -26, -43, 54, 20, 66, -125, -101, 98, 16, 9, -10, 116, 78, 88, 39, 98, -3, 83, 99, -97, 90, 2, -35, -40, 103, 41, -70, -59, -4, -112, -19, 91, 124, -79, 35, 4, -123, 0, -91, 38, 13, -106, -69, -76, 55, 69, 47, 2, 3, 1, 0, 1};
        byte[] signature = {13, 117, 69, 64, 122, 64, -57, -86, 79, 125, 67, -53, -32, -100, 82, 58, -86, -47, -75, -82, 31, -112, -82, -65, 126, -94, -109, -122, -83, 44, -21, -118, 87, 55, 127, 28, -7, 28, -27, -12, -26, -15, -63, -111, -47, 57, -99, -26, -80, -38, 67, 14, -43, -13, 44, -7, 111, 4, 34, 115, 124, 26, 78, 124, 101, 82, 7, -79, 123, -90, 98, 98, -100, 51, 116, 14, 92, 43, -77, 78, 2, -93, -70, -11, -21, 50, -125, -53, -113, -37, -111, 10, 30, 41, -73, -111, 22, 116, -119, 83, -15, 76, -2, 60, -120, 104, 31, 2, -124, -127, 71, 11, -113, -89, -32, -45, -29, -65, -114, -99, 8, 124, -87, 102, 29, 63, -112, -4, -78, -21, 116, -119, -44, -40, -52, -4, -81, 21, 73, -119, 33, -19, -98, -87, -66, 122, 67, -6, 82, -87, 52, 41, 23, -75, 19, -70, 81, -111, 31, -55, 7, -31, -109, 3, 109, -69, -99, -72, -92, -9, -36, 27, -34, -81, 93, -11, 73, -86, -44, 14, 106, -127, 38, -77, 16, -101, -30, 52, -73, -121, -21, 111, -86, 78, -48, 99, 53, -62, -104, 22, 55, 75, -88, -42, 104, -101, 76, 76, -79, 32, 33, 8, 93, -28, -30, -37, 76, -12, 48, 110, 30, 22, -15, 111, 34, -15, 45, -21, -97, -62, -97, -101, -43, 110, 89, 59, 46, -104, 41, -78, -16, 61, -85, -6, -75, -95, 57, 28, -47, 8, -17, -20, -52, -26, -10, -100, 7, -63, 66, 105, 32, 66, -75, -104, -115, 54, -17, -105, 44, -102, -23, 127, 125, -116, 117, -111, 108, 26, 106, 66, -121, -116, -23, -91, 3, -53, -93, -35, 90, -81, -62, 97, 82, 21, -42, 5, 89, -80, 43, -119, 54, 50, 50, 115, -101, 13, -3, -55, 29, 74, 106, 32, -82, 120, 38, -48, 33, -99, -3, 18, -17, -53, -50, -85, -66, 45, 46, -9, -104, -20, 123, -84, -98, 52, 120, 93, -10, -75, 82, 4, -16, -34, -120, 47, 68, 117, 81, -89, -107, 51, 111, -48, -124, -51, 70, 24, 74, 29, 61, 47, -38, 19, 86, 51, -47, 101, 36, 112, -7, 56, -34, 126, -4, 45, -13, 23, -79, -7, 13, 127, 104, -7, 5, 102, -10, 38, 5, -56, -32, -63, 124, -1, -123, 102, -120, -35, -100, -73, 86, -83, 59, -78, 110, 13, -121, -23, 67, -69, 13, 4, 117, -128, -99, -98, 100, -120, 4, -109, -85, -29, -114, 34, 100, 99, -110, 110, 70, 17, 85, 51, 66, -32, 35, -44, 77, 23, 24, -119, -10, 63, 91, 29, -86, -64, 11, 41, -97, -122, -2, -85, -99, 2, 46, -64, -22, -127, 88, -106, -33, 118, -118, 5, 49, -6, -105, -11, 33, 49, 39, -120, -106, -30, 48, 47, -73, -127, -107, 93, -75, 114, 91, -64, 95, 38, 127, -118, -127, 81, 79, -82, 127, 11, 94, -99, 124, -21, -44, 74, 19, -28, 67, 4, 43, 81, 89, 125, -59, 4, 45, -115, -97, 110};
        int balance = 950;
        String transaction = "[15] amount: 50\nFrom: MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA4/jQBcwl8FhNhbU293vhkxuzFuQqhD7NGaUcwsaQaNmPX64xGGoososGXj3X0x8weGoQnMi/+xbA42Q99wMRh67As9bQkEidSeX/+Yf8Uxh/88pZBpILaPGIiniiA6Vnawl2A4Rgc7Bd/4i2jCcw4EQqwmfItbO92+EgrNHY53EDtDw3iqm8dV45r5wQRLT+RGWyFj39PssIXttbnLVRDlSEyJPhIGMR9Y63+56+2+gavJx6H3e0Z8Mi8I0f7Ecsh1qmc3d8F0UrAm47Qnif1MLJfW/gjUpdGbplAHUIlSc3VDhTv+kRcR4KrReiYx3xoler5Z6QNkGk7OKHC1aE25ReoCNmK8t14LTt37YjqzvVHfTCzGTwwuPbSSseg95DqErgq/1eNuRZ0+X3b2W/1AtzawiMnWG7EhXmyp44gJ4xPPK25eLa4tapDnl9sqYG/7O4xvx7uLs7Rar6VVUNvOiBjQ+0ZgZ0PT1qat+XBzERJOMVFSsQKo9O+63KaSu82t+FFVrSAMCeelJsv+q3OL8gAWP2UwET5548QB18tpN2EmJQC2C7Bt3bbOjK58SKJBlzJU7q6i+/W58LPMTvKjt83h1Qrk+8B1FWYOwaxo4Gf5hVzJCWLW7g4E64PXGS/jCgZC+lby6JPiUsfg7rapg1jokJHCmk4D79lxqXK0MCAwEAAQ==\nTo: MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA4/jQBcwl8FhNhbU293vhkxuzFuQqhD7NGaUcwsaQaNmPX64xGGoososGXj3X0x8weGoQnMi/+xbA42Q99wMRh67As9bQkEidSeX/+Yf8Uxh/88pZBpILaPGIiniiA6Vnawl2A4Rgc7Bd/4i2jCcw4EQqwmfItbO92+EgrNHY53EDtDw3iqm8dV45r5wQRLT+RGWyFj39PssIXttbnLVRDlSEyJPhIGMR9Y63+56+2+gavJx6H3e0Z8Mi8I0f7Ecsh1qmc3d8F0UrAm47Qnif1MLJfW/gjUpdGbplAHUIlSc3VDhTv+kRcR4KrReiYx3xoler5Z6QNkGk7OKHC1aE25ReoCNmK8t14LTt37YjqzvVHfTCzGTwwuPbSSseg95DqErgq/1eNuRZ0+X3b2W/1AtzawiMnWG7EhXmyp44gJ4xPPK25eLa4tapDnl9sqYG/7O4xvx7uLs7Rar6VVUNvOiBjQ+0ZgZ0PT1qat+XBzERJOMVFSsQKo9O+63KaSu82t+FFVrSAMCeelJsv+q3OL8gAWP2UwET5548QB18tpN2EmJQC2C7Bt3bbOjK58SKJBlzJU7q6i+/W58LPMTvKjt83h1Qrk+8B1FWYOwaxo4Gf5hVzJCWLW7g4E64PXGS/jCgZC+lby6JPiUsfg7rapg1jokJHCmk4D79lxqXK0MCAwEAAQ==\n";
        CheckAccountResponse.Builder builder = CheckAccountResponse.newBuilder().addTransactions(transaction);
        assertThrows(SignatureExceptions.class, () -> Client.checkAccountCheckResponse(serverPublicKey, signature, balance, builder.getTransactionsList().toArray()));
    }

    @Test
    void audit_normal(){
        byte[] serverPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -58, -30, 99, -1, 30, 32, 80, 91, -121, -126, -30, 17, -55, 44, -33, -12, -42, 54, 56, -114, 38, 61, 8, 12, 104, -97, 127, 3, -74, 15, 119, -11, -45, 120, -71, -12, 111, 28, 81, 120, -50, -30, 11, -36, -90, -111, -104, 34, -115, -103, 68, 55, 80, 79, -87, 87, -47, -84, -78, -76, -63, -90, 42, -104, 12, -16, 53, -54, -2, -32, 102, 93, -40, -7, -64, 118, 25, -18, 127, -73, 17, 2, 66, 11, -78, -127, 18, 37, -111, -15, -53, 35, 84, 97, -113, 26, 57, 86, -128, -59, 67, -123, -120, -121, 57, -98, -95, 44, 117, 14, 116, 42, 38, -76, -22, -14, -37, -36, -56, 53, -121, -116, -17, -102, -99, -23, 34, -52, 73, -86, -56, -38, -80, -23, 124, 125, 36, 94, -32, -76, 69, -43, 37, 109, 118, 80, -84, 49, 111, 67, -125, 43, -113, 101, 87, -110, -16, -96, 18, 110, 124, -37, -110, -100, 107, -109, -73, -39, -109, -25, 93, 83, -73, -88, 34, 29, -89, 93, -22, -77, 25, 53, 74, 11, 116, -41, -85, 92, -106, 96, 38, -110, 12, 30, 63, 23, 78, -94, 109, 40, 82, 65, -16, 40, 48, -12, 57, -99, -53, -67, -73, 122, 49, -27, -19, 99, 95, -69, -124, -88, 40, -40, -74, -55, 15, -81, -55, 60, -50, -25, 96, -54, 119, 96, 66, -82, -94, 28, -78, -31, -23, 38, 12, 38, 24, 96, 24, 115, 10, 13, 61, 33, 7, -87, -111, -90, 48, 53, -90, 78, -17, -31, 68, 124, -65, -101, 8, 64, -125, -43, 7, 69, 89, 13, 77, 57, 46, 83, -19, -82, 95, -85, -49, 86, -102, -71, 55, -57, 10, -120, -103, -56, 34, 101, 59, -62, -90, 95, -56, 54, -49, 0, -127, -43, -27, 32, 2, 55, -117, -97, 2, -33, 62, -77, -16, -64, 40, -55, -112, 36, 46, 98, -64, -44, -78, -85, -63, 74, -119, -4, -80, -14, 11, -78, -123, -114, 38, 76, -115, 43, -99, -110, -16, -26, -47, -34, 35, 93, -69, -78, -53, 23, 127, 100, 90, -37, 13, 105, 88, 48, -103, 127, -112, -62, -23, 120, 37, 29, -9, -92, -65, 30, -31, -59, 34, 24, -52, -53, 75, 89, 38, 92, -98, 100, 34, 4, 23, 55, -105, 121, 60, -119, -61, -119, -68, -121, -106, -8, 59, 73, 65, 80, -87, 86, 69, 114, 56, -102, 55, 32, -121, 15, 6, 41, -49, -109, -6, -93, -44, 127, -26, -33, -116, -16, -45, 20, 48, 43, 36, -88, -59, -55, -68, 73, 77, -95, -90, -25, -52, 29, 54, -77, 58, 65, -36, 106, 127, 26, 93, -128, -5, -115, 113, 72, 79, -68, -43, -49, 33, -19, -42, 51, -44, 72, 37, -26, -43, 54, 20, 66, -125, -101, 98, 16, 9, -10, 116, 78, 88, 39, 98, -3, 83, 99, -97, 90, 2, -35, -40, 103, 41, -70, -59, -4, -112, -19, 91, 124, -79, 35, 4, -123, 0, -91, 38, 13, -106, -69, -76, 55, 69, 47, 2, 3, 1, 0, 1};
        byte[] signature = {78, 116, 44, -57, -48, -127, -64, -28, -11, -16, -122, 7, 96, 27, 9, 17, -46, 17, -43, -99, 99, 49, 88, 67, -36, -28, 19, 126, 104, -20, -9, 121, 120, -49, 98, -38, -112, 117, -24, 59, 97, 15, 38, 121, -83, -85, -45, 84, -92, 45, -70, 127, 85, 27, -75, -7, 71, 71, -45, 69, -17, 123, 38, 121, -30, -77, 77, -16, -104, 123, -113, -44, -70, 30, -97, 126, -115, -45, 41, 109, 2, -56, 120, 7, -70, -51, -16, -107, 19, -115, -17, -119, 30, -76, -75, -38, 0, 56, 123, -41, 45, -61, 83, 79, -117, 109, 25, -29, -101, 12, 126, 81, 109, 24, -1, -24, -40, 29, -113, -65, 31, 106, 1, -11, 83, -101, -51, 124, -59, -57, 88, -97, -57, -108, 48, 42, -43, 29, 94, -21, -76, 88, 75, -15, -128, -114, 59, 27, 73, 120, -47, 91, -19, -36, 40, 50, -19, -126, -36, 121, -127, 55, -93, -75, 45, -115, -12, -98, -99, -72, 92, 78, -26, 70, -102, -83, -120, -41, -113, 73, 94, -87, -46, -99, -115, 4, 125, -1, 107, -47, 44, -72, -125, 93, -37, 78, -102, -42, -112, 37, 78, 69, -11, 2, 92, 13, -36, -23, 109, -8, 85, -79, -31, -86, 51, 125, -59, 77, -41, 110, 88, 61, -28, 87, 36, 127, 14, -5, -63, -57, 29, -101, 11, 4, 46, 58, 12, -13, 106, -87, -61, 44, -125, 62, -2, 68, 123, -94, -17, -65, -68, 45, -5, -61, 84, -102, -55, -118, 118, 126, 107, -48, -50, 109, 76, -106, 97, 117, 34, -29, -97, 62, -82, -8, -118, -102, -40, 107, -125, -95, -28, -99, -105, -95, 7, 85, -86, 65, 96, -111, 7, 94, 30, 95, 15, 11, 96, 67, 13, 117, 93, 120, -49, -20, 12, 100, 38, 25, -4, -95, 67, 123, -41, 4, 32, 73, 5, -53, -115, -92, -69, 61, 116, 19, -74, 122, 106, 50, -59, 125, 112, -65, 33, -74, 21, -105, 15, 112, -106, -4, 75, -118, -35, 45, -14, -80, 97, -118, -125, 38, -76, 45, 23, 110, 76, 121, 26, 30, 17, 56, -53, -85, -47, 118, -23, 67, -79, -49, -1, 127, -99, 125, -112, 65, -16, -119, 13, 33, 6, -100, -34, -53, -92, -39, -29, -56, -117, 35, -109, -43, -91, -124, -37, 126, -5, -109, 77, -93, -109, 78, -98, -9, 34, -122, 88, 63, -94, 40, -88, 33, 58, -43, 118, 13, 15, -104, -24, -89, 53, 64, 14, -32, -24, 48, -95, 7, 98, -84, 110, 86, 31, -103, -32, 10, -88, 111, -25, -83, 26, 65, 113, 96, -9, 95, -61, -61, -127, -100, -28, 54, 118, -62, 53, -73, 22, 90, -72, -117, 96, -69, 94, -91, 28, 89, -28, 62, -19, -65, -81, 66, 26, -21, -113, -19, 95, -40, 75, -74, 60, 1, -127, 109, 73, -33, 27, -102, -68, -17, -76, 49, 126, -122, -15, -38, -123, -9, -36, 3, 68, 34, 82, -6, -24, 4, 22, 122, 47, 90, -5, 108, 83, 36};
        String transaction = "[15] amount: 50\nFrom: MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA4/jQBcwl8FhNhbU293vhkxuzFuQqhD7NGaUcwsaQaNmPX64xGGoososGXj3X0x8weGoQnMi/+xbA42Q99wMRh67As9bQkEidSeX/+Yf8Uxh/88pZBpILaPGIiniiA6Vnawl2A4Rgc7Bd/4i2jCcw4EQqwmfItbO92+EgrNHY53EDtDw3iqm8dV45r5wQRLT+RGWyFj39PssIXttbnLVRDlSEyJPhIGMR9Y63+56+2+gavJx6H3e0Z8Mi8I0f7Ecsh1qmc3d8F0UrAm47Qnif1MLJfW/gjUpdGbplAHUIlSc3VDhTv+kRcR4KrReiYx3xoler5Z6QNkGk7OKHC1aE25ReoCNmK8t14LTt37YjqzvVHfTCzGTwwuPbSSseg95DqErgq/1eNuRZ0+X3b2W/1AtzawiMnWG7EhXmyp44gJ4xPPK25eLa4tapDnl9sqYG/7O4xvx7uLs7Rar6VVUNvOiBjQ+0ZgZ0PT1qat+XBzERJOMVFSsQKo9O+63KaSu82t+FFVrSAMCeelJsv+q3OL8gAWP2UwET5548QB18tpN2EmJQC2C7Bt3bbOjK58SKJBlzJU7q6i+/W58LPMTvKjt83h1Qrk+8B1FWYOwaxo4Gf5hVzJCWLW7g4E64PXGS/jCgZC+lby6JPiUsfg7rapg1jokJHCmk4D79lxqXK0MCAwEAAQ==\nTo: MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA4/jQBcwl8FhNhbU293vhkxuzFuQqhD7NGaUcwsaQaNmPX64xGGoososGXj3X0x8weGoQnMi/+xbA42Q99wMRh67As9bQkEidSeX/+Yf8Uxh/88pZBpILaPGIiniiA6Vnawl2A4Rgc7Bd/4i2jCcw4EQqwmfItbO92+EgrNHY53EDtDw3iqm8dV45r5wQRLT+RGWyFj39PssIXttbnLVRDlSEyJPhIGMR9Y63+56+2+gavJx6H3e0Z8Mi8I0f7Ecsh1qmc3d8F0UrAm47Qnif1MLJfW/gjUpdGbplAHUIlSc3VDhTv+kRcR4KrReiYx3xoler5Z6QNkGk7OKHC1aE25ReoCNmK8t14LTt37YjqzvVHfTCzGTwwuPbSSseg95DqErgq/1eNuRZ0+X3b2W/1AtzawiMnWG7EhXmyp44gJ4xPPK25eLa4tapDnl9sqYG/7O4xvx7uLs7Rar6VVUNvOiBjQ+0ZgZ0PT1qat+XBzERJOMVFSsQKo9O+63KaSu82t+FFVrSAMCeelJsv+q3OL8gAWP2UwET5548QB18tpN2EmJQC2C7Bt3bbOjK58SKJBlzJU7q6i+/W58LPMTvKjt83h1Qrk+8B1FWYOwaxo4Gf5hVzJCWLW7g4E64PXGS/jCgZC+lby6JPiUsfg7rapg1jokJHCmk4D79lxqXK0MCAwEAAQ==\n";
        CheckAccountResponse.Builder builder = CheckAccountResponse.newBuilder().addTransactions(transaction);
        assertDoesNotThrow(() -> Client.auditCheckResponse(serverPublicKey, signature, builder.getTransactionsList().toArray()));
    }

    @Test
    void audit_signature_mismatch(){
        byte[] serverPublicKey = {48, -126, 2, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 2, 15, 0, 48, -126, 2, 10, 2, -126, 2, 1, 0, -58, -30, 99, -1, 30, 32, 80, 91, -121, -126, -30, 17, -55, 44, -33, -12, -42, 54, 56, -114, 38, 61, 8, 12, 104, -97, 127, 3, -74, 15, 119, -11, -45, 120, -71, -12, 111, 28, 81, 120, -50, -30, 11, -36, -90, -111, -104, 34, -115, -103, 68, 55, 80, 79, -87, 87, -47, -84, -78, -76, -63, -90, 42, -104, 12, -16, 53, -54, -2, -32, 102, 93, -40, -7, -64, 118, 25, -18, 127, -73, 17, 2, 66, 11, -78, -127, 18, 37, -111, -15, -53, 35, 84, 97, -113, 26, 57, 86, -128, -59, 67, -123, -120, -121, 57, -98, -95, 44, 117, 14, 116, 42, 38, -76, -22, -14, -37, -36, -56, 53, -121, -116, -17, -102, -99, -23, 34, -52, 73, -86, -56, -38, -80, -23, 124, 125, 36, 94, -32, -76, 69, -43, 37, 109, 118, 80, -84, 49, 111, 67, -125, 43, -113, 101, 87, -110, -16, -96, 18, 110, 124, -37, -110, -100, 107, -109, -73, -39, -109, -25, 93, 83, -73, -88, 34, 29, -89, 93, -22, -77, 25, 53, 74, 11, 116, -41, -85, 92, -106, 96, 38, -110, 12, 30, 63, 23, 78, -94, 109, 40, 82, 65, -16, 40, 48, -12, 57, -99, -53, -67, -73, 122, 49, -27, -19, 99, 95, -69, -124, -88, 40, -40, -74, -55, 15, -81, -55, 60, -50, -25, 96, -54, 119, 96, 66, -82, -94, 28, -78, -31, -23, 38, 12, 38, 24, 96, 24, 115, 10, 13, 61, 33, 7, -87, -111, -90, 48, 53, -90, 78, -17, -31, 68, 124, -65, -101, 8, 64, -125, -43, 7, 69, 89, 13, 77, 57, 46, 83, -19, -82, 95, -85, -49, 86, -102, -71, 55, -57, 10, -120, -103, -56, 34, 101, 59, -62, -90, 95, -56, 54, -49, 0, -127, -43, -27, 32, 2, 55, -117, -97, 2, -33, 62, -77, -16, -64, 40, -55, -112, 36, 46, 98, -64, -44, -78, -85, -63, 74, -119, -4, -80, -14, 11, -78, -123, -114, 38, 76, -115, 43, -99, -110, -16, -26, -47, -34, 35, 93, -69, -78, -53, 23, 127, 100, 90, -37, 13, 105, 88, 48, -103, 127, -112, -62, -23, 120, 37, 29, -9, -92, -65, 30, -31, -59, 34, 24, -52, -53, 75, 89, 38, 92, -98, 100, 34, 4, 23, 55, -105, 121, 60, -119, -61, -119, -68, -121, -106, -8, 59, 73, 65, 80, -87, 86, 69, 114, 56, -102, 55, 32, -121, 15, 6, 41, -49, -109, -6, -93, -44, 127, -26, -33, -116, -16, -45, 20, 48, 43, 36, -88, -59, -55, -68, 73, 77, -95, -90, -25, -52, 29, 54, -77, 58, 65, -36, 106, 127, 26, 93, -128, -5, -115, 113, 72, 79, -68, -43, -49, 33, -19, -42, 51, -44, 72, 37, -26, -43, 54, 20, 66, -125, -101, 98, 16, 9, -10, 116, 78, 88, 39, 98, -3, 83, 99, -97, 90, 2, -35, -40, 103, 41, -70, -59, -4, -112, -19, 91, 124, -79, 35, 4, -123, 0, -91, 38, 13, -106, -69, -76, 55, 69, 47, 2, 3, 1, 0, 1};
        byte[] signature = {79, 116, 44, -57, -48, -127, -64, -28, -11, -16, -122, 7, 96, 27, 9, 17, -46, 17, -43, -99, 99, 49, 88, 67, -36, -28, 19, 126, 104, -20, -9, 121, 120, -49, 98, -38, -112, 117, -24, 59, 97, 15, 38, 121, -83, -85, -45, 84, -92, 45, -70, 127, 85, 27, -75, -7, 71, 71, -45, 69, -17, 123, 38, 121, -30, -77, 77, -16, -104, 123, -113, -44, -70, 30, -97, 126, -115, -45, 41, 109, 2, -56, 120, 7, -70, -51, -16, -107, 19, -115, -17, -119, 30, -76, -75, -38, 0, 56, 123, -41, 45, -61, 83, 79, -117, 109, 25, -29, -101, 12, 126, 81, 109, 24, -1, -24, -40, 29, -113, -65, 31, 106, 1, -11, 83, -101, -51, 124, -59, -57, 88, -97, -57, -108, 48, 42, -43, 29, 94, -21, -76, 88, 75, -15, -128, -114, 59, 27, 73, 120, -47, 91, -19, -36, 40, 50, -19, -126, -36, 121, -127, 55, -93, -75, 45, -115, -12, -98, -99, -72, 92, 78, -26, 70, -102, -83, -120, -41, -113, 73, 94, -87, -46, -99, -115, 4, 125, -1, 107, -47, 44, -72, -125, 93, -37, 78, -102, -42, -112, 37, 78, 69, -11, 2, 92, 13, -36, -23, 109, -8, 85, -79, -31, -86, 51, 125, -59, 77, -41, 110, 88, 61, -28, 87, 36, 127, 14, -5, -63, -57, 29, -101, 11, 4, 46, 58, 12, -13, 106, -87, -61, 44, -125, 62, -2, 68, 123, -94, -17, -65, -68, 45, -5, -61, 84, -102, -55, -118, 118, 126, 107, -48, -50, 109, 76, -106, 97, 117, 34, -29, -97, 62, -82, -8, -118, -102, -40, 107, -125, -95, -28, -99, -105, -95, 7, 85, -86, 65, 96, -111, 7, 94, 30, 95, 15, 11, 96, 67, 13, 117, 93, 120, -49, -20, 12, 100, 38, 25, -4, -95, 67, 123, -41, 4, 32, 73, 5, -53, -115, -92, -69, 61, 116, 19, -74, 122, 106, 50, -59, 125, 112, -65, 33, -74, 21, -105, 15, 112, -106, -4, 75, -118, -35, 45, -14, -80, 97, -118, -125, 38, -76, 45, 23, 110, 76, 121, 26, 30, 17, 56, -53, -85, -47, 118, -23, 67, -79, -49, -1, 127, -99, 125, -112, 65, -16, -119, 13, 33, 6, -100, -34, -53, -92, -39, -29, -56, -117, 35, -109, -43, -91, -124, -37, 126, -5, -109, 77, -93, -109, 78, -98, -9, 34, -122, 88, 63, -94, 40, -88, 33, 58, -43, 118, 13, 15, -104, -24, -89, 53, 64, 14, -32, -24, 48, -95, 7, 98, -84, 110, 86, 31, -103, -32, 10, -88, 111, -25, -83, 26, 65, 113, 96, -9, 95, -61, -61, -127, -100, -28, 54, 118, -62, 53, -73, 22, 90, -72, -117, 96, -69, 94, -91, 28, 89, -28, 62, -19, -65, -81, 66, 26, -21, -113, -19, 95, -40, 75, -74, 60, 1, -127, 109, 73, -33, 27, -102, -68, -17, -76, 49, 126, -122, -15, -38, -123, -9, -36, 3, 68, 34, 82, -6, -24, 4, 22, 122, 47, 90, -5, 108, 83, 36};
        String transaction = "[15] amount: 50\nFrom: MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA4/jQBcwl8FhNhbU293vhkxuzFuQqhD7NGaUcwsaQaNmPX64xGGoososGXj3X0x8weGoQnMi/+xbA42Q99wMRh67As9bQkEidSeX/+Yf8Uxh/88pZBpILaPGIiniiA6Vnawl2A4Rgc7Bd/4i2jCcw4EQqwmfItbO92+EgrNHY53EDtDw3iqm8dV45r5wQRLT+RGWyFj39PssIXttbnLVRDlSEyJPhIGMR9Y63+56+2+gavJx6H3e0Z8Mi8I0f7Ecsh1qmc3d8F0UrAm47Qnif1MLJfW/gjUpdGbplAHUIlSc3VDhTv+kRcR4KrReiYx3xoler5Z6QNkGk7OKHC1aE25ReoCNmK8t14LTt37YjqzvVHfTCzGTwwuPbSSseg95DqErgq/1eNuRZ0+X3b2W/1AtzawiMnWG7EhXmyp44gJ4xPPK25eLa4tapDnl9sqYG/7O4xvx7uLs7Rar6VVUNvOiBjQ+0ZgZ0PT1qat+XBzERJOMVFSsQKo9O+63KaSu82t+FFVrSAMCeelJsv+q3OL8gAWP2UwET5548QB18tpN2EmJQC2C7Bt3bbOjK58SKJBlzJU7q6i+/W58LPMTvKjt83h1Qrk+8B1FWYOwaxo4Gf5hVzJCWLW7g4E64PXGS/jCgZC+lby6JPiUsfg7rapg1jokJHCmk4D79lxqXK0MCAwEAAQ==\nTo: MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA4/jQBcwl8FhNhbU293vhkxuzFuQqhD7NGaUcwsaQaNmPX64xGGoososGXj3X0x8weGoQnMi/+xbA42Q99wMRh67As9bQkEidSeX/+Yf8Uxh/88pZBpILaPGIiniiA6Vnawl2A4Rgc7Bd/4i2jCcw4EQqwmfItbO92+EgrNHY53EDtDw3iqm8dV45r5wQRLT+RGWyFj39PssIXttbnLVRDlSEyJPhIGMR9Y63+56+2+gavJx6H3e0Z8Mi8I0f7Ecsh1qmc3d8F0UrAm47Qnif1MLJfW/gjUpdGbplAHUIlSc3VDhTv+kRcR4KrReiYx3xoler5Z6QNkGk7OKHC1aE25ReoCNmK8t14LTt37YjqzvVHfTCzGTwwuPbSSseg95DqErgq/1eNuRZ0+X3b2W/1AtzawiMnWG7EhXmyp44gJ4xPPK25eLa4tapDnl9sqYG/7O4xvx7uLs7Rar6VVUNvOiBjQ+0ZgZ0PT1qat+XBzERJOMVFSsQKo9O+63KaSu82t+FFVrSAMCeelJsv+q3OL8gAWP2UwET5548QB18tpN2EmJQC2C7Bt3bbOjK58SKJBlzJU7q6i+/W58LPMTvKjt83h1Qrk+8B1FWYOwaxo4Gf5hVzJCWLW7g4E64PXGS/jCgZC+lby6JPiUsfg7rapg1jokJHCmk4D79lxqXK0MCAwEAAQ==\n";
        CheckAccountResponse.Builder builder = CheckAccountResponse.newBuilder().addTransactions(transaction);
        assertThrows(SignatureExceptions.class,() -> Client.auditCheckResponse(serverPublicKey, signature, builder.getTransactionsList().toArray()));
    }

 */

}